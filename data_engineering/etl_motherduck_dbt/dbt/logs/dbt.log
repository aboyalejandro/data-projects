[0m16:29:08.804955 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102e393c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104c1ef80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104c1f6d0>]}


============================== 16:29:08.808115 | 92c74823-9dc8-4acb-a27b-776c74190f78 ==============================
[0m16:29:08.808115 [info ] [MainThread]: Running with dbt=1.6.6
[0m16:29:08.808537 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/alejandroaboy/Desktop/dbt_duckdb_piwik', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/Users/alejandroaboy/Desktop/dbt_duckdb_piwik/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt deps', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m16:29:08.838426 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '92c74823-9dc8-4acb-a27b-776c74190f78', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104c1f9d0>]}
[0m16:29:08.839931 [debug] [MainThread]: Set downloads directory='/var/folders/67/cphn2wq14gz2x5k1nw4bk9c00000gn/T/dbt-downloads-why2u5de'
[0m16:29:08.840390 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m16:29:08.948385 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m16:29:08.949819 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/calogica/dbt_expectations.json
[0m16:29:09.036544 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/calogica/dbt_expectations.json 200
[0m16:29:09.041975 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m16:29:09.126870 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m16:29:09.133743 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/elementary-data/elementary.json
[0m16:29:09.220721 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/elementary-data/elementary.json 200
[0m16:29:09.231058 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/calogica/dbt_date.json
[0m16:29:09.321005 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/calogica/dbt_date.json 200
[0m16:29:09.345768 [info ] [MainThread]: Installing calogica/dbt_expectations
[0m16:29:10.018638 [info ] [MainThread]: Installed from version 0.10.0
[0m16:29:10.018999 [info ] [MainThread]: Up to date!
[0m16:29:10.019277 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '92c74823-9dc8-4acb-a27b-776c74190f78', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104c847f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104c1f6d0>]}
[0m16:29:10.019550 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m16:29:10.388418 [info ] [MainThread]: Installed from version 1.1.1
[0m16:29:10.388802 [info ] [MainThread]: Up to date!
[0m16:29:10.389093 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '92c74823-9dc8-4acb-a27b-776c74190f78', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104c84c40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104c1f280>]}
[0m16:29:10.389419 [info ] [MainThread]: Installing elementary-data/elementary
[0m16:29:10.786294 [info ] [MainThread]: Installed from version 0.11.2
[0m16:29:10.786679 [info ] [MainThread]: Up to date!
[0m16:29:10.786982 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '92c74823-9dc8-4acb-a27b-776c74190f78', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104c84c40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104c1f280>]}
[0m16:29:10.787295 [info ] [MainThread]: Installing calogica/dbt_date
[0m16:29:11.044398 [info ] [MainThread]: Installed from version 0.9.1
[0m16:29:11.044775 [info ] [MainThread]: Up to date!
[0m16:29:11.045059 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '92c74823-9dc8-4acb-a27b-776c74190f78', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104c84c40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104c1f6d0>]}
[0m16:29:11.046199 [debug] [MainThread]: Command `dbt deps` succeeded at 16:29:11.046117 after 2.26 seconds
[0m16:29:11.046485 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102e393c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104c85030>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104c87e50>]}
[0m16:29:11.046724 [debug] [MainThread]: Flushing usage events
[0m16:29:16.130910 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106665480>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10844a5c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10844afb0>]}


============================== 16:29:16.134189 | 2036a7ed-4159-4612-a399-a5939c880e0e ==============================
[0m16:29:16.134189 [info ] [MainThread]: Running with dbt=1.6.6
[0m16:29:16.134607 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/alejandroaboy/Desktop/dbt_duckdb_piwik', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/Users/alejandroaboy/Desktop/dbt_duckdb_piwik/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt debug', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m16:29:16.135007 [info ] [MainThread]: dbt version: 1.6.6
[0m16:29:16.135227 [info ] [MainThread]: python version: 3.10.2
[0m16:29:16.135431 [info ] [MainThread]: python path: /Users/alejandroaboy/Desktop/dbt-env/bin/python3
[0m16:29:16.135628 [info ] [MainThread]: os info: macOS-13.4-arm64-arm-64bit
[0m16:29:16.194524 [info ] [MainThread]: Using profiles dir at /Users/alejandroaboy/Desktop/dbt_duckdb_piwik
[0m16:29:16.194942 [info ] [MainThread]: Using profiles.yml file at /Users/alejandroaboy/Desktop/dbt_duckdb_piwik/profiles.yml
[0m16:29:16.195178 [info ] [MainThread]: Using dbt_project.yml file at /Users/alejandroaboy/Desktop/dbt_duckdb_piwik/dbt_project.yml
[0m16:29:16.195560 [info ] [MainThread]: adapter type: duckdb
[0m16:29:16.195773 [info ] [MainThread]: adapter version: 1.6.1
[0m16:29:16.212914 [info ] [MainThread]: Configuration:
[0m16:29:16.213357 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m16:29:16.213622 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m16:29:16.213862 [info ] [MainThread]: Required dependencies:
[0m16:29:16.214144 [debug] [MainThread]: Executing "git --help"
[0m16:29:16.227902 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--super-prefix=<path>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m16:29:16.228733 [debug] [MainThread]: STDERR: "b''"
[0m16:29:16.228993 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m16:29:16.229229 [info ] [MainThread]: Connection:
[0m16:29:16.229479 [info ] [MainThread]:   database: my_db
[0m16:29:16.229672 [info ] [MainThread]:   schema: main
[0m16:29:16.229860 [info ] [MainThread]:   path: md:my_db?motherduck_token=
[0m16:29:16.230049 [info ] [MainThread]:   config_options: None
[0m16:29:16.230244 [info ] [MainThread]:   extensions: ['httpfs', 'parquet', 's3']
[0m16:29:16.230432 [info ] [MainThread]:   settings: {'s3_region': 'eu-west-3', 's3_access_key_id': '', 's3_secret_access_key': ''}
[0m16:29:16.230617 [info ] [MainThread]:   external_root: .
[0m16:29:16.230802 [info ] [MainThread]:   use_credential_provider: None
[0m16:29:16.230985 [info ] [MainThread]:   attach: None
[0m16:29:16.231168 [info ] [MainThread]:   filesystems: None
[0m16:29:16.231353 [info ] [MainThread]:   remote: None
[0m16:29:16.231535 [info ] [MainThread]:   plugins: None
[0m16:29:16.231719 [info ] [MainThread]:   disable_transactions: True
[0m16:29:16.232092 [info ] [MainThread]: Registered adapter: duckdb=1.6.1
[0m16:29:16.235658 [debug] [MainThread]: Acquiring new duckdb connection 'debug'
[0m16:29:16.236309 [debug] [MainThread]: Using duckdb connection "debug"
[0m16:29:16.236567 [debug] [MainThread]: On debug: select 1 as id
[0m16:29:16.236774 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:29:36.546447 [debug] [MainThread]: SQL status: OK in 20.0 seconds
[0m16:29:36.549347 [debug] [MainThread]: On debug: Close
[0m16:29:36.550152 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m16:29:36.551973 [info ] [MainThread]: [32mAll checks passed![0m
[0m16:29:36.554565 [debug] [MainThread]: Command `dbt debug` succeeded at 16:29:36.554154 after 20.44 seconds
[0m16:29:36.555400 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m16:29:36.555999 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106665480>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1085599c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108558370>]}
[0m16:29:36.556922 [debug] [MainThread]: Flushing usage events
[0m16:29:44.444816 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1070c53c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108eaa2f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108eab160>]}


============================== 16:29:44.447869 | afad5643-cc5b-469f-a309-bb162405afa8 ==============================
[0m16:29:44.447869 [info ] [MainThread]: Running with dbt=1.6.6
[0m16:29:44.448266 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/Users/alejandroaboy/Desktop/dbt_duckdb_piwik', 'log_path': '/Users/alejandroaboy/Desktop/dbt_duckdb_piwik/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt build', 'send_anonymous_usage_stats': 'True'}
[0m16:29:44.529625 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'afad5643-cc5b-469f-a309-bb162405afa8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104d03fd0>]}
[0m16:29:44.540590 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'afad5643-cc5b-469f-a309-bb162405afa8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108fb5840>]}
[0m16:29:44.541009 [info ] [MainThread]: Registered adapter: duckdb=1.6.1
[0m16:29:44.566916 [debug] [MainThread]: checksum: 546b81fb56652c304d87abd676e84d4737d8a0c6b62160f4a6e79dcddbc842bb, vars: {}, profile: , target: , version: 1.6.6
[0m16:29:44.567632 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m16:29:44.567914 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'afad5643-cc5b-469f-a309-bb162405afa8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108fb51b0>]}
[0m16:29:47.289902 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.dbt_playground.elementary
- seeds
[0m16:29:47.295290 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'afad5643-cc5b-469f-a309-bb162405afa8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1092dfe80>]}
[0m16:29:47.319637 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'afad5643-cc5b-469f-a309-bb162405afa8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108f8b8e0>]}
[0m16:29:47.320076 [info ] [MainThread]: Found 37 models, 1 snapshot, 2 operations, 16 tests, 3 sources, 0 exposures, 0 metrics, 1259 macros, 0 groups, 0 semantic models
[0m16:29:47.322647 [info ] [MainThread]: 
[0m16:29:47.323252 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m16:29:47.324991 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_analytics'
[0m16:29:47.333594 [debug] [ThreadPool]: Using duckdb connection "list_analytics"
[0m16:29:47.333942 [debug] [ThreadPool]: On list_analytics: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "dbt_playground", "target_name": "dev", "connection_name": "list_analytics"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"analytics"'
    
  
  
[0m16:29:47.334160 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:29:56.137006 [debug] [ThreadPool]: SQL status: OK in 9.0 seconds
[0m16:29:56.139169 [debug] [ThreadPool]: On list_analytics: Close
[0m16:29:56.140432 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_analytics, now list_my_db)
[0m16:29:56.183185 [debug] [ThreadPool]: Using duckdb connection "list_my_db"
[0m16:29:56.183538 [debug] [ThreadPool]: On list_my_db: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "dbt_playground", "target_name": "dev", "connection_name": "list_my_db"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"my_db"'
    
  
  
[0m16:29:56.183748 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:29:56.481020 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m16:29:56.491439 [debug] [ThreadPool]: On list_my_db: Close
[0m16:29:56.495441 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_my_db, now create_my_db_main)
[0m16:29:56.497143 [debug] [ThreadPool]: Creating schema "database: "my_db"
schema: "main"
"
[0m16:29:56.507402 [debug] [ThreadPool]: Using duckdb connection "create_my_db_main"
[0m16:29:56.508074 [debug] [ThreadPool]: On create_my_db_main: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "dbt_playground", "target_name": "dev", "connection_name": "create_my_db_main"} */
create schema if not exists "my_db"."main"
[0m16:29:56.508492 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:29:57.025703 [debug] [ThreadPool]: SQL status: OK in 1.0 seconds
[0m16:29:57.027942 [debug] [ThreadPool]: On create_my_db_main: Close
[0m16:29:57.029688 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_my_db_main, now create_analytics_dbt)
[0m16:29:57.030909 [debug] [ThreadPool]: Creating schema "database: "analytics"
schema: "dbt"
"
[0m16:29:57.035832 [debug] [ThreadPool]: Using duckdb connection "create_analytics_dbt"
[0m16:29:57.036253 [debug] [ThreadPool]: On create_analytics_dbt: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "dbt_playground", "target_name": "dev", "connection_name": "create_analytics_dbt"} */
create schema if not exists "analytics"."dbt"
[0m16:29:57.036603 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:29:57.348539 [debug] [ThreadPool]: On create_analytics_dbt: Close
[0m16:29:57.353925 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:29:57.354523 [debug] [MainThread]: Connection 'create_analytics_dbt' was properly closed.
[0m16:29:57.354936 [info ] [MainThread]: 
[0m16:29:57.355345 [info ] [MainThread]: Finished running  in 0 hours 0 minutes and 10.03 seconds (10.03s).
[0m16:29:57.355944 [error] [MainThread]: Encountered an error:
Runtime Error
  Binder Error: Catalog "analytics" does not exist!
[0m16:29:57.356704 [debug] [MainThread]: Command `dbt build` failed at 16:29:57.356602 after 12.93 seconds
[0m16:29:57.357190 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1070c53c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1093a1120>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1093a1030>]}
[0m16:29:57.357666 [debug] [MainThread]: Flushing usage events
[0m16:31:02.043356 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1054c53f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1072aa320>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1072ab190>]}


============================== 16:31:02.046843 | 197a6312-bdd7-44f7-a4f0-89fabac6568d ==============================
[0m16:31:02.046843 [info ] [MainThread]: Running with dbt=1.6.6
[0m16:31:02.047270 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/Users/alejandroaboy/Desktop/dbt_duckdb_piwik', 'log_path': '/Users/alejandroaboy/Desktop/dbt_duckdb_piwik/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt build', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m16:31:02.136690 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '197a6312-bdd7-44f7-a4f0-89fabac6568d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103103fd0>]}
[0m16:31:02.148407 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '197a6312-bdd7-44f7-a4f0-89fabac6568d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1073b56f0>]}
[0m16:31:02.148962 [info ] [MainThread]: Registered adapter: duckdb=1.6.1
[0m16:31:02.175187 [debug] [MainThread]: checksum: 546b81fb56652c304d87abd676e84d4737d8a0c6b62160f4a6e79dcddbc842bb, vars: {}, profile: , target: , version: 1.6.6
[0m16:31:02.258250 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m16:31:02.259331 [debug] [MainThread]: Partial parsing: updated file: dbt_playground://models/staging/sources.yml
[0m16:31:02.472363 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.dbt_playground.elementary
- seeds
[0m16:31:02.478070 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '197a6312-bdd7-44f7-a4f0-89fabac6568d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107cb40d0>]}
[0m16:31:02.503487 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '197a6312-bdd7-44f7-a4f0-89fabac6568d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107b03520>]}
[0m16:31:02.503919 [info ] [MainThread]: Found 37 models, 2 operations, 1 snapshot, 16 tests, 3 sources, 0 exposures, 0 metrics, 1259 macros, 0 groups, 0 semantic models
[0m16:31:02.506546 [info ] [MainThread]: 
[0m16:31:02.507208 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m16:31:02.509049 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_analytics'
[0m16:31:02.517929 [debug] [ThreadPool]: Using duckdb connection "list_analytics"
[0m16:31:02.518251 [debug] [ThreadPool]: On list_analytics: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "dbt_playground", "target_name": "dev", "connection_name": "list_analytics"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"analytics"'
    
  
  
[0m16:31:02.518477 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:31:12.903019 [debug] [ThreadPool]: SQL status: OK in 10.0 seconds
[0m16:31:12.907829 [debug] [ThreadPool]: On list_analytics: Close
[0m16:31:12.909893 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_analytics, now list_my_db)
[0m16:31:12.916780 [debug] [ThreadPool]: Using duckdb connection "list_my_db"
[0m16:31:12.917282 [debug] [ThreadPool]: On list_my_db: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "dbt_playground", "target_name": "dev", "connection_name": "list_my_db"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"my_db"'
    
  
  
[0m16:31:12.917621 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:31:13.216020 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m16:31:13.219846 [debug] [ThreadPool]: On list_my_db: Close
[0m16:31:13.221927 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_my_db, now create_my_db_main)
[0m16:31:13.222799 [debug] [ThreadPool]: Creating schema "database: "my_db"
schema: "main"
"
[0m16:31:13.230775 [debug] [ThreadPool]: Using duckdb connection "create_my_db_main"
[0m16:31:13.231266 [debug] [ThreadPool]: On create_my_db_main: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "dbt_playground", "target_name": "dev", "connection_name": "create_my_db_main"} */
create schema if not exists "my_db"."main"
[0m16:31:13.231619 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:31:13.686855 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m16:31:13.690840 [debug] [ThreadPool]: On create_my_db_main: Close
[0m16:31:13.693143 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_my_db_main, now create_analytics_dbt)
[0m16:31:13.694367 [debug] [ThreadPool]: Creating schema "database: "analytics"
schema: "dbt"
"
[0m16:31:13.699375 [debug] [ThreadPool]: Using duckdb connection "create_analytics_dbt"
[0m16:31:13.699843 [debug] [ThreadPool]: On create_analytics_dbt: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "dbt_playground", "target_name": "dev", "connection_name": "create_analytics_dbt"} */
create schema if not exists "analytics"."dbt"
[0m16:31:13.700186 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:31:13.973820 [debug] [ThreadPool]: On create_analytics_dbt: Close
[0m16:31:13.976478 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:31:13.977038 [debug] [MainThread]: Connection 'create_analytics_dbt' was properly closed.
[0m16:31:13.977595 [info ] [MainThread]: 
[0m16:31:13.978171 [info ] [MainThread]: Finished running  in 0 hours 0 minutes and 11.47 seconds (11.47s).
[0m16:31:13.978991 [error] [MainThread]: Encountered an error:
Runtime Error
  Binder Error: Catalog "analytics" does not exist!
[0m16:31:13.980004 [debug] [MainThread]: Command `dbt build` failed at 16:31:13.979867 after 11.95 seconds
[0m16:31:13.980530 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1054c53f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107b00910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107e77d30>]}
[0m16:31:13.984776 [debug] [MainThread]: Flushing usage events
[0m16:46:24.908676 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103ce9480>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105b3e5f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105b3efe0>]}


============================== 16:46:24.911587 | eee6905b-1cea-4d50-aa3e-9c3be2196c8e ==============================
[0m16:46:24.911587 [info ] [MainThread]: Running with dbt=1.6.6
[0m16:46:24.911992 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/Users/alejandroaboy/Desktop/dbt_duckdb_piwik', 'log_path': '/Users/alejandroaboy/Desktop/dbt_duckdb_piwik/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt debug', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m16:46:24.912347 [info ] [MainThread]: dbt version: 1.6.6
[0m16:46:24.912558 [info ] [MainThread]: python version: 3.10.2
[0m16:46:24.912745 [info ] [MainThread]: python path: /Users/alejandroaboy/Desktop/dbt-env/bin/python3
[0m16:46:24.912927 [info ] [MainThread]: os info: macOS-13.4-arm64-arm-64bit
[0m16:46:24.916575 [error] [MainThread]: Encountered an error:
Parsing Error
  Env var required but not provided: 'MOTHERDUCK_TOKEN'
[0m16:46:24.917243 [debug] [MainThread]: Command `dbt debug` failed at 16:46:24.917088 after 0.02 seconds
[0m16:46:24.917595 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103ce9480>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105ba1cf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105ba1450>]}
[0m16:46:24.917877 [debug] [MainThread]: Flushing usage events
[0m16:47:15.288086 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102fe9390>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1062b2530>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1062b2f20>]}


============================== 16:47:15.291114 | b09446dd-5b08-4588-b423-43d9c81700ae ==============================
[0m16:47:15.291114 [info ] [MainThread]: Running with dbt=1.6.6
[0m16:47:15.291519 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/Users/alejandroaboy/Desktop/dbt_duckdb_piwik', 'log_path': '/Users/alejandroaboy/Desktop/dbt_duckdb_piwik/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt debug', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m16:47:15.291920 [info ] [MainThread]: dbt version: 1.6.6
[0m16:47:15.292128 [info ] [MainThread]: python version: 3.10.2
[0m16:47:15.292320 [info ] [MainThread]: python path: /Users/alejandroaboy/Desktop/dbt-env/bin/python3
[0m16:47:15.292503 [info ] [MainThread]: os info: macOS-13.4-arm64-arm-64bit
[0m16:47:15.296303 [error] [MainThread]: Encountered an error:
Parsing Error
  Env var required but not provided: 'MOTHERDUCK_TOKEN'
[0m16:47:15.296853 [debug] [MainThread]: Command `dbt debug` failed at 16:47:15.296739 after 0.02 seconds
[0m16:47:15.297136 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102fe9390>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106311c30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106311390>]}
[0m16:47:15.297400 [debug] [MainThread]: Flushing usage events
[0m16:47:38.237438 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1051c13c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107b3e590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107b3ef80>]}


============================== 16:47:38.240494 | 1628887d-b28e-4645-9825-951c7c1ea6e5 ==============================
[0m16:47:38.240494 [info ] [MainThread]: Running with dbt=1.6.6
[0m16:47:38.240908 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/Users/alejandroaboy/Desktop/dbt_duckdb_piwik/logs', 'profiles_dir': '/Users/alejandroaboy/Desktop/dbt_duckdb_piwik', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt debug', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m16:47:38.241285 [info ] [MainThread]: dbt version: 1.6.6
[0m16:47:38.241490 [info ] [MainThread]: python version: 3.10.2
[0m16:47:38.241674 [info ] [MainThread]: python path: /Users/alejandroaboy/Desktop/dbt-env/bin/python3
[0m16:47:38.241868 [info ] [MainThread]: os info: macOS-13.4-arm64-arm-64bit
[0m16:47:38.245685 [error] [MainThread]: Encountered an error:
Parsing Error
  Env var required but not provided: 'MOTHERDUCK_TOKEN'
[0m16:47:38.246236 [debug] [MainThread]: Command `dbt debug` failed at 16:47:38.246135 after 0.02 seconds
[0m16:47:38.246529 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1051c13c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107ba1c90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107ba13f0>]}
[0m16:47:38.246791 [debug] [MainThread]: Flushing usage events
[0m16:49:28.387501 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106dbb130>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108b62530>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108b62f20>]}


============================== 16:49:28.390469 | e0420549-12a8-4e96-9f88-b8c41d0038b2 ==============================
[0m16:49:28.390469 [info ] [MainThread]: Running with dbt=1.6.6
[0m16:49:28.390868 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/alejandroaboy/Desktop/dbt_duckdb_piwik', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/Users/alejandroaboy/Desktop/dbt_duckdb_piwik/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt debug', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m16:49:28.391214 [info ] [MainThread]: dbt version: 1.6.6
[0m16:49:28.391423 [info ] [MainThread]: python version: 3.10.2
[0m16:49:28.391616 [info ] [MainThread]: python path: /Users/alejandroaboy/Desktop/dbt-env/bin/python3
[0m16:49:28.391802 [info ] [MainThread]: os info: macOS-13.4-arm64-arm-64bit
[0m16:49:28.396509 [error] [MainThread]: Encountered an error:
Parsing Error
  Env var required but not provided: 'S3_ACCESS_KEY_ID'
[0m16:49:28.397046 [debug] [MainThread]: Command `dbt debug` failed at 16:49:28.396934 after 0.02 seconds
[0m16:49:28.397339 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106dbb130>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108b632b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108bc0d30>]}
[0m16:49:28.397625 [debug] [MainThread]: Flushing usage events
[0m16:49:49.711967 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1037e93c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10583e590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10583ef80>]}


============================== 16:49:49.714908 | 59384e62-0dae-47f5-a4f7-799c59c2d486 ==============================
[0m16:49:49.714908 [info ] [MainThread]: Running with dbt=1.6.6
[0m16:49:49.715299 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/alejandroaboy/Desktop/dbt_duckdb_piwik', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/Users/alejandroaboy/Desktop/dbt_duckdb_piwik/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt debug', 'send_anonymous_usage_stats': 'True'}
[0m16:49:49.715693 [info ] [MainThread]: dbt version: 1.6.6
[0m16:49:49.715904 [info ] [MainThread]: python version: 3.10.2
[0m16:49:49.716099 [info ] [MainThread]: python path: /Users/alejandroaboy/Desktop/dbt-env/bin/python3
[0m16:49:49.716290 [info ] [MainThread]: os info: macOS-13.4-arm64-arm-64bit
[0m16:49:49.721345 [error] [MainThread]: Encountered an error:
Parsing Error
  Env var required but not provided: 'S3_SECRET_ACCESS_KEY'
[0m16:49:49.721829 [debug] [MainThread]: Command `dbt debug` failed at 16:49:49.721743 after 0.02 seconds
[0m16:49:49.722075 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1037e93c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1058a2110>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1058a1750>]}
[0m16:49:49.722320 [debug] [MainThread]: Flushing usage events
[0m16:50:11.630004 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1055893c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10763e590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10763ef80>]}


============================== 16:50:11.633237 | 7530f338-d2e2-43d0-9987-2d3e485b5f1d ==============================
[0m16:50:11.633237 [info ] [MainThread]: Running with dbt=1.6.6
[0m16:50:11.633667 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/alejandroaboy/Desktop/dbt_duckdb_piwik', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/Users/alejandroaboy/Desktop/dbt_duckdb_piwik/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt debug', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m16:50:11.634084 [info ] [MainThread]: dbt version: 1.6.6
[0m16:50:11.634318 [info ] [MainThread]: python version: 3.10.2
[0m16:50:11.634511 [info ] [MainThread]: python path: /Users/alejandroaboy/Desktop/dbt-env/bin/python3
[0m16:50:11.634699 [info ] [MainThread]: os info: macOS-13.4-arm64-arm-64bit
[0m16:50:11.692947 [info ] [MainThread]: Using profiles dir at /Users/alejandroaboy/Desktop/dbt_duckdb_piwik
[0m16:50:11.693323 [info ] [MainThread]: Using profiles.yml file at /Users/alejandroaboy/Desktop/dbt_duckdb_piwik/profiles.yml
[0m16:50:11.693546 [info ] [MainThread]: Using dbt_project.yml file at /Users/alejandroaboy/Desktop/dbt_duckdb_piwik/dbt_project.yml
[0m16:50:11.693893 [info ] [MainThread]: adapter type: duckdb
[0m16:50:11.694099 [info ] [MainThread]: adapter version: 1.6.1
[0m16:50:11.711219 [info ] [MainThread]: Configuration:
[0m16:50:11.711594 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m16:50:11.711806 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m16:50:11.712003 [info ] [MainThread]: Required dependencies:
[0m16:50:11.712244 [debug] [MainThread]: Executing "git --help"
[0m16:50:11.725672 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--super-prefix=<path>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m16:50:11.726394 [debug] [MainThread]: STDERR: "b''"
[0m16:50:11.726654 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m16:50:11.726886 [info ] [MainThread]: Connection:
[0m16:50:11.727153 [info ] [MainThread]:   database: my_db
[0m16:50:11.727345 [info ] [MainThread]:   schema: main
[0m16:50:11.727535 [info ] [MainThread]:   path: md:my_db?motherduck_token=
[0m16:50:11.727716 [info ] [MainThread]:   config_options: None
[0m16:50:11.727907 [info ] [MainThread]:   extensions: ['httpfs', 'parquet', 's3']
[0m16:50:11.728096 [info ] [MainThread]:   settings: {'s3_region': 'eu-west-3', 's3_access_key_id': '', 's3_secret_access_key': ''}
[0m16:50:11.728283 [info ] [MainThread]:   external_root: .
[0m16:50:11.728476 [info ] [MainThread]:   use_credential_provider: None
[0m16:50:11.728664 [info ] [MainThread]:   attach: None
[0m16:50:11.728844 [info ] [MainThread]:   filesystems: None
[0m16:50:11.729024 [info ] [MainThread]:   remote: None
[0m16:50:11.729222 [info ] [MainThread]:   plugins: None
[0m16:50:11.729506 [info ] [MainThread]:   disable_transactions: True
[0m16:50:11.729988 [info ] [MainThread]: Registered adapter: duckdb=1.6.1
[0m16:50:11.734070 [debug] [MainThread]: Acquiring new duckdb connection 'debug'
[0m16:50:11.734731 [debug] [MainThread]: Using duckdb connection "debug"
[0m16:50:11.734957 [debug] [MainThread]: On debug: select 1 as id
[0m16:50:11.735176 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:50:22.520601 [debug] [MainThread]: SQL status: OK in 11.0 seconds
[0m16:50:22.523655 [debug] [MainThread]: On debug: Close
[0m16:50:22.524415 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m16:50:22.524991 [info ] [MainThread]: [32mAll checks passed![0m
[0m16:50:22.526188 [debug] [MainThread]: Command `dbt debug` succeeded at 16:50:22.526038 after 10.91 seconds
[0m16:50:22.526698 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m16:50:22.527183 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1055893c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10774dc60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10774dea0>]}
[0m16:50:22.527823 [debug] [MainThread]: Flushing usage events
[0m16:50:32.601658 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103be93c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105cb22f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105cb3160>]}


============================== 16:50:32.604959 | f3e41723-6f7b-41a1-8895-a61e294dfc02 ==============================
[0m16:50:32.604959 [info ] [MainThread]: Running with dbt=1.6.6
[0m16:50:32.605367 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/Users/alejandroaboy/Desktop/dbt_duckdb_piwik/logs', 'version_check': 'True', 'profiles_dir': '/Users/alejandroaboy/Desktop/dbt_duckdb_piwik', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt build', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m16:50:32.688644 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f3e41723-6f7b-41a1-8895-a61e294dfc02', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x100d83fd0>]}
[0m16:50:32.699579 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f3e41723-6f7b-41a1-8895-a61e294dfc02', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105dbd840>]}
[0m16:50:32.700026 [info ] [MainThread]: Registered adapter: duckdb=1.6.1
[0m16:50:32.726053 [debug] [MainThread]: checksum: 546b81fb56652c304d87abd676e84d4737d8a0c6b62160f4a6e79dcddbc842bb, vars: {}, profile: , target: , version: 1.6.6
[0m16:50:32.726876 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m16:50:32.727175 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'f3e41723-6f7b-41a1-8895-a61e294dfc02', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105dbd1b0>]}
[0m16:50:35.469319 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.dbt_playground.elementary
- seeds
[0m16:50:35.474747 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f3e41723-6f7b-41a1-8895-a61e294dfc02', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106aa7e80>]}
[0m16:50:35.499152 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f3e41723-6f7b-41a1-8895-a61e294dfc02', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105d938e0>]}
[0m16:50:35.499573 [info ] [MainThread]: Found 37 models, 1 snapshot, 2 operations, 16 tests, 3 sources, 0 exposures, 0 metrics, 1259 macros, 0 groups, 0 semantic models
[0m16:50:35.502090 [info ] [MainThread]: 
[0m16:50:35.502672 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m16:50:35.504301 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_analytics'
[0m16:50:35.513339 [debug] [ThreadPool]: Using duckdb connection "list_analytics"
[0m16:50:35.513766 [debug] [ThreadPool]: On list_analytics: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "dbt_playground", "target_name": "dev", "connection_name": "list_analytics"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"analytics"'
    
  
  
[0m16:50:35.514073 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:50:45.862794 [debug] [ThreadPool]: SQL status: OK in 10.0 seconds
[0m16:50:45.867110 [debug] [ThreadPool]: On list_analytics: Close
[0m16:50:45.868790 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_analytics, now list_my_db)
[0m16:50:45.910796 [debug] [ThreadPool]: Using duckdb connection "list_my_db"
[0m16:50:45.911203 [debug] [ThreadPool]: On list_my_db: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "dbt_playground", "target_name": "dev", "connection_name": "list_my_db"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"my_db"'
    
  
  
[0m16:50:45.911420 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:50:46.171656 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m16:50:46.174127 [debug] [ThreadPool]: On list_my_db: Close
[0m16:50:46.175756 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_my_db, now create_my_db_main)
[0m16:50:46.176635 [debug] [ThreadPool]: Creating schema "database: "my_db"
schema: "main"
"
[0m16:50:46.183943 [debug] [ThreadPool]: Using duckdb connection "create_my_db_main"
[0m16:50:46.187429 [debug] [ThreadPool]: On create_my_db_main: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "dbt_playground", "target_name": "dev", "connection_name": "create_my_db_main"} */
create schema if not exists "my_db"."main"
[0m16:50:46.188208 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:50:46.623596 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m16:50:46.628488 [debug] [ThreadPool]: On create_my_db_main: Close
[0m16:50:46.632015 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_my_db_main, now create_analytics_dbt)
[0m16:50:46.633501 [debug] [ThreadPool]: Creating schema "database: "analytics"
schema: "dbt"
"
[0m16:50:46.639014 [debug] [ThreadPool]: Using duckdb connection "create_analytics_dbt"
[0m16:50:46.639478 [debug] [ThreadPool]: On create_analytics_dbt: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "dbt_playground", "target_name": "dev", "connection_name": "create_analytics_dbt"} */
create schema if not exists "analytics"."dbt"
[0m16:50:46.639867 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:50:46.926283 [debug] [ThreadPool]: On create_analytics_dbt: Close
[0m16:50:46.930614 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:50:46.931119 [debug] [MainThread]: Connection 'create_analytics_dbt' was properly closed.
[0m16:50:46.931515 [info ] [MainThread]: 
[0m16:50:46.931924 [info ] [MainThread]: Finished running  in 0 hours 0 minutes and 11.43 seconds (11.43s).
[0m16:50:46.932474 [error] [MainThread]: Encountered an error:
Runtime Error
  Binder Error: Catalog "analytics" does not exist!
[0m16:50:46.933257 [debug] [MainThread]: Command `dbt build` failed at 16:50:46.933152 after 14.35 seconds
[0m16:50:46.933738 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103be93c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106e89d50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106e88c70>]}
[0m16:50:46.934186 [debug] [MainThread]: Flushing usage events
[0m20:34:41.452713 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1033253f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10510e620>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10510efb0>]}


============================== 20:34:41.456322 | c7435b01-a637-48f0-95b9-8665b3c32cea ==============================
[0m20:34:41.456322 [info ] [MainThread]: Running with dbt=1.6.6
[0m20:34:41.456722 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/Users/alejandroaboy/Desktop/dbt_duckdb_piwik', 'log_path': '/Users/alejandroaboy/Desktop/dbt_duckdb_piwik/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt deps', 'send_anonymous_usage_stats': 'True'}
[0m20:34:41.494415 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c7435b01-a637-48f0-95b9-8665b3c32cea', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x100d93c10>]}
[0m20:34:41.495600 [debug] [MainThread]: Set downloads directory='/var/folders/67/cphn2wq14gz2x5k1nw4bk9c00000gn/T/dbt-downloads-1avfbben'
[0m20:34:41.495982 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m20:34:41.617571 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m20:34:41.618935 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/calogica/dbt_expectations.json
[0m20:34:41.696110 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/calogica/dbt_expectations.json 200
[0m20:34:41.700352 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m20:34:41.787721 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m20:34:41.794943 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/calogica/dbt_date.json
[0m20:34:41.876885 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/calogica/dbt_date.json 200
[0m20:34:41.896863 [info ] [MainThread]: Installing calogica/dbt_expectations
[0m20:34:42.553055 [info ] [MainThread]: Installed from version 0.10.0
[0m20:34:42.553421 [info ] [MainThread]: Up to date!
[0m20:34:42.553717 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': 'c7435b01-a637-48f0-95b9-8665b3c32cea', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10510f760>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10510efb0>]}
[0m20:34:42.554013 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m20:34:42.945248 [info ] [MainThread]: Installed from version 1.1.1
[0m20:34:42.945631 [info ] [MainThread]: Up to date!
[0m20:34:42.945925 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': 'c7435b01-a637-48f0-95b9-8665b3c32cea', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10510f760>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1051c8e20>]}
[0m20:34:42.946227 [info ] [MainThread]: Installing calogica/dbt_date
[0m20:34:43.293883 [info ] [MainThread]: Installed from version 0.9.2
[0m20:34:43.294300 [info ] [MainThread]: Up to date!
[0m20:34:43.294627 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': 'c7435b01-a637-48f0-95b9-8665b3c32cea', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10510efb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1051c8f70>]}
[0m20:34:43.295779 [debug] [MainThread]: Command `dbt deps` succeeded at 20:34:43.295687 after 1.86 seconds
[0m20:34:43.296093 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1033253f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10516f910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10516e500>]}
[0m20:34:43.296363 [debug] [MainThread]: Flushing usage events
[0m20:34:50.339230 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10342d4b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105216620>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105217010>]}


============================== 20:34:50.342136 | 73cda980-ee26-48f3-a1a6-38c1720dde4a ==============================
[0m20:34:50.342136 [info ] [MainThread]: Running with dbt=1.6.6
[0m20:34:50.342532 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/alejandroaboy/Desktop/dbt_duckdb_piwik', 'debug': 'False', 'version_check': 'True', 'log_path': '/Users/alejandroaboy/Desktop/dbt_duckdb_piwik/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt debug', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m20:34:50.342896 [info ] [MainThread]: dbt version: 1.6.6
[0m20:34:50.343097 [info ] [MainThread]: python version: 3.10.2
[0m20:34:50.343283 [info ] [MainThread]: python path: /Users/alejandroaboy/Desktop/dbt-env/bin/python3
[0m20:34:50.343470 [info ] [MainThread]: os info: macOS-13.4-arm64-arm-64bit
[0m20:34:50.348182 [error] [MainThread]: Encountered an error:
Parsing Error
  Env var required but not provided: 'MOTHERDUCK_TOKEN'
[0m20:34:50.348651 [debug] [MainThread]: Command `dbt debug` failed at 20:34:50.348577 after 0.02 seconds
[0m20:34:50.348896 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10342d4b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105271d20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105271480>]}
[0m20:34:50.349165 [debug] [MainThread]: Flushing usage events
[0m20:35:10.415354 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104c2b130>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106c42530>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106c42f20>]}


============================== 20:35:10.418264 | 93d03808-928a-4ec1-affe-c4db1de15d3c ==============================
[0m20:35:10.418264 [info ] [MainThread]: Running with dbt=1.6.6
[0m20:35:10.418658 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/alejandroaboy/Desktop/dbt_duckdb_piwik', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/Users/alejandroaboy/Desktop/dbt_duckdb_piwik/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt debug', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m20:35:10.419027 [info ] [MainThread]: dbt version: 1.6.6
[0m20:35:10.419235 [info ] [MainThread]: python version: 3.10.2
[0m20:35:10.419426 [info ] [MainThread]: python path: /Users/alejandroaboy/Desktop/dbt-env/bin/python3
[0m20:35:10.419624 [info ] [MainThread]: os info: macOS-13.4-arm64-arm-64bit
[0m20:35:10.424260 [error] [MainThread]: Encountered an error:
Parsing Error
  Env var required but not provided: 'S3_ACCESS_KEY_ID'
[0m20:35:10.424731 [debug] [MainThread]: Command `dbt debug` failed at 20:35:10.424657 after 0.02 seconds
[0m20:35:10.425050 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104c2b130>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106c437c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106c43f40>]}
[0m20:35:10.425364 [debug] [MainThread]: Flushing usage events
[0m20:35:43.744216 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10783d480>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1099b65f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1099b6fe0>]}


============================== 20:35:43.747320 | c78ca741-0539-4906-bab6-e10966eb95ba ==============================
[0m20:35:43.747320 [info ] [MainThread]: Running with dbt=1.6.6
[0m20:35:43.747754 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/alejandroaboy/Desktop/dbt_duckdb_piwik', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/Users/alejandroaboy/Desktop/dbt_duckdb_piwik/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt debug', 'send_anonymous_usage_stats': 'True'}
[0m20:35:43.748163 [info ] [MainThread]: dbt version: 1.6.6
[0m20:35:43.748386 [info ] [MainThread]: python version: 3.10.2
[0m20:35:43.748592 [info ] [MainThread]: python path: /Users/alejandroaboy/Desktop/dbt-env/bin/python3
[0m20:35:43.748792 [info ] [MainThread]: os info: macOS-13.4-arm64-arm-64bit
[0m20:35:43.846788 [info ] [MainThread]: Using profiles dir at /Users/alejandroaboy/Desktop/dbt_duckdb_piwik
[0m20:35:43.847143 [info ] [MainThread]: Using profiles.yml file at /Users/alejandroaboy/Desktop/dbt_duckdb_piwik/profiles.yml
[0m20:35:43.847366 [info ] [MainThread]: Using dbt_project.yml file at /Users/alejandroaboy/Desktop/dbt_duckdb_piwik/dbt_project.yml
[0m20:35:43.847745 [info ] [MainThread]: adapter type: duckdb
[0m20:35:43.847953 [info ] [MainThread]: adapter version: 1.6.1
[0m20:35:43.863928 [info ] [MainThread]: Configuration:
[0m20:35:43.864268 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m20:35:43.864519 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m20:35:43.864724 [info ] [MainThread]: Required dependencies:
[0m20:35:43.864971 [debug] [MainThread]: Executing "git --help"
[0m20:35:43.879118 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--super-prefix=<path>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m20:35:43.879857 [debug] [MainThread]: STDERR: "b''"
[0m20:35:43.880136 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m20:35:43.880378 [info ] [MainThread]: Connection:
[0m20:35:43.880756 [info ] [MainThread]:   database: my_db
[0m20:35:43.880983 [info ] [MainThread]:   schema: main
[0m20:35:43.881194 [info ] [MainThread]:   path: md:my_db?motherduck_token=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzZXNzaW9uIjoiYWJveWFsZWphbmRyby5nbWFpbC5jb20iLCJlbWFpbCI6ImFib3lhbGVqYW5kcm9AZ21haWwuY29tIiwidXNlcklkIjoiN2RmN2RlZGMtMTAxNS00YzdmLWFjZGQtOWIwMTQ2YThmNGMzIiwiaWF0IjoxNjk4MDgwMjkxLCJleHAiOjE3Mjk2Mzc4OTF9.-0ymiAa0hM0BJ_mqWWts04HJGnGuaywanfGfJEk4e-o
[0m20:35:43.881400 [info ] [MainThread]:   config_options: None
[0m20:35:43.881597 [info ] [MainThread]:   extensions: ['httpfs', 's3']
[0m20:35:43.881793 [info ] [MainThread]:   settings: {'s3_region': 'eu-west-3', 's3_access_key_id': 'AKIAR2IFL3D7PNIWFNAS', 's3_secret_access_key': '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'}
[0m20:35:43.882003 [info ] [MainThread]:   external_root: .
[0m20:35:43.882192 [info ] [MainThread]:   use_credential_provider: None
[0m20:35:43.882379 [info ] [MainThread]:   attach: None
[0m20:35:43.882565 [info ] [MainThread]:   filesystems: None
[0m20:35:43.882749 [info ] [MainThread]:   remote: None
[0m20:35:43.882933 [info ] [MainThread]:   plugins: None
[0m20:35:43.883116 [info ] [MainThread]:   disable_transactions: True
[0m20:35:43.883473 [info ] [MainThread]: Registered adapter: duckdb=1.6.1
[0m20:35:43.903937 [debug] [MainThread]: Acquiring new duckdb connection 'debug'
[0m20:35:43.904695 [debug] [MainThread]: Using duckdb connection "debug"
[0m20:35:43.904948 [debug] [MainThread]: On debug: select 1 as id
[0m20:35:43.905156 [debug] [MainThread]: Opening a new connection, currently in state init
[0m20:35:50.697332 [debug] [MainThread]: SQL status: OK in 7.0 seconds
[0m20:35:50.699736 [debug] [MainThread]: On debug: Close
[0m20:35:50.700242 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m20:35:50.700583 [info ] [MainThread]: [32mAll checks passed![0m
[0m20:35:50.701476 [debug] [MainThread]: Command `dbt debug` succeeded at 20:35:50.701346 after 6.97 seconds
[0m20:35:50.701823 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m20:35:50.702199 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10783d480>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109abd9f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109abc370>]}
[0m20:35:50.702730 [debug] [MainThread]: Flushing usage events
[0m20:35:57.854901 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10317b130>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104f1e290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104f1f100>]}


============================== 20:35:57.858456 | fe466ef1-8c3b-4471-a759-e6bb97e564d9 ==============================
[0m20:35:57.858456 [info ] [MainThread]: Running with dbt=1.6.6
[0m20:35:57.858863 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/Users/alejandroaboy/Desktop/dbt_duckdb_piwik/logs', 'profiles_dir': '/Users/alejandroaboy/Desktop/dbt_duckdb_piwik', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt build', 'send_anonymous_usage_stats': 'True'}
[0m20:35:57.943409 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'fe466ef1-8c3b-4471-a759-e6bb97e564d9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x100d77fd0>]}
[0m20:35:57.954699 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'fe466ef1-8c3b-4471-a759-e6bb97e564d9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1050297e0>]}
[0m20:35:57.955306 [info ] [MainThread]: Registered adapter: duckdb=1.6.1
[0m20:35:57.980305 [debug] [MainThread]: checksum: 546b81fb56652c304d87abd676e84d4737d8a0c6b62160f4a6e79dcddbc842bb, vars: {}, profile: , target: , version: 1.6.6
[0m20:35:58.002323 [info ] [MainThread]: Unable to do partial parsing because profile has changed
[0m20:35:58.002844 [info ] [MainThread]: Unable to do partial parsing because env vars used in profiles.yml have changed
[0m20:35:58.003294 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m20:35:58.003576 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'fe466ef1-8c3b-4471-a759-e6bb97e564d9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104ffea10>]}
[0m20:35:59.144387 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- seeds
[0m20:35:59.148510 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'fe466ef1-8c3b-4471-a759-e6bb97e564d9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1053f1030>]}
[0m20:35:59.162042 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'fe466ef1-8c3b-4471-a759-e6bb97e564d9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1053f36a0>]}
[0m20:35:59.162450 [info ] [MainThread]: Found 9 models, 1 snapshot, 16 tests, 3 sources, 0 exposures, 0 metrics, 716 macros, 0 groups, 0 semantic models
[0m20:35:59.164276 [info ] [MainThread]: 
[0m20:35:59.164852 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m20:35:59.165781 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_my_db'
[0m20:35:59.174240 [debug] [ThreadPool]: Using duckdb connection "list_my_db"
[0m20:35:59.174607 [debug] [ThreadPool]: On list_my_db: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "dbt_playground", "target_name": "dev", "connection_name": "list_my_db"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"my_db"'
    
  
  
[0m20:35:59.174830 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:36:01.616034 [debug] [ThreadPool]: SQL status: OK in 2.0 seconds
[0m20:36:01.620244 [debug] [ThreadPool]: On list_my_db: Close
[0m20:36:01.621691 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_my_db, now list_analytics)
[0m20:36:01.625630 [debug] [ThreadPool]: Using duckdb connection "list_analytics"
[0m20:36:01.626023 [debug] [ThreadPool]: On list_analytics: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "dbt_playground", "target_name": "dev", "connection_name": "list_analytics"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"analytics"'
    
  
  
[0m20:36:01.626365 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:36:01.895751 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m20:36:01.898368 [debug] [ThreadPool]: On list_analytics: Close
[0m20:36:01.900060 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_analytics, now create_analytics_dbt)
[0m20:36:01.900989 [debug] [ThreadPool]: Creating schema "database: "analytics"
schema: "dbt"
"
[0m20:36:01.907591 [debug] [ThreadPool]: Using duckdb connection "create_analytics_dbt"
[0m20:36:01.908016 [debug] [ThreadPool]: On create_analytics_dbt: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "dbt_playground", "target_name": "dev", "connection_name": "create_analytics_dbt"} */
create schema if not exists "analytics"."dbt"
[0m20:36:01.908360 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:36:02.455817 [debug] [ThreadPool]: SQL status: OK in 1.0 seconds
[0m20:36:02.458563 [debug] [ThreadPool]: On create_analytics_dbt: Close
[0m20:36:02.460536 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_analytics_dbt, now create_my_db_main)
[0m20:36:02.461751 [debug] [ThreadPool]: Creating schema "database: "my_db"
schema: "main"
"
[0m20:36:02.465716 [debug] [ThreadPool]: Using duckdb connection "create_my_db_main"
[0m20:36:02.466208 [debug] [ThreadPool]: On create_my_db_main: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "dbt_playground", "target_name": "dev", "connection_name": "create_my_db_main"} */
create schema if not exists "my_db"."main"
[0m20:36:02.466610 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:36:02.929299 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m20:36:02.934557 [debug] [ThreadPool]: On create_my_db_main: Close
[0m20:36:02.939179 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_my_db_main, now list_analytics_dbt)
[0m20:36:02.946696 [debug] [ThreadPool]: Using duckdb connection "list_analytics_dbt"
[0m20:36:02.947130 [debug] [ThreadPool]: On list_analytics_dbt: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "dbt_playground", "target_name": "dev", "connection_name": "list_analytics_dbt"} */
select
      'analytics' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'dbt'
    and table_catalog = 'analytics'
  
[0m20:36:02.947470 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:36:03.256755 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m20:36:03.258515 [debug] [ThreadPool]: On list_analytics_dbt: Close
[0m20:36:03.259320 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_analytics_dbt, now list_my_db_main)
[0m20:36:03.262429 [debug] [ThreadPool]: Using duckdb connection "list_my_db_main"
[0m20:36:03.262681 [debug] [ThreadPool]: On list_my_db_main: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "dbt_playground", "target_name": "dev", "connection_name": "list_my_db_main"} */
select
      'my_db' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'main'
    and table_catalog = 'my_db'
  
[0m20:36:03.262896 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:36:03.542635 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m20:36:03.545951 [debug] [ThreadPool]: On list_my_db_main: Close
[0m20:36:03.547229 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fe466ef1-8c3b-4471-a759-e6bb97e564d9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1058cb8b0>]}
[0m20:36:03.547824 [debug] [MainThread]: Using duckdb connection "master"
[0m20:36:03.548161 [debug] [MainThread]: On master: BEGIN
[0m20:36:03.548476 [debug] [MainThread]: Opening a new connection, currently in state init
[0m20:36:03.819374 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m20:36:03.820235 [debug] [MainThread]: On master: COMMIT
[0m20:36:03.820600 [debug] [MainThread]: Using duckdb connection "master"
[0m20:36:03.820927 [debug] [MainThread]: On master: COMMIT
[0m20:36:03.821294 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m20:36:03.821645 [debug] [MainThread]: On master: Close
[0m20:36:03.822550 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m20:36:03.822953 [info ] [MainThread]: 
[0m20:36:03.826815 [debug] [Thread-1 (]: Began running node model.dbt_playground.stg_analytics
[0m20:36:03.827440 [info ] [Thread-1 (]: 1 of 26 START sql view model main.stg_analytics ................................ [RUN]
[0m20:36:03.828410 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_my_db_main, now model.dbt_playground.stg_analytics)
[0m20:36:03.829681 [debug] [Thread-1 (]: Began compiling node model.dbt_playground.stg_analytics
[0m20:36:03.837253 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_playground.stg_analytics"
[0m20:36:03.838364 [debug] [Thread-1 (]: Timing info for model.dbt_playground.stg_analytics (compile): 20:36:03.830067 => 20:36:03.838186
[0m20:36:03.838700 [debug] [Thread-1 (]: Began executing node model.dbt_playground.stg_analytics
[0m20:36:03.862085 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_playground.stg_analytics"
[0m20:36:03.863012 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_playground.stg_analytics"
[0m20:36:03.863294 [debug] [Thread-1 (]: On model.dbt_playground.stg_analytics: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "dbt_playground", "target_name": "dev", "node_id": "model.dbt_playground.stg_analytics"} */

  
  create view "my_db"."main"."stg_analytics__dbt_tmp" as (
    select *
from "raw"."piwik"."analytics"
  );

[0m20:36:03.863545 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:36:04.402147 [debug] [Thread-1 (]: SQL status: OK in 1.0 seconds
[0m20:36:04.412188 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_playground.stg_analytics"
[0m20:36:04.412896 [debug] [Thread-1 (]: On model.dbt_playground.stg_analytics: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "dbt_playground", "target_name": "dev", "node_id": "model.dbt_playground.stg_analytics"} */
alter view "my_db"."main"."stg_analytics__dbt_tmp" rename to "stg_analytics"
[0m20:36:04.684946 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m20:36:04.712002 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_playground.stg_analytics"
[0m20:36:04.712595 [debug] [Thread-1 (]: On model.dbt_playground.stg_analytics: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "dbt_playground", "target_name": "dev", "node_id": "model.dbt_playground.stg_analytics"} */
drop view if exists "my_db"."main"."stg_analytics__dbt_backup" cascade
[0m20:36:04.894084 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m20:36:04.897762 [debug] [Thread-1 (]: Timing info for model.dbt_playground.stg_analytics (execute): 20:36:03.839061 => 20:36:04.897452
[0m20:36:04.898441 [debug] [Thread-1 (]: On model.dbt_playground.stg_analytics: Close
[0m20:36:04.899716 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fe466ef1-8c3b-4471-a759-e6bb97e564d9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10584cbe0>]}
[0m20:36:04.900720 [info ] [Thread-1 (]: 1 of 26 OK created sql view model main.stg_analytics ........................... [[32mOK[0m in 1.07s]
[0m20:36:04.901527 [debug] [Thread-1 (]: Finished running node model.dbt_playground.stg_analytics
[0m20:36:04.902073 [debug] [Thread-1 (]: Began running node model.dbt_playground.stg_events
[0m20:36:04.902872 [info ] [Thread-1 (]: 2 of 26 START sql view model main.stg_events ................................... [RUN]
[0m20:36:04.903747 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_playground.stg_analytics, now model.dbt_playground.stg_events)
[0m20:36:04.904213 [debug] [Thread-1 (]: Began compiling node model.dbt_playground.stg_events
[0m20:36:04.909115 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_playground.stg_events"
[0m20:36:04.910223 [debug] [Thread-1 (]: Timing info for model.dbt_playground.stg_events (compile): 20:36:04.904545 => 20:36:04.910035
[0m20:36:04.910628 [debug] [Thread-1 (]: Began executing node model.dbt_playground.stg_events
[0m20:36:04.914977 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_playground.stg_events"
[0m20:36:04.915689 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_playground.stg_events"
[0m20:36:04.916135 [debug] [Thread-1 (]: On model.dbt_playground.stg_events: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "dbt_playground", "target_name": "dev", "node_id": "model.dbt_playground.stg_events"} */

  
  create view "my_db"."main"."stg_events__dbt_tmp" as (
    select *
from "raw"."piwik"."streaming"
  );

[0m20:36:04.916534 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:36:05.456380 [debug] [Thread-1 (]: SQL status: OK in 1.0 seconds
[0m20:36:05.459163 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_playground.stg_events"
[0m20:36:05.459459 [debug] [Thread-1 (]: On model.dbt_playground.stg_events: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "dbt_playground", "target_name": "dev", "node_id": "model.dbt_playground.stg_events"} */
alter view "my_db"."main"."stg_events__dbt_tmp" rename to "stg_events"
[0m20:36:05.724536 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m20:36:05.729278 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_playground.stg_events"
[0m20:36:05.729680 [debug] [Thread-1 (]: On model.dbt_playground.stg_events: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "dbt_playground", "target_name": "dev", "node_id": "model.dbt_playground.stg_events"} */
drop view if exists "my_db"."main"."stg_events__dbt_backup" cascade
[0m20:36:05.906650 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m20:36:05.907904 [debug] [Thread-1 (]: Timing info for model.dbt_playground.stg_events (execute): 20:36:04.910907 => 20:36:05.907788
[0m20:36:05.908187 [debug] [Thread-1 (]: On model.dbt_playground.stg_events: Close
[0m20:36:05.908719 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fe466ef1-8c3b-4471-a759-e6bb97e564d9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1053d3f10>]}
[0m20:36:05.909132 [info ] [Thread-1 (]: 2 of 26 OK created sql view model main.stg_events .............................. [[32mOK[0m in 1.01s]
[0m20:36:05.909509 [debug] [Thread-1 (]: Finished running node model.dbt_playground.stg_events
[0m20:36:05.909795 [debug] [Thread-1 (]: Began running node model.dbt_playground.stg_sessions
[0m20:36:05.910300 [info ] [Thread-1 (]: 3 of 26 START sql view model main.stg_sessions ................................. [RUN]
[0m20:36:05.910789 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_playground.stg_events, now model.dbt_playground.stg_sessions)
[0m20:36:05.911037 [debug] [Thread-1 (]: Began compiling node model.dbt_playground.stg_sessions
[0m20:36:05.913457 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_playground.stg_sessions"
[0m20:36:05.914067 [debug] [Thread-1 (]: Timing info for model.dbt_playground.stg_sessions (compile): 20:36:05.911204 => 20:36:05.913951
[0m20:36:05.914321 [debug] [Thread-1 (]: Began executing node model.dbt_playground.stg_sessions
[0m20:36:05.917161 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_playground.stg_sessions"
[0m20:36:05.917687 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_playground.stg_sessions"
[0m20:36:05.917949 [debug] [Thread-1 (]: On model.dbt_playground.stg_sessions: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "dbt_playground", "target_name": "dev", "node_id": "model.dbt_playground.stg_sessions"} */

  
  create view "my_db"."main"."stg_sessions__dbt_tmp" as (
    select *
from "raw"."piwik"."sessions"
  );

[0m20:36:05.918188 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:36:06.460408 [debug] [Thread-1 (]: SQL status: OK in 1.0 seconds
[0m20:36:06.466783 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_playground.stg_sessions"
[0m20:36:06.467333 [debug] [Thread-1 (]: On model.dbt_playground.stg_sessions: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "dbt_playground", "target_name": "dev", "node_id": "model.dbt_playground.stg_sessions"} */
alter view "my_db"."main"."stg_sessions__dbt_tmp" rename to "stg_sessions"
[0m20:36:06.736442 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m20:36:06.741891 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_playground.stg_sessions"
[0m20:36:06.742305 [debug] [Thread-1 (]: On model.dbt_playground.stg_sessions: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "dbt_playground", "target_name": "dev", "node_id": "model.dbt_playground.stg_sessions"} */
drop view if exists "my_db"."main"."stg_sessions__dbt_backup" cascade
[0m20:36:06.935456 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m20:36:06.939594 [debug] [Thread-1 (]: Timing info for model.dbt_playground.stg_sessions (execute): 20:36:05.914496 => 20:36:06.939232
[0m20:36:06.940407 [debug] [Thread-1 (]: On model.dbt_playground.stg_sessions: Close
[0m20:36:06.942004 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fe466ef1-8c3b-4471-a759-e6bb97e564d9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105604a60>]}
[0m20:36:06.943229 [info ] [Thread-1 (]: 3 of 26 OK created sql view model main.stg_sessions ............................ [[32mOK[0m in 1.03s]
[0m20:36:06.944562 [debug] [Thread-1 (]: Finished running node model.dbt_playground.stg_sessions
[0m20:36:06.945341 [debug] [Thread-1 (]: Began running node test.dbt_playground.accepted_values_stg_analytics_referrer_type__Social__Direct_entry__Website__Search_engine__Campaign.b7c253d4f3
[0m20:36:06.946396 [info ] [Thread-1 (]: 4 of 26 START test accepted_values_stg_analytics_referrer_type__Social__Direct_entry__Website__Search_engine__Campaign  [RUN]
[0m20:36:06.947470 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_playground.stg_sessions, now test.dbt_playground.accepted_values_stg_analytics_referrer_type__Social__Direct_entry__Website__Search_engine__Campaign.b7c253d4f3)
[0m20:36:06.947975 [debug] [Thread-1 (]: Began compiling node test.dbt_playground.accepted_values_stg_analytics_referrer_type__Social__Direct_entry__Website__Search_engine__Campaign.b7c253d4f3
[0m20:36:06.956269 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_playground.accepted_values_stg_analytics_referrer_type__Social__Direct_entry__Website__Search_engine__Campaign.b7c253d4f3"
[0m20:36:06.957575 [debug] [Thread-1 (]: Timing info for test.dbt_playground.accepted_values_stg_analytics_referrer_type__Social__Direct_entry__Website__Search_engine__Campaign.b7c253d4f3 (compile): 20:36:06.948295 => 20:36:06.957367
[0m20:36:06.957994 [debug] [Thread-1 (]: Began executing node test.dbt_playground.accepted_values_stg_analytics_referrer_type__Social__Direct_entry__Website__Search_engine__Campaign.b7c253d4f3
[0m20:36:06.970669 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_playground.accepted_values_stg_analytics_referrer_type__Social__Direct_entry__Website__Search_engine__Campaign.b7c253d4f3"
[0m20:36:06.971458 [debug] [Thread-1 (]: Using duckdb connection "test.dbt_playground.accepted_values_stg_analytics_referrer_type__Social__Direct_entry__Website__Search_engine__Campaign.b7c253d4f3"
[0m20:36:06.971785 [debug] [Thread-1 (]: On test.dbt_playground.accepted_values_stg_analytics_referrer_type__Social__Direct_entry__Website__Search_engine__Campaign.b7c253d4f3: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "dbt_playground", "target_name": "dev", "node_id": "test.dbt_playground.accepted_values_stg_analytics_referrer_type__Social__Direct_entry__Website__Search_engine__Campaign.b7c253d4f3"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        referrer_type as value_field,
        count(*) as n_records

    from "my_db"."main"."stg_analytics"
    group by referrer_type

)

select *
from all_values
where value_field not in (
    'Social','Direct entry','Website','Search engine','Campaign'
)



      
    ) dbt_internal_test
[0m20:36:06.972095 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:36:07.341856 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m20:36:07.451370 [debug] [Thread-1 (]: Timing info for test.dbt_playground.accepted_values_stg_analytics_referrer_type__Social__Direct_entry__Website__Search_engine__Campaign.b7c253d4f3 (execute): 20:36:06.958254 => 20:36:07.450710
[0m20:36:07.452628 [debug] [Thread-1 (]: On test.dbt_playground.accepted_values_stg_analytics_referrer_type__Social__Direct_entry__Website__Search_engine__Campaign.b7c253d4f3: Close
[0m20:36:07.454401 [info ] [Thread-1 (]: 4 of 26 PASS accepted_values_stg_analytics_referrer_type__Social__Direct_entry__Website__Search_engine__Campaign  [[32mPASS[0m in 0.51s]
[0m20:36:07.455696 [debug] [Thread-1 (]: Finished running node test.dbt_playground.accepted_values_stg_analytics_referrer_type__Social__Direct_entry__Website__Search_engine__Campaign.b7c253d4f3
[0m20:36:07.456441 [debug] [Thread-1 (]: Began running node test.dbt_playground.accepted_values_stg_analytics_visitor_returning__Returning.da51a72cd4
[0m20:36:07.457257 [info ] [Thread-1 (]: 5 of 26 START test accepted_values_stg_analytics_visitor_returning__Returning .. [RUN]
[0m20:36:07.458235 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_playground.accepted_values_stg_analytics_referrer_type__Social__Direct_entry__Website__Search_engine__Campaign.b7c253d4f3, now test.dbt_playground.accepted_values_stg_analytics_visitor_returning__Returning.da51a72cd4)
[0m20:36:07.458772 [debug] [Thread-1 (]: Began compiling node test.dbt_playground.accepted_values_stg_analytics_visitor_returning__Returning.da51a72cd4
[0m20:36:07.465940 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_playground.accepted_values_stg_analytics_visitor_returning__Returning.da51a72cd4"
[0m20:36:07.467207 [debug] [Thread-1 (]: Timing info for test.dbt_playground.accepted_values_stg_analytics_visitor_returning__Returning.da51a72cd4 (compile): 20:36:07.459130 => 20:36:07.466985
[0m20:36:07.467673 [debug] [Thread-1 (]: Began executing node test.dbt_playground.accepted_values_stg_analytics_visitor_returning__Returning.da51a72cd4
[0m20:36:07.471152 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_playground.accepted_values_stg_analytics_visitor_returning__Returning.da51a72cd4"
[0m20:36:07.472202 [debug] [Thread-1 (]: Using duckdb connection "test.dbt_playground.accepted_values_stg_analytics_visitor_returning__Returning.da51a72cd4"
[0m20:36:07.472623 [debug] [Thread-1 (]: On test.dbt_playground.accepted_values_stg_analytics_visitor_returning__Returning.da51a72cd4: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "dbt_playground", "target_name": "dev", "node_id": "test.dbt_playground.accepted_values_stg_analytics_visitor_returning__Returning.da51a72cd4"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        visitor_returning as value_field,
        count(*) as n_records

    from "my_db"."main"."stg_analytics"
    group by visitor_returning

)

select *
from all_values
where value_field not in (
    'Returning'
)



      
    ) dbt_internal_test
[0m20:36:07.472995 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:36:07.840718 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m20:36:07.938979 [debug] [Thread-1 (]: Timing info for test.dbt_playground.accepted_values_stg_analytics_visitor_returning__Returning.da51a72cd4 (execute): 20:36:07.467970 => 20:36:07.938164
[0m20:36:07.940307 [debug] [Thread-1 (]: On test.dbt_playground.accepted_values_stg_analytics_visitor_returning__Returning.da51a72cd4: Close
[0m20:36:07.942062 [info ] [Thread-1 (]: 5 of 26 PASS accepted_values_stg_analytics_visitor_returning__Returning ........ [[32mPASS[0m in 0.48s]
[0m20:36:07.943550 [debug] [Thread-1 (]: Finished running node test.dbt_playground.accepted_values_stg_analytics_visitor_returning__Returning.da51a72cd4
[0m20:36:07.944409 [debug] [Thread-1 (]: Began running node test.dbt_playground.dbt_expectations_expect_column_to_exist_stg_events_event_id.217a55054e
[0m20:36:07.945412 [info ] [Thread-1 (]: 6 of 26 START test dbt_expectations_expect_column_to_exist_stg_events_event_id . [RUN]
[0m20:36:07.946696 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_playground.accepted_values_stg_analytics_visitor_returning__Returning.da51a72cd4, now test.dbt_playground.dbt_expectations_expect_column_to_exist_stg_events_event_id.217a55054e)
[0m20:36:07.947230 [debug] [Thread-1 (]: Began compiling node test.dbt_playground.dbt_expectations_expect_column_to_exist_stg_events_event_id.217a55054e
[0m20:36:07.963777 [debug] [Thread-1 (]: Using duckdb connection "test.dbt_playground.dbt_expectations_expect_column_to_exist_stg_events_event_id.217a55054e"
[0m20:36:07.964403 [debug] [Thread-1 (]: On test.dbt_playground.dbt_expectations_expect_column_to_exist_stg_events_event_id.217a55054e: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "dbt_playground", "target_name": "dev", "node_id": "test.dbt_playground.dbt_expectations_expect_column_to_exist_stg_events_event_id.217a55054e"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'stg_events'
      
      and table_schema = 'main'
      
      
      and table_catalog = 'my_db'
      
      order by ordinal_position

  
[0m20:36:07.964811 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:36:08.294562 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m20:36:08.299146 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_playground.dbt_expectations_expect_column_to_exist_stg_events_event_id.217a55054e"
[0m20:36:08.300067 [debug] [Thread-1 (]: Timing info for test.dbt_playground.dbt_expectations_expect_column_to_exist_stg_events_event_id.217a55054e (compile): 20:36:07.947622 => 20:36:08.299897
[0m20:36:08.300399 [debug] [Thread-1 (]: Began executing node test.dbt_playground.dbt_expectations_expect_column_to_exist_stg_events_event_id.217a55054e
[0m20:36:08.303270 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_playground.dbt_expectations_expect_column_to_exist_stg_events_event_id.217a55054e"
[0m20:36:08.303802 [debug] [Thread-1 (]: Using duckdb connection "test.dbt_playground.dbt_expectations_expect_column_to_exist_stg_events_event_id.217a55054e"
[0m20:36:08.304103 [debug] [Thread-1 (]: On test.dbt_playground.dbt_expectations_expect_column_to_exist_stg_events_event_id.217a55054e: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "dbt_playground", "target_name": "dev", "node_id": "test.dbt_playground.dbt_expectations_expect_column_to_exist_stg_events_event_id.217a55054e"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      

    with test_data as (

        select
            cast('EVENT_ID' as TEXT) as column_name,
            1 as matching_column_index,
            True as column_index_matches

    )
    select *
    from test_data
    where
        not(matching_column_index >= 0 and column_index_matches)
      
    ) dbt_internal_test
[0m20:36:08.305110 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m20:36:08.306108 [debug] [Thread-1 (]: Timing info for test.dbt_playground.dbt_expectations_expect_column_to_exist_stg_events_event_id.217a55054e (execute): 20:36:08.300606 => 20:36:08.305981
[0m20:36:08.306375 [debug] [Thread-1 (]: On test.dbt_playground.dbt_expectations_expect_column_to_exist_stg_events_event_id.217a55054e: Close
[0m20:36:08.306998 [info ] [Thread-1 (]: 6 of 26 PASS dbt_expectations_expect_column_to_exist_stg_events_event_id ....... [[32mPASS[0m in 0.36s]
[0m20:36:08.307379 [debug] [Thread-1 (]: Finished running node test.dbt_playground.dbt_expectations_expect_column_to_exist_stg_events_event_id.217a55054e
[0m20:36:08.307668 [debug] [Thread-1 (]: Began running node test.dbt_playground.dbt_expectations_expect_column_to_exist_stg_events_session_id.c5e72af676
[0m20:36:08.307963 [info ] [Thread-1 (]: 7 of 26 START test dbt_expectations_expect_column_to_exist_stg_events_session_id  [RUN]
[0m20:36:08.308376 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_playground.dbt_expectations_expect_column_to_exist_stg_events_event_id.217a55054e, now test.dbt_playground.dbt_expectations_expect_column_to_exist_stg_events_session_id.c5e72af676)
[0m20:36:08.308619 [debug] [Thread-1 (]: Began compiling node test.dbt_playground.dbt_expectations_expect_column_to_exist_stg_events_session_id.c5e72af676
[0m20:36:08.312938 [debug] [Thread-1 (]: Using duckdb connection "test.dbt_playground.dbt_expectations_expect_column_to_exist_stg_events_session_id.c5e72af676"
[0m20:36:08.313374 [debug] [Thread-1 (]: On test.dbt_playground.dbt_expectations_expect_column_to_exist_stg_events_session_id.c5e72af676: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "dbt_playground", "target_name": "dev", "node_id": "test.dbt_playground.dbt_expectations_expect_column_to_exist_stg_events_session_id.c5e72af676"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'stg_events'
      
      and table_schema = 'main'
      
      
      and table_catalog = 'my_db'
      
      order by ordinal_position

  
[0m20:36:08.313763 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:36:08.608539 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m20:36:08.610211 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_playground.dbt_expectations_expect_column_to_exist_stg_events_session_id.c5e72af676"
[0m20:36:08.610860 [debug] [Thread-1 (]: Timing info for test.dbt_playground.dbt_expectations_expect_column_to_exist_stg_events_session_id.c5e72af676 (compile): 20:36:08.308786 => 20:36:08.610723
[0m20:36:08.611139 [debug] [Thread-1 (]: Began executing node test.dbt_playground.dbt_expectations_expect_column_to_exist_stg_events_session_id.c5e72af676
[0m20:36:08.614188 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_playground.dbt_expectations_expect_column_to_exist_stg_events_session_id.c5e72af676"
[0m20:36:08.614656 [debug] [Thread-1 (]: Using duckdb connection "test.dbt_playground.dbt_expectations_expect_column_to_exist_stg_events_session_id.c5e72af676"
[0m20:36:08.614927 [debug] [Thread-1 (]: On test.dbt_playground.dbt_expectations_expect_column_to_exist_stg_events_session_id.c5e72af676: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "dbt_playground", "target_name": "dev", "node_id": "test.dbt_playground.dbt_expectations_expect_column_to_exist_stg_events_session_id.c5e72af676"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      

    with test_data as (

        select
            cast('SESSION_ID' as TEXT) as column_name,
            0 as matching_column_index,
            True as column_index_matches

    )
    select *
    from test_data
    where
        not(matching_column_index >= 0 and column_index_matches)
      
    ) dbt_internal_test
[0m20:36:08.615611 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m20:36:08.616606 [debug] [Thread-1 (]: Timing info for test.dbt_playground.dbt_expectations_expect_column_to_exist_stg_events_session_id.c5e72af676 (execute): 20:36:08.611319 => 20:36:08.616474
[0m20:36:08.616885 [debug] [Thread-1 (]: On test.dbt_playground.dbt_expectations_expect_column_to_exist_stg_events_session_id.c5e72af676: Close
[0m20:36:08.617521 [info ] [Thread-1 (]: 7 of 26 PASS dbt_expectations_expect_column_to_exist_stg_events_session_id ..... [[32mPASS[0m in 0.31s]
[0m20:36:08.617919 [debug] [Thread-1 (]: Finished running node test.dbt_playground.dbt_expectations_expect_column_to_exist_stg_events_session_id.c5e72af676
[0m20:36:08.618214 [debug] [Thread-1 (]: Began running node test.dbt_playground.dbt_expectations_expect_column_to_exist_stg_events_visitor_id.8a7ec39171
[0m20:36:08.618574 [info ] [Thread-1 (]: 8 of 26 START test dbt_expectations_expect_column_to_exist_stg_events_visitor_id  [RUN]
[0m20:36:08.619013 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_playground.dbt_expectations_expect_column_to_exist_stg_events_session_id.c5e72af676, now test.dbt_playground.dbt_expectations_expect_column_to_exist_stg_events_visitor_id.8a7ec39171)
[0m20:36:08.619261 [debug] [Thread-1 (]: Began compiling node test.dbt_playground.dbt_expectations_expect_column_to_exist_stg_events_visitor_id.8a7ec39171
[0m20:36:08.623991 [debug] [Thread-1 (]: Using duckdb connection "test.dbt_playground.dbt_expectations_expect_column_to_exist_stg_events_visitor_id.8a7ec39171"
[0m20:36:08.624366 [debug] [Thread-1 (]: On test.dbt_playground.dbt_expectations_expect_column_to_exist_stg_events_visitor_id.8a7ec39171: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "dbt_playground", "target_name": "dev", "node_id": "test.dbt_playground.dbt_expectations_expect_column_to_exist_stg_events_visitor_id.8a7ec39171"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'stg_events'
      
      and table_schema = 'main'
      
      
      and table_catalog = 'my_db'
      
      order by ordinal_position

  
[0m20:36:08.624627 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:36:08.924331 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m20:36:08.926728 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_playground.dbt_expectations_expect_column_to_exist_stg_events_visitor_id.8a7ec39171"
[0m20:36:08.927704 [debug] [Thread-1 (]: Timing info for test.dbt_playground.dbt_expectations_expect_column_to_exist_stg_events_visitor_id.8a7ec39171 (compile): 20:36:08.619430 => 20:36:08.927523
[0m20:36:08.928061 [debug] [Thread-1 (]: Began executing node test.dbt_playground.dbt_expectations_expect_column_to_exist_stg_events_visitor_id.8a7ec39171
[0m20:36:08.930921 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_playground.dbt_expectations_expect_column_to_exist_stg_events_visitor_id.8a7ec39171"
[0m20:36:08.931517 [debug] [Thread-1 (]: Using duckdb connection "test.dbt_playground.dbt_expectations_expect_column_to_exist_stg_events_visitor_id.8a7ec39171"
[0m20:36:08.931816 [debug] [Thread-1 (]: On test.dbt_playground.dbt_expectations_expect_column_to_exist_stg_events_visitor_id.8a7ec39171: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "dbt_playground", "target_name": "dev", "node_id": "test.dbt_playground.dbt_expectations_expect_column_to_exist_stg_events_visitor_id.8a7ec39171"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      

    with test_data as (

        select
            cast('VISITOR_ID' as TEXT) as column_name,
            2 as matching_column_index,
            True as column_index_matches

    )
    select *
    from test_data
    where
        not(matching_column_index >= 0 and column_index_matches)
      
    ) dbt_internal_test
[0m20:36:08.932668 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m20:36:08.934166 [debug] [Thread-1 (]: Timing info for test.dbt_playground.dbt_expectations_expect_column_to_exist_stg_events_visitor_id.8a7ec39171 (execute): 20:36:08.928294 => 20:36:08.933915
[0m20:36:08.934606 [debug] [Thread-1 (]: On test.dbt_playground.dbt_expectations_expect_column_to_exist_stg_events_visitor_id.8a7ec39171: Close
[0m20:36:08.935376 [info ] [Thread-1 (]: 8 of 26 PASS dbt_expectations_expect_column_to_exist_stg_events_visitor_id ..... [[32mPASS[0m in 0.32s]
[0m20:36:08.935818 [debug] [Thread-1 (]: Finished running node test.dbt_playground.dbt_expectations_expect_column_to_exist_stg_events_visitor_id.8a7ec39171
[0m20:36:08.936130 [debug] [Thread-1 (]: Began running node test.dbt_playground.not_null_stg_events_event_id.715b3f7012
[0m20:36:08.936416 [info ] [Thread-1 (]: 9 of 26 START test not_null_stg_events_event_id ................................ [RUN]
[0m20:36:08.936980 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_playground.dbt_expectations_expect_column_to_exist_stg_events_visitor_id.8a7ec39171, now test.dbt_playground.not_null_stg_events_event_id.715b3f7012)
[0m20:36:08.937330 [debug] [Thread-1 (]: Began compiling node test.dbt_playground.not_null_stg_events_event_id.715b3f7012
[0m20:36:08.942719 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_playground.not_null_stg_events_event_id.715b3f7012"
[0m20:36:08.943353 [debug] [Thread-1 (]: Timing info for test.dbt_playground.not_null_stg_events_event_id.715b3f7012 (compile): 20:36:08.937551 => 20:36:08.943239
[0m20:36:08.943607 [debug] [Thread-1 (]: Began executing node test.dbt_playground.not_null_stg_events_event_id.715b3f7012
[0m20:36:08.946562 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_playground.not_null_stg_events_event_id.715b3f7012"
[0m20:36:08.947113 [debug] [Thread-1 (]: Using duckdb connection "test.dbt_playground.not_null_stg_events_event_id.715b3f7012"
[0m20:36:08.947385 [debug] [Thread-1 (]: On test.dbt_playground.not_null_stg_events_event_id.715b3f7012: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "dbt_playground", "target_name": "dev", "node_id": "test.dbt_playground.not_null_stg_events_event_id.715b3f7012"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select event_id
from "my_db"."main"."stg_events"
where event_id is null



      
    ) dbt_internal_test
[0m20:36:08.947629 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:36:09.326168 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m20:36:09.422042 [debug] [Thread-1 (]: Timing info for test.dbt_playground.not_null_stg_events_event_id.715b3f7012 (execute): 20:36:08.943775 => 20:36:09.421615
[0m20:36:09.422940 [debug] [Thread-1 (]: On test.dbt_playground.not_null_stg_events_event_id.715b3f7012: Close
[0m20:36:09.424346 [info ] [Thread-1 (]: 9 of 26 PASS not_null_stg_events_event_id ...................................... [[32mPASS[0m in 0.49s]
[0m20:36:09.425262 [debug] [Thread-1 (]: Finished running node test.dbt_playground.not_null_stg_events_event_id.715b3f7012
[0m20:36:09.425898 [debug] [Thread-1 (]: Began running node test.dbt_playground.not_null_stg_events_session_id.e91b448cdc
[0m20:36:09.426578 [info ] [Thread-1 (]: 10 of 26 START test not_null_stg_events_session_id ............................. [RUN]
[0m20:36:09.427522 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_playground.not_null_stg_events_event_id.715b3f7012, now test.dbt_playground.not_null_stg_events_session_id.e91b448cdc)
[0m20:36:09.428026 [debug] [Thread-1 (]: Began compiling node test.dbt_playground.not_null_stg_events_session_id.e91b448cdc
[0m20:36:09.434765 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_playground.not_null_stg_events_session_id.e91b448cdc"
[0m20:36:09.435938 [debug] [Thread-1 (]: Timing info for test.dbt_playground.not_null_stg_events_session_id.e91b448cdc (compile): 20:36:09.428373 => 20:36:09.435736
[0m20:36:09.436493 [debug] [Thread-1 (]: Began executing node test.dbt_playground.not_null_stg_events_session_id.e91b448cdc
[0m20:36:09.440249 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_playground.not_null_stg_events_session_id.e91b448cdc"
[0m20:36:09.441404 [debug] [Thread-1 (]: Using duckdb connection "test.dbt_playground.not_null_stg_events_session_id.e91b448cdc"
[0m20:36:09.441821 [debug] [Thread-1 (]: On test.dbt_playground.not_null_stg_events_session_id.e91b448cdc: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "dbt_playground", "target_name": "dev", "node_id": "test.dbt_playground.not_null_stg_events_session_id.e91b448cdc"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select session_id
from "my_db"."main"."stg_events"
where session_id is null



      
    ) dbt_internal_test
[0m20:36:09.442180 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:36:09.805397 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m20:36:09.900980 [debug] [Thread-1 (]: Timing info for test.dbt_playground.not_null_stg_events_session_id.e91b448cdc (execute): 20:36:09.437075 => 20:36:09.900460
[0m20:36:09.901446 [debug] [Thread-1 (]: On test.dbt_playground.not_null_stg_events_session_id.e91b448cdc: Close
[0m20:36:09.902087 [info ] [Thread-1 (]: 10 of 26 PASS not_null_stg_events_session_id ................................... [[32mPASS[0m in 0.47s]
[0m20:36:09.902498 [debug] [Thread-1 (]: Finished running node test.dbt_playground.not_null_stg_events_session_id.e91b448cdc
[0m20:36:09.902787 [debug] [Thread-1 (]: Began running node test.dbt_playground.not_null_stg_events_visitor_id.7c0caa0efa
[0m20:36:09.903053 [info ] [Thread-1 (]: 11 of 26 START test not_null_stg_events_visitor_id ............................. [RUN]
[0m20:36:09.903553 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_playground.not_null_stg_events_session_id.e91b448cdc, now test.dbt_playground.not_null_stg_events_visitor_id.7c0caa0efa)
[0m20:36:09.903834 [debug] [Thread-1 (]: Began compiling node test.dbt_playground.not_null_stg_events_visitor_id.7c0caa0efa
[0m20:36:09.907296 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_playground.not_null_stg_events_visitor_id.7c0caa0efa"
[0m20:36:09.907911 [debug] [Thread-1 (]: Timing info for test.dbt_playground.not_null_stg_events_visitor_id.7c0caa0efa (compile): 20:36:09.904018 => 20:36:09.907788
[0m20:36:09.908159 [debug] [Thread-1 (]: Began executing node test.dbt_playground.not_null_stg_events_visitor_id.7c0caa0efa
[0m20:36:09.910043 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_playground.not_null_stg_events_visitor_id.7c0caa0efa"
[0m20:36:09.910543 [debug] [Thread-1 (]: Using duckdb connection "test.dbt_playground.not_null_stg_events_visitor_id.7c0caa0efa"
[0m20:36:09.910793 [debug] [Thread-1 (]: On test.dbt_playground.not_null_stg_events_visitor_id.7c0caa0efa: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "dbt_playground", "target_name": "dev", "node_id": "test.dbt_playground.not_null_stg_events_visitor_id.7c0caa0efa"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select visitor_id
from "my_db"."main"."stg_events"
where visitor_id is null



      
    ) dbt_internal_test
[0m20:36:09.911030 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:36:10.367185 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m20:36:10.464019 [debug] [Thread-1 (]: Timing info for test.dbt_playground.not_null_stg_events_visitor_id.7c0caa0efa (execute): 20:36:09.908340 => 20:36:10.463391
[0m20:36:10.465577 [debug] [Thread-1 (]: On test.dbt_playground.not_null_stg_events_visitor_id.7c0caa0efa: Close
[0m20:36:10.467764 [info ] [Thread-1 (]: 11 of 26 PASS not_null_stg_events_visitor_id ................................... [[32mPASS[0m in 0.56s]
[0m20:36:10.469005 [debug] [Thread-1 (]: Finished running node test.dbt_playground.not_null_stg_events_visitor_id.7c0caa0efa
[0m20:36:10.469739 [debug] [Thread-1 (]: Began running node test.dbt_playground.unique_stg_events_event_id.66ebb17438
[0m20:36:10.470549 [info ] [Thread-1 (]: 12 of 26 START test unique_stg_events_event_id ................................. [RUN]
[0m20:36:10.471765 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_playground.not_null_stg_events_visitor_id.7c0caa0efa, now test.dbt_playground.unique_stg_events_event_id.66ebb17438)
[0m20:36:10.472407 [debug] [Thread-1 (]: Began compiling node test.dbt_playground.unique_stg_events_event_id.66ebb17438
[0m20:36:10.485159 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_playground.unique_stg_events_event_id.66ebb17438"
[0m20:36:10.486284 [debug] [Thread-1 (]: Timing info for test.dbt_playground.unique_stg_events_event_id.66ebb17438 (compile): 20:36:10.472874 => 20:36:10.486041
[0m20:36:10.486666 [debug] [Thread-1 (]: Began executing node test.dbt_playground.unique_stg_events_event_id.66ebb17438
[0m20:36:10.489554 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_playground.unique_stg_events_event_id.66ebb17438"
[0m20:36:10.490251 [debug] [Thread-1 (]: Using duckdb connection "test.dbt_playground.unique_stg_events_event_id.66ebb17438"
[0m20:36:10.490618 [debug] [Thread-1 (]: On test.dbt_playground.unique_stg_events_event_id.66ebb17438: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "dbt_playground", "target_name": "dev", "node_id": "test.dbt_playground.unique_stg_events_event_id.66ebb17438"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    event_id as unique_field,
    count(*) as n_records

from "my_db"."main"."stg_events"
where event_id is not null
group by event_id
having count(*) > 1



      
    ) dbt_internal_test
[0m20:36:10.490961 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:36:10.875739 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m20:36:10.973512 [debug] [Thread-1 (]: Timing info for test.dbt_playground.unique_stg_events_event_id.66ebb17438 (execute): 20:36:10.486919 => 20:36:10.972918
[0m20:36:10.974435 [debug] [Thread-1 (]: On test.dbt_playground.unique_stg_events_event_id.66ebb17438: Close
[0m20:36:10.975954 [info ] [Thread-1 (]: 12 of 26 PASS unique_stg_events_event_id ....................................... [[32mPASS[0m in 0.50s]
[0m20:36:10.976885 [debug] [Thread-1 (]: Finished running node test.dbt_playground.unique_stg_events_event_id.66ebb17438
[0m20:36:10.977472 [debug] [Thread-1 (]: Began running node test.dbt_playground.dbt_expectations_expect_column_to_exist_stg_sessions_session_id.82f15e2a75
[0m20:36:10.978264 [info ] [Thread-1 (]: 13 of 26 START test dbt_expectations_expect_column_to_exist_stg_sessions_session_id  [RUN]
[0m20:36:10.979228 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_playground.unique_stg_events_event_id.66ebb17438, now test.dbt_playground.dbt_expectations_expect_column_to_exist_stg_sessions_session_id.82f15e2a75)
[0m20:36:10.979748 [debug] [Thread-1 (]: Began compiling node test.dbt_playground.dbt_expectations_expect_column_to_exist_stg_sessions_session_id.82f15e2a75
[0m20:36:10.988930 [debug] [Thread-1 (]: Using duckdb connection "test.dbt_playground.dbt_expectations_expect_column_to_exist_stg_sessions_session_id.82f15e2a75"
[0m20:36:10.989610 [debug] [Thread-1 (]: On test.dbt_playground.dbt_expectations_expect_column_to_exist_stg_sessions_session_id.82f15e2a75: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "dbt_playground", "target_name": "dev", "node_id": "test.dbt_playground.dbt_expectations_expect_column_to_exist_stg_sessions_session_id.82f15e2a75"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'stg_sessions'
      
      and table_schema = 'main'
      
      
      and table_catalog = 'my_db'
      
      order by ordinal_position

  
[0m20:36:10.990065 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:36:11.283648 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m20:36:11.285196 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_playground.dbt_expectations_expect_column_to_exist_stg_sessions_session_id.82f15e2a75"
[0m20:36:11.285983 [debug] [Thread-1 (]: Timing info for test.dbt_playground.dbt_expectations_expect_column_to_exist_stg_sessions_session_id.82f15e2a75 (compile): 20:36:10.980104 => 20:36:11.285784
[0m20:36:11.286400 [debug] [Thread-1 (]: Began executing node test.dbt_playground.dbt_expectations_expect_column_to_exist_stg_sessions_session_id.82f15e2a75
[0m20:36:11.289356 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_playground.dbt_expectations_expect_column_to_exist_stg_sessions_session_id.82f15e2a75"
[0m20:36:11.290033 [debug] [Thread-1 (]: Using duckdb connection "test.dbt_playground.dbt_expectations_expect_column_to_exist_stg_sessions_session_id.82f15e2a75"
[0m20:36:11.290328 [debug] [Thread-1 (]: On test.dbt_playground.dbt_expectations_expect_column_to_exist_stg_sessions_session_id.82f15e2a75: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "dbt_playground", "target_name": "dev", "node_id": "test.dbt_playground.dbt_expectations_expect_column_to_exist_stg_sessions_session_id.82f15e2a75"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      

    with test_data as (

        select
            cast('SESSION_ID' as TEXT) as column_name,
            0 as matching_column_index,
            True as column_index_matches

    )
    select *
    from test_data
    where
        not(matching_column_index >= 0 and column_index_matches)
      
    ) dbt_internal_test
[0m20:36:11.290944 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m20:36:11.291995 [debug] [Thread-1 (]: Timing info for test.dbt_playground.dbt_expectations_expect_column_to_exist_stg_sessions_session_id.82f15e2a75 (execute): 20:36:11.286680 => 20:36:11.291858
[0m20:36:11.292264 [debug] [Thread-1 (]: On test.dbt_playground.dbt_expectations_expect_column_to_exist_stg_sessions_session_id.82f15e2a75: Close
[0m20:36:11.292903 [info ] [Thread-1 (]: 13 of 26 PASS dbt_expectations_expect_column_to_exist_stg_sessions_session_id .. [[32mPASS[0m in 0.31s]
[0m20:36:11.293293 [debug] [Thread-1 (]: Finished running node test.dbt_playground.dbt_expectations_expect_column_to_exist_stg_sessions_session_id.82f15e2a75
[0m20:36:11.293573 [debug] [Thread-1 (]: Began running node test.dbt_playground.dbt_expectations_expect_column_to_exist_stg_sessions_visitor_id.cc2400948b
[0m20:36:11.293871 [info ] [Thread-1 (]: 14 of 26 START test dbt_expectations_expect_column_to_exist_stg_sessions_visitor_id  [RUN]
[0m20:36:11.294294 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_playground.dbt_expectations_expect_column_to_exist_stg_sessions_session_id.82f15e2a75, now test.dbt_playground.dbt_expectations_expect_column_to_exist_stg_sessions_visitor_id.cc2400948b)
[0m20:36:11.294538 [debug] [Thread-1 (]: Began compiling node test.dbt_playground.dbt_expectations_expect_column_to_exist_stg_sessions_visitor_id.cc2400948b
[0m20:36:11.301065 [debug] [Thread-1 (]: Using duckdb connection "test.dbt_playground.dbt_expectations_expect_column_to_exist_stg_sessions_visitor_id.cc2400948b"
[0m20:36:11.301498 [debug] [Thread-1 (]: On test.dbt_playground.dbt_expectations_expect_column_to_exist_stg_sessions_visitor_id.cc2400948b: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "dbt_playground", "target_name": "dev", "node_id": "test.dbt_playground.dbt_expectations_expect_column_to_exist_stg_sessions_visitor_id.cc2400948b"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'stg_sessions'
      
      and table_schema = 'main'
      
      
      and table_catalog = 'my_db'
      
      order by ordinal_position

  
[0m20:36:11.301814 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:36:11.594207 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m20:36:11.595875 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_playground.dbt_expectations_expect_column_to_exist_stg_sessions_visitor_id.cc2400948b"
[0m20:36:11.596504 [debug] [Thread-1 (]: Timing info for test.dbt_playground.dbt_expectations_expect_column_to_exist_stg_sessions_visitor_id.cc2400948b (compile): 20:36:11.294710 => 20:36:11.596375
[0m20:36:11.596778 [debug] [Thread-1 (]: Began executing node test.dbt_playground.dbt_expectations_expect_column_to_exist_stg_sessions_visitor_id.cc2400948b
[0m20:36:11.598978 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_playground.dbt_expectations_expect_column_to_exist_stg_sessions_visitor_id.cc2400948b"
[0m20:36:11.599432 [debug] [Thread-1 (]: Using duckdb connection "test.dbt_playground.dbt_expectations_expect_column_to_exist_stg_sessions_visitor_id.cc2400948b"
[0m20:36:11.599699 [debug] [Thread-1 (]: On test.dbt_playground.dbt_expectations_expect_column_to_exist_stg_sessions_visitor_id.cc2400948b: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "dbt_playground", "target_name": "dev", "node_id": "test.dbt_playground.dbt_expectations_expect_column_to_exist_stg_sessions_visitor_id.cc2400948b"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      

    with test_data as (

        select
            cast('VISITOR_ID' as TEXT) as column_name,
            1 as matching_column_index,
            True as column_index_matches

    )
    select *
    from test_data
    where
        not(matching_column_index >= 0 and column_index_matches)
      
    ) dbt_internal_test
[0m20:36:11.600375 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m20:36:11.601413 [debug] [Thread-1 (]: Timing info for test.dbt_playground.dbt_expectations_expect_column_to_exist_stg_sessions_visitor_id.cc2400948b (execute): 20:36:11.596959 => 20:36:11.601275
[0m20:36:11.601699 [debug] [Thread-1 (]: On test.dbt_playground.dbt_expectations_expect_column_to_exist_stg_sessions_visitor_id.cc2400948b: Close
[0m20:36:11.602342 [info ] [Thread-1 (]: 14 of 26 PASS dbt_expectations_expect_column_to_exist_stg_sessions_visitor_id .. [[32mPASS[0m in 0.31s]
[0m20:36:11.602719 [debug] [Thread-1 (]: Finished running node test.dbt_playground.dbt_expectations_expect_column_to_exist_stg_sessions_visitor_id.cc2400948b
[0m20:36:11.603005 [debug] [Thread-1 (]: Began running node test.dbt_playground.not_null_stg_sessions_session_id.2e872a126d
[0m20:36:11.603311 [info ] [Thread-1 (]: 15 of 26 START test not_null_stg_sessions_session_id ........................... [RUN]
[0m20:36:11.603741 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_playground.dbt_expectations_expect_column_to_exist_stg_sessions_visitor_id.cc2400948b, now test.dbt_playground.not_null_stg_sessions_session_id.2e872a126d)
[0m20:36:11.603992 [debug] [Thread-1 (]: Began compiling node test.dbt_playground.not_null_stg_sessions_session_id.2e872a126d
[0m20:36:11.606982 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_playground.not_null_stg_sessions_session_id.2e872a126d"
[0m20:36:11.607477 [debug] [Thread-1 (]: Timing info for test.dbt_playground.not_null_stg_sessions_session_id.2e872a126d (compile): 20:36:11.604170 => 20:36:11.607368
[0m20:36:11.607741 [debug] [Thread-1 (]: Began executing node test.dbt_playground.not_null_stg_sessions_session_id.2e872a126d
[0m20:36:11.609652 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_playground.not_null_stg_sessions_session_id.2e872a126d"
[0m20:36:11.610134 [debug] [Thread-1 (]: Using duckdb connection "test.dbt_playground.not_null_stg_sessions_session_id.2e872a126d"
[0m20:36:11.610378 [debug] [Thread-1 (]: On test.dbt_playground.not_null_stg_sessions_session_id.2e872a126d: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "dbt_playground", "target_name": "dev", "node_id": "test.dbt_playground.not_null_stg_sessions_session_id.2e872a126d"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select session_id
from "my_db"."main"."stg_sessions"
where session_id is null



      
    ) dbt_internal_test
[0m20:36:11.610612 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:36:11.968825 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m20:36:12.066592 [debug] [Thread-1 (]: Timing info for test.dbt_playground.not_null_stg_sessions_session_id.2e872a126d (execute): 20:36:11.607924 => 20:36:12.066140
[0m20:36:12.067458 [debug] [Thread-1 (]: On test.dbt_playground.not_null_stg_sessions_session_id.2e872a126d: Close
[0m20:36:12.068746 [info ] [Thread-1 (]: 15 of 26 PASS not_null_stg_sessions_session_id ................................. [[32mPASS[0m in 0.46s]
[0m20:36:12.069483 [debug] [Thread-1 (]: Finished running node test.dbt_playground.not_null_stg_sessions_session_id.2e872a126d
[0m20:36:12.070049 [debug] [Thread-1 (]: Began running node test.dbt_playground.not_null_stg_sessions_visitor_id.1fa5d38e94
[0m20:36:12.070713 [info ] [Thread-1 (]: 16 of 26 START test not_null_stg_sessions_visitor_id ........................... [RUN]
[0m20:36:12.071670 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_playground.not_null_stg_sessions_session_id.2e872a126d, now test.dbt_playground.not_null_stg_sessions_visitor_id.1fa5d38e94)
[0m20:36:12.072199 [debug] [Thread-1 (]: Began compiling node test.dbt_playground.not_null_stg_sessions_visitor_id.1fa5d38e94
[0m20:36:12.081053 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_playground.not_null_stg_sessions_visitor_id.1fa5d38e94"
[0m20:36:12.082273 [debug] [Thread-1 (]: Timing info for test.dbt_playground.not_null_stg_sessions_visitor_id.1fa5d38e94 (compile): 20:36:12.072552 => 20:36:12.082098
[0m20:36:12.082635 [debug] [Thread-1 (]: Began executing node test.dbt_playground.not_null_stg_sessions_visitor_id.1fa5d38e94
[0m20:36:12.085461 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_playground.not_null_stg_sessions_visitor_id.1fa5d38e94"
[0m20:36:12.086306 [debug] [Thread-1 (]: Using duckdb connection "test.dbt_playground.not_null_stg_sessions_visitor_id.1fa5d38e94"
[0m20:36:12.086664 [debug] [Thread-1 (]: On test.dbt_playground.not_null_stg_sessions_visitor_id.1fa5d38e94: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "dbt_playground", "target_name": "dev", "node_id": "test.dbt_playground.not_null_stg_sessions_visitor_id.1fa5d38e94"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select visitor_id
from "my_db"."main"."stg_sessions"
where visitor_id is null



      
    ) dbt_internal_test
[0m20:36:12.087017 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:36:12.457529 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m20:36:12.553717 [debug] [Thread-1 (]: Timing info for test.dbt_playground.not_null_stg_sessions_visitor_id.1fa5d38e94 (execute): 20:36:12.082889 => 20:36:12.552908
[0m20:36:12.554491 [debug] [Thread-1 (]: On test.dbt_playground.not_null_stg_sessions_visitor_id.1fa5d38e94: Close
[0m20:36:12.555761 [info ] [Thread-1 (]: 16 of 26 PASS not_null_stg_sessions_visitor_id ................................. [[32mPASS[0m in 0.48s]
[0m20:36:12.556539 [debug] [Thread-1 (]: Finished running node test.dbt_playground.not_null_stg_sessions_visitor_id.1fa5d38e94
[0m20:36:12.557114 [debug] [Thread-1 (]: Began running node test.dbt_playground.relationships_stg_events_session_id__session_id__ref_stg_sessions_.86082a5a59
[0m20:36:12.557708 [info ] [Thread-1 (]: 17 of 26 START test relationships_stg_events_session_id__session_id__ref_stg_sessions_  [RUN]
[0m20:36:12.558519 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_playground.not_null_stg_sessions_visitor_id.1fa5d38e94, now test.dbt_playground.relationships_stg_events_session_id__session_id__ref_stg_sessions_.86082a5a59)
[0m20:36:12.558971 [debug] [Thread-1 (]: Began compiling node test.dbt_playground.relationships_stg_events_session_id__session_id__ref_stg_sessions_.86082a5a59
[0m20:36:12.566286 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_playground.relationships_stg_events_session_id__session_id__ref_stg_sessions_.86082a5a59"
[0m20:36:12.567234 [debug] [Thread-1 (]: Timing info for test.dbt_playground.relationships_stg_events_session_id__session_id__ref_stg_sessions_.86082a5a59 (compile): 20:36:12.559273 => 20:36:12.567054
[0m20:36:12.567606 [debug] [Thread-1 (]: Began executing node test.dbt_playground.relationships_stg_events_session_id__session_id__ref_stg_sessions_.86082a5a59
[0m20:36:12.570560 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_playground.relationships_stg_events_session_id__session_id__ref_stg_sessions_.86082a5a59"
[0m20:36:12.571270 [debug] [Thread-1 (]: Using duckdb connection "test.dbt_playground.relationships_stg_events_session_id__session_id__ref_stg_sessions_.86082a5a59"
[0m20:36:12.571606 [debug] [Thread-1 (]: On test.dbt_playground.relationships_stg_events_session_id__session_id__ref_stg_sessions_.86082a5a59: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "dbt_playground", "target_name": "dev", "node_id": "test.dbt_playground.relationships_stg_events_session_id__session_id__ref_stg_sessions_.86082a5a59"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select session_id as from_field
    from "my_db"."main"."stg_events"
    where session_id is not null
),

parent as (
    select session_id as to_field
    from "my_db"."main"."stg_sessions"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m20:36:12.571928 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:36:12.941445 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m20:36:13.036935 [debug] [Thread-1 (]: Timing info for test.dbt_playground.relationships_stg_events_session_id__session_id__ref_stg_sessions_.86082a5a59 (execute): 20:36:12.567849 => 20:36:13.036490
[0m20:36:13.037826 [debug] [Thread-1 (]: On test.dbt_playground.relationships_stg_events_session_id__session_id__ref_stg_sessions_.86082a5a59: Close
[0m20:36:13.039070 [info ] [Thread-1 (]: 17 of 26 PASS relationships_stg_events_session_id__session_id__ref_stg_sessions_  [[32mPASS[0m in 0.48s]
[0m20:36:13.039825 [debug] [Thread-1 (]: Finished running node test.dbt_playground.relationships_stg_events_session_id__session_id__ref_stg_sessions_.86082a5a59
[0m20:36:13.040478 [debug] [Thread-1 (]: Began running node test.dbt_playground.relationships_stg_events_visitor_id__visitor_id__ref_stg_sessions_.fa4c4819a4
[0m20:36:13.041290 [info ] [Thread-1 (]: 18 of 26 START test relationships_stg_events_visitor_id__visitor_id__ref_stg_sessions_  [RUN]
[0m20:36:13.042389 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_playground.relationships_stg_events_session_id__session_id__ref_stg_sessions_.86082a5a59, now test.dbt_playground.relationships_stg_events_visitor_id__visitor_id__ref_stg_sessions_.fa4c4819a4)
[0m20:36:13.042912 [debug] [Thread-1 (]: Began compiling node test.dbt_playground.relationships_stg_events_visitor_id__visitor_id__ref_stg_sessions_.fa4c4819a4
[0m20:36:13.050761 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_playground.relationships_stg_events_visitor_id__visitor_id__ref_stg_sessions_.fa4c4819a4"
[0m20:36:13.051977 [debug] [Thread-1 (]: Timing info for test.dbt_playground.relationships_stg_events_visitor_id__visitor_id__ref_stg_sessions_.fa4c4819a4 (compile): 20:36:13.043251 => 20:36:13.051780
[0m20:36:13.052399 [debug] [Thread-1 (]: Began executing node test.dbt_playground.relationships_stg_events_visitor_id__visitor_id__ref_stg_sessions_.fa4c4819a4
[0m20:36:13.057376 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_playground.relationships_stg_events_visitor_id__visitor_id__ref_stg_sessions_.fa4c4819a4"
[0m20:36:13.058450 [debug] [Thread-1 (]: Using duckdb connection "test.dbt_playground.relationships_stg_events_visitor_id__visitor_id__ref_stg_sessions_.fa4c4819a4"
[0m20:36:13.058851 [debug] [Thread-1 (]: On test.dbt_playground.relationships_stg_events_visitor_id__visitor_id__ref_stg_sessions_.fa4c4819a4: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "dbt_playground", "target_name": "dev", "node_id": "test.dbt_playground.relationships_stg_events_visitor_id__visitor_id__ref_stg_sessions_.fa4c4819a4"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select visitor_id as from_field
    from "my_db"."main"."stg_events"
    where visitor_id is not null
),

parent as (
    select visitor_id as to_field
    from "my_db"."main"."stg_sessions"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m20:36:13.059216 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:36:13.449989 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m20:36:13.547071 [debug] [Thread-1 (]: Timing info for test.dbt_playground.relationships_stg_events_visitor_id__visitor_id__ref_stg_sessions_.fa4c4819a4 (execute): 20:36:13.052670 => 20:36:13.546601
[0m20:36:13.547961 [debug] [Thread-1 (]: On test.dbt_playground.relationships_stg_events_visitor_id__visitor_id__ref_stg_sessions_.fa4c4819a4: Close
[0m20:36:13.549376 [info ] [Thread-1 (]: 18 of 26 PASS relationships_stg_events_visitor_id__visitor_id__ref_stg_sessions_  [[32mPASS[0m in 0.51s]
[0m20:36:13.550281 [debug] [Thread-1 (]: Finished running node test.dbt_playground.relationships_stg_events_visitor_id__visitor_id__ref_stg_sessions_.fa4c4819a4
[0m20:36:13.550954 [debug] [Thread-1 (]: Began running node test.dbt_playground.unique_stg_sessions_session_id.ce45726d03
[0m20:36:13.551682 [info ] [Thread-1 (]: 19 of 26 START test unique_stg_sessions_session_id ............................. [RUN]
[0m20:36:13.552613 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_playground.relationships_stg_events_visitor_id__visitor_id__ref_stg_sessions_.fa4c4819a4, now test.dbt_playground.unique_stg_sessions_session_id.ce45726d03)
[0m20:36:13.553110 [debug] [Thread-1 (]: Began compiling node test.dbt_playground.unique_stg_sessions_session_id.ce45726d03
[0m20:36:13.559794 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_playground.unique_stg_sessions_session_id.ce45726d03"
[0m20:36:13.561046 [debug] [Thread-1 (]: Timing info for test.dbt_playground.unique_stg_sessions_session_id.ce45726d03 (compile): 20:36:13.553452 => 20:36:13.560835
[0m20:36:13.561486 [debug] [Thread-1 (]: Began executing node test.dbt_playground.unique_stg_sessions_session_id.ce45726d03
[0m20:36:13.564661 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_playground.unique_stg_sessions_session_id.ce45726d03"
[0m20:36:13.565580 [debug] [Thread-1 (]: Using duckdb connection "test.dbt_playground.unique_stg_sessions_session_id.ce45726d03"
[0m20:36:13.565957 [debug] [Thread-1 (]: On test.dbt_playground.unique_stg_sessions_session_id.ce45726d03: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "dbt_playground", "target_name": "dev", "node_id": "test.dbt_playground.unique_stg_sessions_session_id.ce45726d03"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    session_id as unique_field,
    count(*) as n_records

from "my_db"."main"."stg_sessions"
where session_id is not null
group by session_id
having count(*) > 1



      
    ) dbt_internal_test
[0m20:36:13.566307 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:36:13.933084 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m20:36:14.029015 [debug] [Thread-1 (]: Timing info for test.dbt_playground.unique_stg_sessions_session_id.ce45726d03 (execute): 20:36:13.561765 => 20:36:14.028215
[0m20:36:14.030959 [debug] [Thread-1 (]: On test.dbt_playground.unique_stg_sessions_session_id.ce45726d03: Close
[0m20:36:14.033059 [info ] [Thread-1 (]: 19 of 26 PASS unique_stg_sessions_session_id ................................... [[32mPASS[0m in 0.48s]
[0m20:36:14.034536 [debug] [Thread-1 (]: Finished running node test.dbt_playground.unique_stg_sessions_session_id.ce45726d03
[0m20:36:14.035365 [debug] [Thread-1 (]: Began running node model.dbt_playground.traffic_performance
[0m20:36:14.036470 [info ] [Thread-1 (]: 20 of 26 START sql table model main.traffic_performance ........................ [RUN]
[0m20:36:14.037941 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_playground.unique_stg_sessions_session_id.ce45726d03, now model.dbt_playground.traffic_performance)
[0m20:36:14.038682 [debug] [Thread-1 (]: Began compiling node model.dbt_playground.traffic_performance
[0m20:36:14.044822 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_playground.traffic_performance"
[0m20:36:14.046125 [debug] [Thread-1 (]: Timing info for model.dbt_playground.traffic_performance (compile): 20:36:14.039054 => 20:36:14.045923
[0m20:36:14.046553 [debug] [Thread-1 (]: Began executing node model.dbt_playground.traffic_performance
[0m20:36:14.067577 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_playground.traffic_performance"
[0m20:36:14.068382 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_playground.traffic_performance"
[0m20:36:14.068729 [debug] [Thread-1 (]: On model.dbt_playground.traffic_performance: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "dbt_playground", "target_name": "dev", "node_id": "model.dbt_playground.traffic_performance"} */

  
    
    

    create  table
      "my_db"."main"."traffic_performance__dbt_tmp"
  
    as (
      select timestamp__to_date::date as date,
       referrer_type as channel,
       source_medium,
       campaign_name as utm_campaign,
       campaign_content as utm_content,
       session_entry_url as landing_page,
       
    case when visitor_returning = 'Returning' then true else false end
 as is_returning,
       
    case 
        when location_country_name = 'United Stated' then location_country_name
        when location_country_name = 'Netherlands' then location_country_name
        when location_country_name = 'Ireland' then location_country_name
        when location_country_name = 'Canada' then location_country_name
        when location_country_name = 'Belgium' then location_country_name
        when location_country_name = 'China' then location_country_name
        else 'Other'
    end
 as country,
       operating_system,
       device_type,
       events::int as events,
       visitors::int as users,
       sessions::int as sessions,
       page_views::int as page_views,
       ecommerce_conversions::int as purchases,
       cart_additions::int as add_to_cart,
       ecommerce_abandoned_carts::int as abandoned_carts,
       case when consents_none = 0 then false else true end as is_full_consent,
       current_timestamp as date_transformed
from "my_db"."main"."stg_analytics"
    );
  
  
[0m20:36:14.069045 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:36:14.642936 [debug] [Thread-1 (]: SQL status: OK in 1.0 seconds
[0m20:36:14.650789 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_playground.traffic_performance"
[0m20:36:14.651490 [debug] [Thread-1 (]: On model.dbt_playground.traffic_performance: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "dbt_playground", "target_name": "dev", "node_id": "model.dbt_playground.traffic_performance"} */
alter table "my_db"."main"."traffic_performance__dbt_tmp" rename to "traffic_performance"
[0m20:36:14.923605 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m20:36:14.935757 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_playground.traffic_performance"
[0m20:36:14.936328 [debug] [Thread-1 (]: On model.dbt_playground.traffic_performance: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "dbt_playground", "target_name": "dev", "node_id": "model.dbt_playground.traffic_performance"} */
drop table if exists "my_db"."main"."traffic_performance__dbt_backup" cascade
[0m20:36:15.116764 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m20:36:15.118822 [debug] [Thread-1 (]: Timing info for model.dbt_playground.traffic_performance (execute): 20:36:14.046835 => 20:36:15.118638
[0m20:36:15.119283 [debug] [Thread-1 (]: On model.dbt_playground.traffic_performance: Close
[0m20:36:15.120133 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fe466ef1-8c3b-4471-a759-e6bb97e564d9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1058521a0>]}
[0m20:36:15.120804 [info ] [Thread-1 (]: 20 of 26 OK created sql table model main.traffic_performance ................... [[32mOK[0m in 1.08s]
[0m20:36:15.121353 [debug] [Thread-1 (]: Finished running node model.dbt_playground.traffic_performance
[0m20:36:15.121771 [debug] [Thread-1 (]: Began running node model.dbt_playground.int_events
[0m20:36:15.122480 [info ] [Thread-1 (]: 21 of 26 START sql view model main.int_events .................................. [RUN]
[0m20:36:15.123289 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_playground.traffic_performance, now model.dbt_playground.int_events)
[0m20:36:15.123646 [debug] [Thread-1 (]: Began compiling node model.dbt_playground.int_events
[0m20:36:15.126728 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_playground.int_events"
[0m20:36:15.127536 [debug] [Thread-1 (]: Timing info for model.dbt_playground.int_events (compile): 20:36:15.123880 => 20:36:15.127386
[0m20:36:15.127843 [debug] [Thread-1 (]: Began executing node model.dbt_playground.int_events
[0m20:36:15.131309 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_playground.int_events"
[0m20:36:15.131925 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_playground.int_events"
[0m20:36:15.132223 [debug] [Thread-1 (]: On model.dbt_playground.int_events: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "dbt_playground", "target_name": "dev", "node_id": "model.dbt_playground.int_events"} */

  
  create view "my_db"."main"."int_events__dbt_tmp" as (
    select session_id::int as session_id,
       event_id::int as event_id,
       visitor_id,
       timestamp::timestamp as timestamp,
       event_index::int as event_index,
       page_view_index::int as page_view_index,
       custom_event_category,
       custom_event_action,
       custom_event_name,
       event_url,
       source_medium,
       campaign_name as utm_campaign,
       goal_id::int as goal_id,
       current_timestamp as date_transformed
from "my_db"."main"."stg_events"
  );

[0m20:36:15.132496 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:36:15.675552 [debug] [Thread-1 (]: SQL status: OK in 1.0 seconds
[0m20:36:15.686964 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_playground.int_events"
[0m20:36:15.687493 [debug] [Thread-1 (]: On model.dbt_playground.int_events: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "dbt_playground", "target_name": "dev", "node_id": "model.dbt_playground.int_events"} */
alter view "my_db"."main"."int_events__dbt_tmp" rename to "int_events"
[0m20:36:15.957641 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m20:36:16.000392 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_playground.int_events"
[0m20:36:16.000801 [debug] [Thread-1 (]: On model.dbt_playground.int_events: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "dbt_playground", "target_name": "dev", "node_id": "model.dbt_playground.int_events"} */
drop view if exists "my_db"."main"."int_events__dbt_backup" cascade
[0m20:36:16.179157 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m20:36:16.181706 [debug] [Thread-1 (]: Timing info for model.dbt_playground.int_events (execute): 20:36:15.128048 => 20:36:16.181409
[0m20:36:16.182333 [debug] [Thread-1 (]: On model.dbt_playground.int_events: Close
[0m20:36:16.183502 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fe466ef1-8c3b-4471-a759-e6bb97e564d9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105766b90>]}
[0m20:36:16.184302 [info ] [Thread-1 (]: 21 of 26 OK created sql view model main.int_events ............................. [[32mOK[0m in 1.06s]
[0m20:36:16.185007 [debug] [Thread-1 (]: Finished running node model.dbt_playground.int_events
[0m20:36:16.185532 [debug] [Thread-1 (]: Began running node model.dbt_playground.int_sessions
[0m20:36:16.186199 [info ] [Thread-1 (]: 22 of 26 START sql view model main.int_sessions ................................ [RUN]
[0m20:36:16.187053 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_playground.int_events, now model.dbt_playground.int_sessions)
[0m20:36:16.187518 [debug] [Thread-1 (]: Began compiling node model.dbt_playground.int_sessions
[0m20:36:16.192251 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_playground.int_sessions"
[0m20:36:16.193486 [debug] [Thread-1 (]: Timing info for model.dbt_playground.int_sessions (compile): 20:36:16.187844 => 20:36:16.193292
[0m20:36:16.193899 [debug] [Thread-1 (]: Began executing node model.dbt_playground.int_sessions
[0m20:36:16.198131 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_playground.int_sessions"
[0m20:36:16.198880 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_playground.int_sessions"
[0m20:36:16.199267 [debug] [Thread-1 (]: On model.dbt_playground.int_sessions: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "dbt_playground", "target_name": "dev", "node_id": "model.dbt_playground.int_sessions"} */

  
  create view "my_db"."main"."int_sessions__dbt_tmp" as (
    select session_id::int as session_id,
       visitor_id,
       timestamp::timestamp as timestamp,
       visitor_session_number::int as visitor_session_number,
       
    case when visitor_returning = 'Returning' then true else false end
 as is_returning,
       
    case 
        when location_country_name = 'United Stated' then location_country_name
        when location_country_name = 'Netherlands' then location_country_name
        when location_country_name = 'Ireland' then location_country_name
        when location_country_name = 'Canada' then location_country_name
        when location_country_name = 'Belgium' then location_country_name
        when location_country_name = 'China' then location_country_name
        else 'Other'
    end
 as country,
       source_medium,
       campaign_name as utm_campaign,
       session_total_page_views::int as session_total_page_views,
       session_total_events::int as session_total_events,
       visitor_days_since_last_session::int as visitor_days_since_last_session,
       visitor_days_since_first_session::int as visitor_days_since_first_session,
       current_timestamp as date_transformed
from "my_db"."main"."stg_sessions"
  );

[0m20:36:16.199648 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:36:16.748642 [debug] [Thread-1 (]: SQL status: OK in 1.0 seconds
[0m20:36:16.753438 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_playground.int_sessions"
[0m20:36:16.753901 [debug] [Thread-1 (]: On model.dbt_playground.int_sessions: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "dbt_playground", "target_name": "dev", "node_id": "model.dbt_playground.int_sessions"} */
alter view "my_db"."main"."int_sessions__dbt_tmp" rename to "int_sessions"
[0m20:36:17.022655 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m20:36:17.033647 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_playground.int_sessions"
[0m20:36:17.034103 [debug] [Thread-1 (]: On model.dbt_playground.int_sessions: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "dbt_playground", "target_name": "dev", "node_id": "model.dbt_playground.int_sessions"} */
drop view if exists "my_db"."main"."int_sessions__dbt_backup" cascade
[0m20:36:17.211558 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m20:36:17.216154 [debug] [Thread-1 (]: Timing info for model.dbt_playground.int_sessions (execute): 20:36:16.194177 => 20:36:17.215852
[0m20:36:17.216762 [debug] [Thread-1 (]: On model.dbt_playground.int_sessions: Close
[0m20:36:17.217862 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fe466ef1-8c3b-4471-a759-e6bb97e564d9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1053b3e20>]}
[0m20:36:17.218706 [info ] [Thread-1 (]: 22 of 26 OK created sql view model main.int_sessions ........................... [[32mOK[0m in 1.03s]
[0m20:36:17.219436 [debug] [Thread-1 (]: Finished running node model.dbt_playground.int_sessions
[0m20:36:17.220580 [debug] [Thread-1 (]: Began running node model.dbt_playground.attribution
[0m20:36:17.221119 [info ] [Thread-1 (]: 23 of 26 START sql table model main.attribution ................................ [RUN]
[0m20:36:17.221923 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_playground.int_sessions, now model.dbt_playground.attribution)
[0m20:36:17.222362 [debug] [Thread-1 (]: Began compiling node model.dbt_playground.attribution
[0m20:36:17.228669 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_playground.attribution"
[0m20:36:17.229929 [debug] [Thread-1 (]: Timing info for model.dbt_playground.attribution (compile): 20:36:17.222624 => 20:36:17.229725
[0m20:36:17.230330 [debug] [Thread-1 (]: Began executing node model.dbt_playground.attribution
[0m20:36:17.234316 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_playground.attribution"
[0m20:36:17.235046 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_playground.attribution"
[0m20:36:17.235430 [debug] [Thread-1 (]: On model.dbt_playground.attribution: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "dbt_playground", "target_name": "dev", "node_id": "model.dbt_playground.attribution"} */

  
    
    

    create  table
      "my_db"."main"."attribution__dbt_tmp"
  
    as (
      select md5(cast(coalesce(cast(sessions.visitor_id as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(sessions.session_id as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(events.event_id as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(events.timestamp as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as s_id,
       sessions.visitor_id,
       sessions.session_id,
       sessions.visitor_session_number,
       case when sessions.visitor_session_number = 1 then true else false end as is_first_session,
       events.event_id,
       events.page_view_index,
       events.timestamp,
       events.event_url,
       sessions.is_returning,
       sessions.country,
       sessions.source_medium,
       sessions.utm_campaign,
       sessions.session_total_page_views,
       sessions.session_total_events,
       current_timestamp as date_transformed
from "my_db"."main"."int_sessions" as sessions
left join "my_db"."main"."int_events" as events
on sessions.session_id = events.session_id
    );
  
  
[0m20:36:17.235813 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:36:17.709329 [debug] [Thread-1 (]: Timing info for model.dbt_playground.attribution (execute): 20:36:17.230582 => 20:36:17.708796
[0m20:36:17.710178 [debug] [Thread-1 (]: On model.dbt_playground.attribution: Close
[0m20:36:17.716142 [debug] [Thread-1 (]: Runtime Error in model attribution (models/marts/attribution.sql)
  Conversion Error: Type INT64 with value 5343858099125739517 can't be cast because the value is out of range for the destination type INT32
[0m20:36:17.716763 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fe466ef1-8c3b-4471-a759-e6bb97e564d9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105a3e680>]}
[0m20:36:17.717529 [error] [Thread-1 (]: 23 of 26 ERROR creating sql table model main.attribution ....................... [[31mERROR[0m in 0.50s]
[0m20:36:17.718194 [debug] [Thread-1 (]: Finished running node model.dbt_playground.attribution
[0m20:36:17.718680 [debug] [Thread-1 (]: Began running node model.dbt_playground.int_touchpoints
[0m20:36:17.719284 [info ] [Thread-1 (]: 24 of 26 START sql view model main.int_touchpoints ............................. [RUN]
[0m20:36:17.720024 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_playground.attribution, now model.dbt_playground.int_touchpoints)
[0m20:36:17.720416 [debug] [Thread-1 (]: Began compiling node model.dbt_playground.int_touchpoints
[0m20:36:17.724791 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_playground.int_touchpoints"
[0m20:36:17.725683 [debug] [Thread-1 (]: Timing info for model.dbt_playground.int_touchpoints (compile): 20:36:17.720683 => 20:36:17.725518
[0m20:36:17.726022 [debug] [Thread-1 (]: Began executing node model.dbt_playground.int_touchpoints
[0m20:36:17.730201 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_playground.int_touchpoints"
[0m20:36:17.730846 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_playground.int_touchpoints"
[0m20:36:17.731185 [debug] [Thread-1 (]: On model.dbt_playground.int_touchpoints: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "dbt_playground", "target_name": "dev", "node_id": "model.dbt_playground.int_touchpoints"} */

  
  create view "my_db"."main"."int_touchpoints__dbt_tmp" as (
    select distinct sessions.visitor_id,
       -- first
       FIRST_VALUE(sessions.source_medium) OVER (PARTITION BY sessions.visitor_id ORDER BY sessions.timestamp) AS first_source_medium,
       FIRST_VALUE(sessions.utm_campaign) OVER (PARTITION BY sessions.visitor_id ORDER BY sessions.timestamp) AS first_utm_campaign,
       FIRST_VALUE(events.event_url) OVER (PARTITION BY sessions.visitor_id ORDER BY sessions.timestamp) AS first_event_url,
       -- last
       LAST_VALUE(sessions.source_medium) OVER (PARTITION BY sessions.visitor_id ORDER BY sessions.timestamp desc) AS last_source_medium,
       LAST_VALUE(sessions.utm_campaign) OVER (PARTITION BY sessions.visitor_id ORDER BY sessions.timestamp desc) AS last_utm_campaign,
       LAST_VALUE(events.event_url) OVER (PARTITION BY sessions.visitor_id ORDER BY events.timestamp desc) AS last_event_url
from "my_db"."main"."int_sessions" as sessions
left join "my_db"."main"."int_events" as events
    on sessions.session_id = events.session_id
  );

[0m20:36:17.731516 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:36:18.279755 [debug] [Thread-1 (]: SQL status: OK in 1.0 seconds
[0m20:36:18.290259 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_playground.int_touchpoints"
[0m20:36:18.290960 [debug] [Thread-1 (]: On model.dbt_playground.int_touchpoints: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "dbt_playground", "target_name": "dev", "node_id": "model.dbt_playground.int_touchpoints"} */
alter view "my_db"."main"."int_touchpoints__dbt_tmp" rename to "int_touchpoints"
[0m20:36:18.565994 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m20:36:18.572804 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_playground.int_touchpoints"
[0m20:36:18.573321 [debug] [Thread-1 (]: On model.dbt_playground.int_touchpoints: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "dbt_playground", "target_name": "dev", "node_id": "model.dbt_playground.int_touchpoints"} */
drop view if exists "my_db"."main"."int_touchpoints__dbt_backup" cascade
[0m20:36:18.755220 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m20:36:18.761261 [debug] [Thread-1 (]: Timing info for model.dbt_playground.int_touchpoints (execute): 20:36:17.726256 => 20:36:18.760906
[0m20:36:18.762100 [debug] [Thread-1 (]: On model.dbt_playground.int_touchpoints: Close
[0m20:36:18.763489 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fe466ef1-8c3b-4471-a759-e6bb97e564d9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1054af850>]}
[0m20:36:18.764500 [info ] [Thread-1 (]: 24 of 26 OK created sql view model main.int_touchpoints ........................ [[32mOK[0m in 1.04s]
[0m20:36:18.765246 [debug] [Thread-1 (]: Finished running node model.dbt_playground.int_touchpoints
[0m20:36:18.766341 [debug] [Thread-1 (]: Began running node model.dbt_playground.visitors
[0m20:36:18.767019 [info ] [Thread-1 (]: 25 of 26 START sql table model main.visitors ................................... [RUN]
[0m20:36:18.767846 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_playground.int_touchpoints, now model.dbt_playground.visitors)
[0m20:36:18.768318 [debug] [Thread-1 (]: Began compiling node model.dbt_playground.visitors
[0m20:36:18.773529 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_playground.visitors"
[0m20:36:18.774674 [debug] [Thread-1 (]: Timing info for model.dbt_playground.visitors (compile): 20:36:18.768632 => 20:36:18.774489
[0m20:36:18.775091 [debug] [Thread-1 (]: Began executing node model.dbt_playground.visitors
[0m20:36:18.779619 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_playground.visitors"
[0m20:36:18.780364 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_playground.visitors"
[0m20:36:18.780766 [debug] [Thread-1 (]: On model.dbt_playground.visitors: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "dbt_playground", "target_name": "dev", "node_id": "model.dbt_playground.visitors"} */

  
    
    

    create  table
      "my_db"."main"."visitors__dbt_tmp"
  
    as (
      select distinct sessions.visitor_id,
       sessions.country,
       -- first
       touchpoints.first_source_medium,
       touchpoints.first_utm_campaign,
       touchpoints.first_event_url,
       -- last
       touchpoints.last_source_medium,
       touchpoints.last_utm_campaign,
       touchpoints.last_event_url,
       -- arrays
       ARRAY_AGG(sessions.utm_campaign) WITHIN GROUP (ORDER BY sessions.timestamp ASC) as all_source_mediums,
       ARRAY_AGG(sessions.source_medium) WITHIN GROUP (ORDER BY sessions.timestamp ASC) as all_campaigns,
       ARRAY_AGG(events.event_url) WITHIN GROUP (ORDER BY events.timestamp ASC) as all_event_urls,
       -- metrics
       count (distinct sessions.session_id) as total_sessions,
       sum(sessions.session_total_page_views) as session_total_page_views,
       sum(sessions.session_total_events) as session_total_events,
       sessions.visitor_days_since_last_session,
       sessions.visitor_days_since_first_session,
       current_timestamp as date_transformed
from "my_db"."main"."int_sessions" as sessions
left join "my_db"."main"."int_events" as events
    on sessions.session_id = events.session_id
left join "my_db"."main"."int_touchpoints" as touchpoints
    on sessions.visitor_id = touchpoints.visitor_id
group by all
    );
  
  
[0m20:36:18.781157 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:36:19.056468 [debug] [Thread-1 (]: Timing info for model.dbt_playground.visitors (execute): 20:36:18.775392 => 20:36:19.055387
[0m20:36:19.057878 [debug] [Thread-1 (]: On model.dbt_playground.visitors: Close
[0m20:36:19.060348 [debug] [Thread-1 (]: Runtime Error in model visitors (models/marts/visitors.sql)
  Parser Error: Unknown ordered aggregate "ARRAY_AGG".
[0m20:36:19.061138 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fe466ef1-8c3b-4471-a759-e6bb97e564d9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105a11780>]}
[0m20:36:19.062126 [error] [Thread-1 (]: 25 of 26 ERROR creating sql table model main.visitors .......................... [[31mERROR[0m in 0.29s]
[0m20:36:19.063013 [debug] [Thread-1 (]: Finished running node model.dbt_playground.visitors
[0m20:36:19.064132 [debug] [Thread-1 (]: Began running node snapshot.dbt_playground.visitors_snapshot
[0m20:36:19.064789 [info ] [Thread-1 (]: 26 of 26 SKIP relation dbt.visitors_snapshot ................................... [[33mSKIP[0m]
[0m20:36:19.065323 [debug] [Thread-1 (]: Finished running node snapshot.dbt_playground.visitors_snapshot
[0m20:36:19.067008 [debug] [MainThread]: Using duckdb connection "master"
[0m20:36:19.067431 [debug] [MainThread]: On master: BEGIN
[0m20:36:19.067796 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m20:36:19.341283 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m20:36:19.343234 [debug] [MainThread]: On master: COMMIT
[0m20:36:19.343751 [debug] [MainThread]: Using duckdb connection "master"
[0m20:36:19.344265 [debug] [MainThread]: On master: COMMIT
[0m20:36:19.345273 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m20:36:19.345969 [debug] [MainThread]: On master: Close
[0m20:36:19.347134 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:36:19.347621 [debug] [MainThread]: Connection 'model.dbt_playground.visitors' was properly closed.
[0m20:36:19.348321 [info ] [MainThread]: 
[0m20:36:19.348884 [info ] [MainThread]: Finished running 6 view models, 16 tests, 3 table models, 1 snapshot in 0 hours 0 minutes and 20.18 seconds (20.18s).
[0m20:36:19.353344 [debug] [MainThread]: Command end result
[0m20:36:19.370374 [info ] [MainThread]: 
[0m20:36:19.370767 [info ] [MainThread]: [31mCompleted with 2 errors and 0 warnings:[0m
[0m20:36:19.371102 [info ] [MainThread]: 
[0m20:36:19.371416 [error] [MainThread]:   Runtime Error in model attribution (models/marts/attribution.sql)
  Conversion Error: Type INT64 with value 5343858099125739517 can't be cast because the value is out of range for the destination type INT32
[0m20:36:19.371681 [info ] [MainThread]: 
[0m20:36:19.371927 [error] [MainThread]:   Runtime Error in model visitors (models/marts/visitors.sql)
  Parser Error: Unknown ordered aggregate "ARRAY_AGG".
[0m20:36:19.372197 [info ] [MainThread]: 
[0m20:36:19.372456 [info ] [MainThread]: Done. PASS=23 WARN=0 ERROR=2 SKIP=1 TOTAL=26
[0m20:36:19.372969 [debug] [MainThread]: Command `dbt build` failed at 20:36:19.372893 after 21.54 seconds
[0m20:36:19.373302 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10317b130>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1050297e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10578ef80>]}
[0m20:36:19.373628 [debug] [MainThread]: Flushing usage events
[0m20:38:43.817873 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1054e9390>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1074b22c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1074b3130>]}


============================== 20:38:43.821274 | 97992441-2a70-45c6-aaae-d652b8fdf13f ==============================
[0m20:38:43.821274 [info ] [MainThread]: Running with dbt=1.6.6
[0m20:38:43.821672 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/Users/alejandroaboy/Desktop/dbt_duckdb_piwik', 'log_path': '/Users/alejandroaboy/Desktop/dbt_duckdb_piwik/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt build', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m20:38:43.948243 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '97992441-2a70-45c6-aaae-d652b8fdf13f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102d6ffd0>]}
[0m20:38:43.959046 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '97992441-2a70-45c6-aaae-d652b8fdf13f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107749900>]}
[0m20:38:43.959591 [info ] [MainThread]: Registered adapter: duckdb=1.6.1
[0m20:38:43.981935 [debug] [MainThread]: checksum: 546b81fb56652c304d87abd676e84d4737d8a0c6b62160f4a6e79dcddbc842bb, vars: {}, profile: , target: , version: 1.6.6
[0m20:38:44.039463 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 3 files changed.
[0m20:38:44.040051 [debug] [MainThread]: Partial parsing: updated file: dbt_playground://models/marts/visitors.sql
[0m20:38:44.040350 [debug] [MainThread]: Partial parsing: updated file: dbt_playground://models/intermediate/int_events.sql
[0m20:38:44.040620 [debug] [MainThread]: Partial parsing: updated file: dbt_playground://models/intermediate/int_sessions.sql
[0m20:38:44.080610 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- seeds
[0m20:38:44.084761 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '97992441-2a70-45c6-aaae-d652b8fdf13f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107e8c0d0>]}
[0m20:38:44.098227 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '97992441-2a70-45c6-aaae-d652b8fdf13f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107b88fa0>]}
[0m20:38:44.098623 [info ] [MainThread]: Found 9 models, 1 snapshot, 16 tests, 3 sources, 0 exposures, 0 metrics, 716 macros, 0 groups, 0 semantic models
[0m20:38:44.100466 [info ] [MainThread]: 
[0m20:38:44.100983 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m20:38:44.101927 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_analytics'
[0m20:38:44.110467 [debug] [ThreadPool]: Using duckdb connection "list_analytics"
[0m20:38:44.110876 [debug] [ThreadPool]: On list_analytics: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "dbt_playground", "target_name": "dev", "connection_name": "list_analytics"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"analytics"'
    
  
  
[0m20:38:44.111107 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:38:46.584450 [debug] [ThreadPool]: SQL status: OK in 2.0 seconds
[0m20:38:46.587088 [debug] [ThreadPool]: On list_analytics: Close
[0m20:38:46.587875 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_analytics, now list_my_db)
[0m20:38:46.590064 [debug] [ThreadPool]: Using duckdb connection "list_my_db"
[0m20:38:46.590425 [debug] [ThreadPool]: On list_my_db: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "dbt_playground", "target_name": "dev", "connection_name": "list_my_db"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"my_db"'
    
  
  
[0m20:38:46.590655 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:38:46.873735 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m20:38:46.875040 [debug] [ThreadPool]: On list_my_db: Close
[0m20:38:46.876005 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_my_db, now create_my_db_main)
[0m20:38:46.876545 [debug] [ThreadPool]: Creating schema "database: "my_db"
schema: "main"
"
[0m20:38:46.880573 [debug] [ThreadPool]: Using duckdb connection "create_my_db_main"
[0m20:38:46.880841 [debug] [ThreadPool]: On create_my_db_main: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "dbt_playground", "target_name": "dev", "connection_name": "create_my_db_main"} */
create schema if not exists "my_db"."main"
[0m20:38:46.881047 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:38:47.357172 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m20:38:47.360534 [debug] [ThreadPool]: On create_my_db_main: Close
[0m20:38:47.362730 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_my_db_main, now create_analytics_dbt)
[0m20:38:47.364204 [debug] [ThreadPool]: Creating schema "database: "analytics"
schema: "dbt"
"
[0m20:38:47.368248 [debug] [ThreadPool]: Using duckdb connection "create_analytics_dbt"
[0m20:38:47.368753 [debug] [ThreadPool]: On create_analytics_dbt: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "dbt_playground", "target_name": "dev", "connection_name": "create_analytics_dbt"} */
create schema if not exists "analytics"."dbt"
[0m20:38:47.369170 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:38:47.838379 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m20:38:47.839383 [debug] [ThreadPool]: On create_analytics_dbt: Close
[0m20:38:47.841032 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_analytics_dbt, now list_my_db_main)
[0m20:38:47.845645 [debug] [ThreadPool]: Using duckdb connection "list_my_db_main"
[0m20:38:47.845994 [debug] [ThreadPool]: On list_my_db_main: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "dbt_playground", "target_name": "dev", "connection_name": "list_my_db_main"} */
select
      'my_db' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'main'
    and table_catalog = 'my_db'
  
[0m20:38:47.846222 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:38:48.156416 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m20:38:48.158694 [debug] [ThreadPool]: On list_my_db_main: Close
[0m20:38:48.159471 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_my_db_main, now list_analytics_dbt)
[0m20:38:48.162828 [debug] [ThreadPool]: Using duckdb connection "list_analytics_dbt"
[0m20:38:48.163173 [debug] [ThreadPool]: On list_analytics_dbt: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "dbt_playground", "target_name": "dev", "connection_name": "list_analytics_dbt"} */
select
      'analytics' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'dbt'
    and table_catalog = 'analytics'
  
[0m20:38:48.163403 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:38:48.456798 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m20:38:48.459731 [debug] [ThreadPool]: On list_analytics_dbt: Close
[0m20:38:48.461072 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '97992441-2a70-45c6-aaae-d652b8fdf13f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107ed8dc0>]}
[0m20:38:48.461704 [debug] [MainThread]: Using duckdb connection "master"
[0m20:38:48.462012 [debug] [MainThread]: On master: BEGIN
[0m20:38:48.462293 [debug] [MainThread]: Opening a new connection, currently in state init
[0m20:38:48.745179 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m20:38:48.745617 [debug] [MainThread]: On master: COMMIT
[0m20:38:48.745856 [debug] [MainThread]: Using duckdb connection "master"
[0m20:38:48.746061 [debug] [MainThread]: On master: COMMIT
[0m20:38:48.746299 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m20:38:48.746505 [debug] [MainThread]: On master: Close
[0m20:38:48.746995 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m20:38:48.747225 [info ] [MainThread]: 
[0m20:38:48.749979 [debug] [Thread-1 (]: Began running node model.dbt_playground.stg_analytics
[0m20:38:48.750395 [info ] [Thread-1 (]: 1 of 26 START sql view model main.stg_analytics ................................ [RUN]
[0m20:38:48.750870 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_analytics_dbt, now model.dbt_playground.stg_analytics)
[0m20:38:48.751119 [debug] [Thread-1 (]: Began compiling node model.dbt_playground.stg_analytics
[0m20:38:48.757118 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_playground.stg_analytics"
[0m20:38:48.757955 [debug] [Thread-1 (]: Timing info for model.dbt_playground.stg_analytics (compile): 20:38:48.751299 => 20:38:48.757712
[0m20:38:48.758333 [debug] [Thread-1 (]: Began executing node model.dbt_playground.stg_analytics
[0m20:38:48.781459 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_playground.stg_analytics"
[0m20:38:48.782174 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_playground.stg_analytics"
[0m20:38:48.782444 [debug] [Thread-1 (]: On model.dbt_playground.stg_analytics: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "dbt_playground", "target_name": "dev", "node_id": "model.dbt_playground.stg_analytics"} */

  
  create view "my_db"."main"."stg_analytics__dbt_tmp" as (
    select *
from "raw"."piwik"."analytics"
  );

[0m20:38:48.782706 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:38:49.362045 [debug] [Thread-1 (]: SQL status: OK in 1.0 seconds
[0m20:38:49.373348 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_playground.stg_analytics"
[0m20:38:49.373966 [debug] [Thread-1 (]: On model.dbt_playground.stg_analytics: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "dbt_playground", "target_name": "dev", "node_id": "model.dbt_playground.stg_analytics"} */
alter view "my_db"."main"."stg_analytics" rename to "stg_analytics__dbt_backup"
[0m20:38:49.665216 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m20:38:49.677145 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_playground.stg_analytics"
[0m20:38:49.677804 [debug] [Thread-1 (]: On model.dbt_playground.stg_analytics: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "dbt_playground", "target_name": "dev", "node_id": "model.dbt_playground.stg_analytics"} */
alter view "my_db"."main"."stg_analytics__dbt_tmp" rename to "stg_analytics"
[0m20:38:49.961452 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m20:38:49.990797 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_playground.stg_analytics"
[0m20:38:49.991302 [debug] [Thread-1 (]: On model.dbt_playground.stg_analytics: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "dbt_playground", "target_name": "dev", "node_id": "model.dbt_playground.stg_analytics"} */
drop view if exists "my_db"."main"."stg_analytics__dbt_backup" cascade
[0m20:38:50.279474 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m20:38:50.283641 [debug] [Thread-1 (]: Timing info for model.dbt_playground.stg_analytics (execute): 20:38:48.758529 => 20:38:50.283306
[0m20:38:50.284418 [debug] [Thread-1 (]: On model.dbt_playground.stg_analytics: Close
[0m20:38:50.285691 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '97992441-2a70-45c6-aaae-d652b8fdf13f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107ed8d00>]}
[0m20:38:50.286698 [info ] [Thread-1 (]: 1 of 26 OK created sql view model main.stg_analytics ........................... [[32mOK[0m in 1.53s]
[0m20:38:50.287613 [debug] [Thread-1 (]: Finished running node model.dbt_playground.stg_analytics
[0m20:38:50.288277 [debug] [Thread-1 (]: Began running node model.dbt_playground.stg_events
[0m20:38:50.289105 [info ] [Thread-1 (]: 2 of 26 START sql view model main.stg_events ................................... [RUN]
[0m20:38:50.290071 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_playground.stg_analytics, now model.dbt_playground.stg_events)
[0m20:38:50.290653 [debug] [Thread-1 (]: Began compiling node model.dbt_playground.stg_events
[0m20:38:50.295576 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_playground.stg_events"
[0m20:38:50.297035 [debug] [Thread-1 (]: Timing info for model.dbt_playground.stg_events (compile): 20:38:50.291022 => 20:38:50.296814
[0m20:38:50.297491 [debug] [Thread-1 (]: Began executing node model.dbt_playground.stg_events
[0m20:38:50.302369 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_playground.stg_events"
[0m20:38:50.303315 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_playground.stg_events"
[0m20:38:50.303668 [debug] [Thread-1 (]: On model.dbt_playground.stg_events: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "dbt_playground", "target_name": "dev", "node_id": "model.dbt_playground.stg_events"} */

  
  create view "my_db"."main"."stg_events__dbt_tmp" as (
    select *
from "raw"."piwik"."streaming"
  );

[0m20:38:50.304004 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:38:50.877596 [debug] [Thread-1 (]: SQL status: OK in 1.0 seconds
[0m20:38:50.887719 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_playground.stg_events"
[0m20:38:50.888395 [debug] [Thread-1 (]: On model.dbt_playground.stg_events: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "dbt_playground", "target_name": "dev", "node_id": "model.dbt_playground.stg_events"} */
alter view "my_db"."main"."stg_events" rename to "stg_events__dbt_backup"
[0m20:38:51.179030 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m20:38:51.239721 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_playground.stg_events"
[0m20:38:51.240117 [debug] [Thread-1 (]: On model.dbt_playground.stg_events: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "dbt_playground", "target_name": "dev", "node_id": "model.dbt_playground.stg_events"} */
alter view "my_db"."main"."stg_events__dbt_tmp" rename to "stg_events"
[0m20:38:51.526986 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m20:38:51.537226 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_playground.stg_events"
[0m20:38:51.537746 [debug] [Thread-1 (]: On model.dbt_playground.stg_events: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "dbt_playground", "target_name": "dev", "node_id": "model.dbt_playground.stg_events"} */
drop view if exists "my_db"."main"."stg_events__dbt_backup" cascade
[0m20:38:51.823968 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m20:38:51.828773 [debug] [Thread-1 (]: Timing info for model.dbt_playground.stg_events (execute): 20:38:50.297781 => 20:38:51.828457
[0m20:38:51.829594 [debug] [Thread-1 (]: On model.dbt_playground.stg_events: Close
[0m20:38:51.830798 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '97992441-2a70-45c6-aaae-d652b8fdf13f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11019cbb0>]}
[0m20:38:51.831697 [info ] [Thread-1 (]: 2 of 26 OK created sql view model main.stg_events .............................. [[32mOK[0m in 1.54s]
[0m20:38:51.832447 [debug] [Thread-1 (]: Finished running node model.dbt_playground.stg_events
[0m20:38:51.833011 [debug] [Thread-1 (]: Began running node model.dbt_playground.stg_sessions
[0m20:38:51.833926 [info ] [Thread-1 (]: 3 of 26 START sql view model main.stg_sessions ................................. [RUN]
[0m20:38:51.834866 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_playground.stg_events, now model.dbt_playground.stg_sessions)
[0m20:38:51.835432 [debug] [Thread-1 (]: Began compiling node model.dbt_playground.stg_sessions
[0m20:38:51.840306 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_playground.stg_sessions"
[0m20:38:51.841445 [debug] [Thread-1 (]: Timing info for model.dbt_playground.stg_sessions (compile): 20:38:51.835789 => 20:38:51.841247
[0m20:38:51.841856 [debug] [Thread-1 (]: Began executing node model.dbt_playground.stg_sessions
[0m20:38:51.846497 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_playground.stg_sessions"
[0m20:38:51.847278 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_playground.stg_sessions"
[0m20:38:51.847669 [debug] [Thread-1 (]: On model.dbt_playground.stg_sessions: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "dbt_playground", "target_name": "dev", "node_id": "model.dbt_playground.stg_sessions"} */

  
  create view "my_db"."main"."stg_sessions__dbt_tmp" as (
    select *
from "raw"."piwik"."sessions"
  );

[0m20:38:51.848013 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:38:52.426301 [debug] [Thread-1 (]: SQL status: OK in 1.0 seconds
[0m20:38:52.436169 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_playground.stg_sessions"
[0m20:38:52.436683 [debug] [Thread-1 (]: On model.dbt_playground.stg_sessions: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "dbt_playground", "target_name": "dev", "node_id": "model.dbt_playground.stg_sessions"} */
alter view "my_db"."main"."stg_sessions" rename to "stg_sessions__dbt_backup"
[0m20:38:52.723849 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m20:38:52.730483 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_playground.stg_sessions"
[0m20:38:52.731029 [debug] [Thread-1 (]: On model.dbt_playground.stg_sessions: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "dbt_playground", "target_name": "dev", "node_id": "model.dbt_playground.stg_sessions"} */
alter view "my_db"."main"."stg_sessions__dbt_tmp" rename to "stg_sessions"
[0m20:38:53.018219 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m20:38:53.028573 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_playground.stg_sessions"
[0m20:38:53.028954 [debug] [Thread-1 (]: On model.dbt_playground.stg_sessions: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "dbt_playground", "target_name": "dev", "node_id": "model.dbt_playground.stg_sessions"} */
drop view if exists "my_db"."main"."stg_sessions__dbt_backup" cascade
[0m20:38:53.315515 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m20:38:53.322748 [debug] [Thread-1 (]: Timing info for model.dbt_playground.stg_sessions (execute): 20:38:51.842136 => 20:38:53.322115
[0m20:38:53.324188 [debug] [Thread-1 (]: On model.dbt_playground.stg_sessions: Close
[0m20:38:53.326568 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '97992441-2a70-45c6-aaae-d652b8fdf13f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11019c9d0>]}
[0m20:38:53.327687 [info ] [Thread-1 (]: 3 of 26 OK created sql view model main.stg_sessions ............................ [[32mOK[0m in 1.49s]
[0m20:38:53.328346 [debug] [Thread-1 (]: Finished running node model.dbt_playground.stg_sessions
[0m20:38:53.328753 [debug] [Thread-1 (]: Began running node test.dbt_playground.accepted_values_stg_analytics_referrer_type__Social__Direct_entry__Website__Search_engine__Campaign.b7c253d4f3
[0m20:38:53.329098 [info ] [Thread-1 (]: 4 of 26 START test accepted_values_stg_analytics_referrer_type__Social__Direct_entry__Website__Search_engine__Campaign  [RUN]
[0m20:38:53.329892 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_playground.stg_sessions, now test.dbt_playground.accepted_values_stg_analytics_referrer_type__Social__Direct_entry__Website__Search_engine__Campaign.b7c253d4f3)
[0m20:38:53.330393 [debug] [Thread-1 (]: Began compiling node test.dbt_playground.accepted_values_stg_analytics_referrer_type__Social__Direct_entry__Website__Search_engine__Campaign.b7c253d4f3
[0m20:38:53.340635 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_playground.accepted_values_stg_analytics_referrer_type__Social__Direct_entry__Website__Search_engine__Campaign.b7c253d4f3"
[0m20:38:53.341373 [debug] [Thread-1 (]: Timing info for test.dbt_playground.accepted_values_stg_analytics_referrer_type__Social__Direct_entry__Website__Search_engine__Campaign.b7c253d4f3 (compile): 20:38:53.330677 => 20:38:53.341224
[0m20:38:53.341661 [debug] [Thread-1 (]: Began executing node test.dbt_playground.accepted_values_stg_analytics_referrer_type__Social__Direct_entry__Website__Search_engine__Campaign.b7c253d4f3
[0m20:38:53.353027 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_playground.accepted_values_stg_analytics_referrer_type__Social__Direct_entry__Website__Search_engine__Campaign.b7c253d4f3"
[0m20:38:53.353740 [debug] [Thread-1 (]: Using duckdb connection "test.dbt_playground.accepted_values_stg_analytics_referrer_type__Social__Direct_entry__Website__Search_engine__Campaign.b7c253d4f3"
[0m20:38:53.354052 [debug] [Thread-1 (]: On test.dbt_playground.accepted_values_stg_analytics_referrer_type__Social__Direct_entry__Website__Search_engine__Campaign.b7c253d4f3: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "dbt_playground", "target_name": "dev", "node_id": "test.dbt_playground.accepted_values_stg_analytics_referrer_type__Social__Direct_entry__Website__Search_engine__Campaign.b7c253d4f3"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        referrer_type as value_field,
        count(*) as n_records

    from "my_db"."main"."stg_analytics"
    group by referrer_type

)

select *
from all_values
where value_field not in (
    'Social','Direct entry','Website','Search engine','Campaign'
)



      
    ) dbt_internal_test
[0m20:38:53.354326 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:38:53.739726 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m20:38:53.846600 [debug] [Thread-1 (]: Timing info for test.dbt_playground.accepted_values_stg_analytics_referrer_type__Social__Direct_entry__Website__Search_engine__Campaign.b7c253d4f3 (execute): 20:38:53.341848 => 20:38:53.845751
[0m20:38:53.847655 [debug] [Thread-1 (]: On test.dbt_playground.accepted_values_stg_analytics_referrer_type__Social__Direct_entry__Website__Search_engine__Campaign.b7c253d4f3: Close
[0m20:38:53.848628 [info ] [Thread-1 (]: 4 of 26 PASS accepted_values_stg_analytics_referrer_type__Social__Direct_entry__Website__Search_engine__Campaign  [[32mPASS[0m in 0.52s]
[0m20:38:53.849169 [debug] [Thread-1 (]: Finished running node test.dbt_playground.accepted_values_stg_analytics_referrer_type__Social__Direct_entry__Website__Search_engine__Campaign.b7c253d4f3
[0m20:38:53.849556 [debug] [Thread-1 (]: Began running node test.dbt_playground.accepted_values_stg_analytics_visitor_returning__Returning.da51a72cd4
[0m20:38:53.849999 [info ] [Thread-1 (]: 5 of 26 START test accepted_values_stg_analytics_visitor_returning__Returning .. [RUN]
[0m20:38:53.850625 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_playground.accepted_values_stg_analytics_referrer_type__Social__Direct_entry__Website__Search_engine__Campaign.b7c253d4f3, now test.dbt_playground.accepted_values_stg_analytics_visitor_returning__Returning.da51a72cd4)
[0m20:38:53.850943 [debug] [Thread-1 (]: Began compiling node test.dbt_playground.accepted_values_stg_analytics_visitor_returning__Returning.da51a72cd4
[0m20:38:53.856766 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_playground.accepted_values_stg_analytics_visitor_returning__Returning.da51a72cd4"
[0m20:38:53.857436 [debug] [Thread-1 (]: Timing info for test.dbt_playground.accepted_values_stg_analytics_visitor_returning__Returning.da51a72cd4 (compile): 20:38:53.851161 => 20:38:53.857307
[0m20:38:53.857693 [debug] [Thread-1 (]: Began executing node test.dbt_playground.accepted_values_stg_analytics_visitor_returning__Returning.da51a72cd4
[0m20:38:53.859628 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_playground.accepted_values_stg_analytics_visitor_returning__Returning.da51a72cd4"
[0m20:38:53.860068 [debug] [Thread-1 (]: Using duckdb connection "test.dbt_playground.accepted_values_stg_analytics_visitor_returning__Returning.da51a72cd4"
[0m20:38:53.860333 [debug] [Thread-1 (]: On test.dbt_playground.accepted_values_stg_analytics_visitor_returning__Returning.da51a72cd4: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "dbt_playground", "target_name": "dev", "node_id": "test.dbt_playground.accepted_values_stg_analytics_visitor_returning__Returning.da51a72cd4"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        visitor_returning as value_field,
        count(*) as n_records

    from "my_db"."main"."stg_analytics"
    group by visitor_returning

)

select *
from all_values
where value_field not in (
    'Returning'
)



      
    ) dbt_internal_test
[0m20:38:53.860585 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:38:54.247261 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m20:38:54.350251 [debug] [Thread-1 (]: Timing info for test.dbt_playground.accepted_values_stg_analytics_visitor_returning__Returning.da51a72cd4 (execute): 20:38:53.857867 => 20:38:54.349671
[0m20:38:54.351342 [debug] [Thread-1 (]: On test.dbt_playground.accepted_values_stg_analytics_visitor_returning__Returning.da51a72cd4: Close
[0m20:38:54.352765 [info ] [Thread-1 (]: 5 of 26 PASS accepted_values_stg_analytics_visitor_returning__Returning ........ [[32mPASS[0m in 0.50s]
[0m20:38:54.354455 [debug] [Thread-1 (]: Finished running node test.dbt_playground.accepted_values_stg_analytics_visitor_returning__Returning.da51a72cd4
[0m20:38:54.355025 [debug] [Thread-1 (]: Began running node test.dbt_playground.dbt_expectations_expect_column_to_exist_stg_events_event_id.217a55054e
[0m20:38:54.355786 [info ] [Thread-1 (]: 6 of 26 START test dbt_expectations_expect_column_to_exist_stg_events_event_id . [RUN]
[0m20:38:54.356769 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_playground.accepted_values_stg_analytics_visitor_returning__Returning.da51a72cd4, now test.dbt_playground.dbt_expectations_expect_column_to_exist_stg_events_event_id.217a55054e)
[0m20:38:54.358715 [debug] [Thread-1 (]: Began compiling node test.dbt_playground.dbt_expectations_expect_column_to_exist_stg_events_event_id.217a55054e
[0m20:38:54.377389 [debug] [Thread-1 (]: Using duckdb connection "test.dbt_playground.dbt_expectations_expect_column_to_exist_stg_events_event_id.217a55054e"
[0m20:38:54.378044 [debug] [Thread-1 (]: On test.dbt_playground.dbt_expectations_expect_column_to_exist_stg_events_event_id.217a55054e: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "dbt_playground", "target_name": "dev", "node_id": "test.dbt_playground.dbt_expectations_expect_column_to_exist_stg_events_event_id.217a55054e"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'stg_events'
      
      and table_schema = 'main'
      
      
      and table_catalog = 'my_db'
      
      order by ordinal_position

  
[0m20:38:54.378437 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:38:54.715069 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m20:38:54.721228 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_playground.dbt_expectations_expect_column_to_exist_stg_events_event_id.217a55054e"
[0m20:38:54.721873 [debug] [Thread-1 (]: Timing info for test.dbt_playground.dbt_expectations_expect_column_to_exist_stg_events_event_id.217a55054e (compile): 20:38:54.359125 => 20:38:54.721736
[0m20:38:54.722145 [debug] [Thread-1 (]: Began executing node test.dbt_playground.dbt_expectations_expect_column_to_exist_stg_events_event_id.217a55054e
[0m20:38:54.725065 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_playground.dbt_expectations_expect_column_to_exist_stg_events_event_id.217a55054e"
[0m20:38:54.725534 [debug] [Thread-1 (]: Using duckdb connection "test.dbt_playground.dbt_expectations_expect_column_to_exist_stg_events_event_id.217a55054e"
[0m20:38:54.725803 [debug] [Thread-1 (]: On test.dbt_playground.dbt_expectations_expect_column_to_exist_stg_events_event_id.217a55054e: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "dbt_playground", "target_name": "dev", "node_id": "test.dbt_playground.dbt_expectations_expect_column_to_exist_stg_events_event_id.217a55054e"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      

    with test_data as (

        select
            cast('EVENT_ID' as TEXT) as column_name,
            1 as matching_column_index,
            True as column_index_matches

    )
    select *
    from test_data
    where
        not(matching_column_index >= 0 and column_index_matches)
      
    ) dbt_internal_test
[0m20:38:54.727279 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m20:38:54.728317 [debug] [Thread-1 (]: Timing info for test.dbt_playground.dbt_expectations_expect_column_to_exist_stg_events_event_id.217a55054e (execute): 20:38:54.722325 => 20:38:54.728182
[0m20:38:54.728597 [debug] [Thread-1 (]: On test.dbt_playground.dbt_expectations_expect_column_to_exist_stg_events_event_id.217a55054e: Close
[0m20:38:54.729214 [info ] [Thread-1 (]: 6 of 26 PASS dbt_expectations_expect_column_to_exist_stg_events_event_id ....... [[32mPASS[0m in 0.37s]
[0m20:38:54.729591 [debug] [Thread-1 (]: Finished running node test.dbt_playground.dbt_expectations_expect_column_to_exist_stg_events_event_id.217a55054e
[0m20:38:54.729868 [debug] [Thread-1 (]: Began running node test.dbt_playground.dbt_expectations_expect_column_to_exist_stg_events_session_id.c5e72af676
[0m20:38:54.730164 [info ] [Thread-1 (]: 7 of 26 START test dbt_expectations_expect_column_to_exist_stg_events_session_id  [RUN]
[0m20:38:54.730581 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_playground.dbt_expectations_expect_column_to_exist_stg_events_event_id.217a55054e, now test.dbt_playground.dbt_expectations_expect_column_to_exist_stg_events_session_id.c5e72af676)
[0m20:38:54.730828 [debug] [Thread-1 (]: Began compiling node test.dbt_playground.dbt_expectations_expect_column_to_exist_stg_events_session_id.c5e72af676
[0m20:38:54.735428 [debug] [Thread-1 (]: Using duckdb connection "test.dbt_playground.dbt_expectations_expect_column_to_exist_stg_events_session_id.c5e72af676"
[0m20:38:54.735890 [debug] [Thread-1 (]: On test.dbt_playground.dbt_expectations_expect_column_to_exist_stg_events_session_id.c5e72af676: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "dbt_playground", "target_name": "dev", "node_id": "test.dbt_playground.dbt_expectations_expect_column_to_exist_stg_events_session_id.c5e72af676"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'stg_events'
      
      and table_schema = 'main'
      
      
      and table_catalog = 'my_db'
      
      order by ordinal_position

  
[0m20:38:54.736160 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:38:55.054739 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m20:38:55.057470 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_playground.dbt_expectations_expect_column_to_exist_stg_events_session_id.c5e72af676"
[0m20:38:55.058471 [debug] [Thread-1 (]: Timing info for test.dbt_playground.dbt_expectations_expect_column_to_exist_stg_events_session_id.c5e72af676 (compile): 20:38:54.730997 => 20:38:55.058289
[0m20:38:55.058838 [debug] [Thread-1 (]: Began executing node test.dbt_playground.dbt_expectations_expect_column_to_exist_stg_events_session_id.c5e72af676
[0m20:38:55.061855 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_playground.dbt_expectations_expect_column_to_exist_stg_events_session_id.c5e72af676"
[0m20:38:55.062469 [debug] [Thread-1 (]: Using duckdb connection "test.dbt_playground.dbt_expectations_expect_column_to_exist_stg_events_session_id.c5e72af676"
[0m20:38:55.062800 [debug] [Thread-1 (]: On test.dbt_playground.dbt_expectations_expect_column_to_exist_stg_events_session_id.c5e72af676: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "dbt_playground", "target_name": "dev", "node_id": "test.dbt_playground.dbt_expectations_expect_column_to_exist_stg_events_session_id.c5e72af676"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      

    with test_data as (

        select
            cast('SESSION_ID' as TEXT) as column_name,
            0 as matching_column_index,
            True as column_index_matches

    )
    select *
    from test_data
    where
        not(matching_column_index >= 0 and column_index_matches)
      
    ) dbt_internal_test
[0m20:38:55.063598 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m20:38:55.064766 [debug] [Thread-1 (]: Timing info for test.dbt_playground.dbt_expectations_expect_column_to_exist_stg_events_session_id.c5e72af676 (execute): 20:38:55.059069 => 20:38:55.064626
[0m20:38:55.065085 [debug] [Thread-1 (]: On test.dbt_playground.dbt_expectations_expect_column_to_exist_stg_events_session_id.c5e72af676: Close
[0m20:38:55.065831 [info ] [Thread-1 (]: 7 of 26 PASS dbt_expectations_expect_column_to_exist_stg_events_session_id ..... [[32mPASS[0m in 0.34s]
[0m20:38:55.066281 [debug] [Thread-1 (]: Finished running node test.dbt_playground.dbt_expectations_expect_column_to_exist_stg_events_session_id.c5e72af676
[0m20:38:55.066639 [debug] [Thread-1 (]: Began running node test.dbt_playground.dbt_expectations_expect_column_to_exist_stg_events_visitor_id.8a7ec39171
[0m20:38:55.067016 [info ] [Thread-1 (]: 8 of 26 START test dbt_expectations_expect_column_to_exist_stg_events_visitor_id  [RUN]
[0m20:38:55.067500 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_playground.dbt_expectations_expect_column_to_exist_stg_events_session_id.c5e72af676, now test.dbt_playground.dbt_expectations_expect_column_to_exist_stg_events_visitor_id.8a7ec39171)
[0m20:38:55.067782 [debug] [Thread-1 (]: Began compiling node test.dbt_playground.dbt_expectations_expect_column_to_exist_stg_events_visitor_id.8a7ec39171
[0m20:38:55.074182 [debug] [Thread-1 (]: Using duckdb connection "test.dbt_playground.dbt_expectations_expect_column_to_exist_stg_events_visitor_id.8a7ec39171"
[0m20:38:55.074586 [debug] [Thread-1 (]: On test.dbt_playground.dbt_expectations_expect_column_to_exist_stg_events_visitor_id.8a7ec39171: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "dbt_playground", "target_name": "dev", "node_id": "test.dbt_playground.dbt_expectations_expect_column_to_exist_stg_events_visitor_id.8a7ec39171"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'stg_events'
      
      and table_schema = 'main'
      
      
      and table_catalog = 'my_db'
      
      order by ordinal_position

  
[0m20:38:55.074854 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:38:55.391278 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m20:38:55.393817 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_playground.dbt_expectations_expect_column_to_exist_stg_events_visitor_id.8a7ec39171"
[0m20:38:55.394737 [debug] [Thread-1 (]: Timing info for test.dbt_playground.dbt_expectations_expect_column_to_exist_stg_events_visitor_id.8a7ec39171 (compile): 20:38:55.067973 => 20:38:55.394566
[0m20:38:55.395055 [debug] [Thread-1 (]: Began executing node test.dbt_playground.dbt_expectations_expect_column_to_exist_stg_events_visitor_id.8a7ec39171
[0m20:38:55.397922 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_playground.dbt_expectations_expect_column_to_exist_stg_events_visitor_id.8a7ec39171"
[0m20:38:55.398543 [debug] [Thread-1 (]: Using duckdb connection "test.dbt_playground.dbt_expectations_expect_column_to_exist_stg_events_visitor_id.8a7ec39171"
[0m20:38:55.398849 [debug] [Thread-1 (]: On test.dbt_playground.dbt_expectations_expect_column_to_exist_stg_events_visitor_id.8a7ec39171: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "dbt_playground", "target_name": "dev", "node_id": "test.dbt_playground.dbt_expectations_expect_column_to_exist_stg_events_visitor_id.8a7ec39171"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      

    with test_data as (

        select
            cast('VISITOR_ID' as TEXT) as column_name,
            2 as matching_column_index,
            True as column_index_matches

    )
    select *
    from test_data
    where
        not(matching_column_index >= 0 and column_index_matches)
      
    ) dbt_internal_test
[0m20:38:55.399583 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m20:38:55.400654 [debug] [Thread-1 (]: Timing info for test.dbt_playground.dbt_expectations_expect_column_to_exist_stg_events_visitor_id.8a7ec39171 (execute): 20:38:55.395283 => 20:38:55.400531
[0m20:38:55.400926 [debug] [Thread-1 (]: On test.dbt_playground.dbt_expectations_expect_column_to_exist_stg_events_visitor_id.8a7ec39171: Close
[0m20:38:55.401549 [info ] [Thread-1 (]: 8 of 26 PASS dbt_expectations_expect_column_to_exist_stg_events_visitor_id ..... [[32mPASS[0m in 0.33s]
[0m20:38:55.401931 [debug] [Thread-1 (]: Finished running node test.dbt_playground.dbt_expectations_expect_column_to_exist_stg_events_visitor_id.8a7ec39171
[0m20:38:55.402208 [debug] [Thread-1 (]: Began running node test.dbt_playground.not_null_stg_events_event_id.715b3f7012
[0m20:38:55.402498 [info ] [Thread-1 (]: 9 of 26 START test not_null_stg_events_event_id ................................ [RUN]
[0m20:38:55.402900 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_playground.dbt_expectations_expect_column_to_exist_stg_events_visitor_id.8a7ec39171, now test.dbt_playground.not_null_stg_events_event_id.715b3f7012)
[0m20:38:55.403143 [debug] [Thread-1 (]: Began compiling node test.dbt_playground.not_null_stg_events_event_id.715b3f7012
[0m20:38:55.407938 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_playground.not_null_stg_events_event_id.715b3f7012"
[0m20:38:55.408574 [debug] [Thread-1 (]: Timing info for test.dbt_playground.not_null_stg_events_event_id.715b3f7012 (compile): 20:38:55.403311 => 20:38:55.408447
[0m20:38:55.408833 [debug] [Thread-1 (]: Began executing node test.dbt_playground.not_null_stg_events_event_id.715b3f7012
[0m20:38:55.410849 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_playground.not_null_stg_events_event_id.715b3f7012"
[0m20:38:55.411292 [debug] [Thread-1 (]: Using duckdb connection "test.dbt_playground.not_null_stg_events_event_id.715b3f7012"
[0m20:38:55.411539 [debug] [Thread-1 (]: On test.dbt_playground.not_null_stg_events_event_id.715b3f7012: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "dbt_playground", "target_name": "dev", "node_id": "test.dbt_playground.not_null_stg_events_event_id.715b3f7012"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select event_id
from "my_db"."main"."stg_events"
where event_id is null



      
    ) dbt_internal_test
[0m20:38:55.411782 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:38:55.791697 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m20:38:55.892586 [debug] [Thread-1 (]: Timing info for test.dbt_playground.not_null_stg_events_event_id.715b3f7012 (execute): 20:38:55.409007 => 20:38:55.892004
[0m20:38:55.893872 [debug] [Thread-1 (]: On test.dbt_playground.not_null_stg_events_event_id.715b3f7012: Close
[0m20:38:55.895641 [info ] [Thread-1 (]: 9 of 26 PASS not_null_stg_events_event_id ...................................... [[32mPASS[0m in 0.49s]
[0m20:38:55.896885 [debug] [Thread-1 (]: Finished running node test.dbt_playground.not_null_stg_events_event_id.715b3f7012
[0m20:38:55.897567 [debug] [Thread-1 (]: Began running node test.dbt_playground.not_null_stg_events_session_id.e91b448cdc
[0m20:38:55.898268 [info ] [Thread-1 (]: 10 of 26 START test not_null_stg_events_session_id ............................. [RUN]
[0m20:38:55.899322 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_playground.not_null_stg_events_event_id.715b3f7012, now test.dbt_playground.not_null_stg_events_session_id.e91b448cdc)
[0m20:38:55.899830 [debug] [Thread-1 (]: Began compiling node test.dbt_playground.not_null_stg_events_session_id.e91b448cdc
[0m20:38:55.905941 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_playground.not_null_stg_events_session_id.e91b448cdc"
[0m20:38:55.907119 [debug] [Thread-1 (]: Timing info for test.dbt_playground.not_null_stg_events_session_id.e91b448cdc (compile): 20:38:55.900176 => 20:38:55.906897
[0m20:38:55.907551 [debug] [Thread-1 (]: Began executing node test.dbt_playground.not_null_stg_events_session_id.e91b448cdc
[0m20:38:55.912641 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_playground.not_null_stg_events_session_id.e91b448cdc"
[0m20:38:55.913489 [debug] [Thread-1 (]: Using duckdb connection "test.dbt_playground.not_null_stg_events_session_id.e91b448cdc"
[0m20:38:55.913861 [debug] [Thread-1 (]: On test.dbt_playground.not_null_stg_events_session_id.e91b448cdc: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "dbt_playground", "target_name": "dev", "node_id": "test.dbt_playground.not_null_stg_events_session_id.e91b448cdc"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select session_id
from "my_db"."main"."stg_events"
where session_id is null



      
    ) dbt_internal_test
[0m20:38:55.914197 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:38:56.303325 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m20:38:56.405639 [debug] [Thread-1 (]: Timing info for test.dbt_playground.not_null_stg_events_session_id.e91b448cdc (execute): 20:38:55.907838 => 20:38:56.405143
[0m20:38:56.406453 [debug] [Thread-1 (]: On test.dbt_playground.not_null_stg_events_session_id.e91b448cdc: Close
[0m20:38:56.407589 [info ] [Thread-1 (]: 10 of 26 PASS not_null_stg_events_session_id ................................... [[32mPASS[0m in 0.51s]
[0m20:38:56.408245 [debug] [Thread-1 (]: Finished running node test.dbt_playground.not_null_stg_events_session_id.e91b448cdc
[0m20:38:56.408739 [debug] [Thread-1 (]: Began running node test.dbt_playground.not_null_stg_events_visitor_id.7c0caa0efa
[0m20:38:56.409257 [info ] [Thread-1 (]: 11 of 26 START test not_null_stg_events_visitor_id ............................. [RUN]
[0m20:38:56.409969 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_playground.not_null_stg_events_session_id.e91b448cdc, now test.dbt_playground.not_null_stg_events_visitor_id.7c0caa0efa)
[0m20:38:56.410340 [debug] [Thread-1 (]: Began compiling node test.dbt_playground.not_null_stg_events_visitor_id.7c0caa0efa
[0m20:38:56.415672 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_playground.not_null_stg_events_visitor_id.7c0caa0efa"
[0m20:38:56.416728 [debug] [Thread-1 (]: Timing info for test.dbt_playground.not_null_stg_events_visitor_id.7c0caa0efa (compile): 20:38:56.410630 => 20:38:56.416557
[0m20:38:56.417045 [debug] [Thread-1 (]: Began executing node test.dbt_playground.not_null_stg_events_visitor_id.7c0caa0efa
[0m20:38:56.419625 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_playground.not_null_stg_events_visitor_id.7c0caa0efa"
[0m20:38:56.420169 [debug] [Thread-1 (]: Using duckdb connection "test.dbt_playground.not_null_stg_events_visitor_id.7c0caa0efa"
[0m20:38:56.420479 [debug] [Thread-1 (]: On test.dbt_playground.not_null_stg_events_visitor_id.7c0caa0efa: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "dbt_playground", "target_name": "dev", "node_id": "test.dbt_playground.not_null_stg_events_visitor_id.7c0caa0efa"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select visitor_id
from "my_db"."main"."stg_events"
where visitor_id is null



      
    ) dbt_internal_test
[0m20:38:56.420777 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:38:56.803710 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m20:38:56.903778 [debug] [Thread-1 (]: Timing info for test.dbt_playground.not_null_stg_events_visitor_id.7c0caa0efa (execute): 20:38:56.417277 => 20:38:56.903404
[0m20:38:56.904516 [debug] [Thread-1 (]: On test.dbt_playground.not_null_stg_events_visitor_id.7c0caa0efa: Close
[0m20:38:56.905656 [info ] [Thread-1 (]: 11 of 26 PASS not_null_stg_events_visitor_id ................................... [[32mPASS[0m in 0.50s]
[0m20:38:56.906406 [debug] [Thread-1 (]: Finished running node test.dbt_playground.not_null_stg_events_visitor_id.7c0caa0efa
[0m20:38:56.906967 [debug] [Thread-1 (]: Began running node test.dbt_playground.unique_stg_events_event_id.66ebb17438
[0m20:38:56.907627 [info ] [Thread-1 (]: 12 of 26 START test unique_stg_events_event_id ................................. [RUN]
[0m20:38:56.908582 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_playground.not_null_stg_events_visitor_id.7c0caa0efa, now test.dbt_playground.unique_stg_events_event_id.66ebb17438)
[0m20:38:56.909035 [debug] [Thread-1 (]: Began compiling node test.dbt_playground.unique_stg_events_event_id.66ebb17438
[0m20:38:56.917279 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_playground.unique_stg_events_event_id.66ebb17438"
[0m20:38:56.918890 [debug] [Thread-1 (]: Timing info for test.dbt_playground.unique_stg_events_event_id.66ebb17438 (compile): 20:38:56.909348 => 20:38:56.918638
[0m20:38:56.919352 [debug] [Thread-1 (]: Began executing node test.dbt_playground.unique_stg_events_event_id.66ebb17438
[0m20:38:56.922382 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_playground.unique_stg_events_event_id.66ebb17438"
[0m20:38:56.923201 [debug] [Thread-1 (]: Using duckdb connection "test.dbt_playground.unique_stg_events_event_id.66ebb17438"
[0m20:38:56.923537 [debug] [Thread-1 (]: On test.dbt_playground.unique_stg_events_event_id.66ebb17438: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "dbt_playground", "target_name": "dev", "node_id": "test.dbt_playground.unique_stg_events_event_id.66ebb17438"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    event_id as unique_field,
    count(*) as n_records

from "my_db"."main"."stg_events"
where event_id is not null
group by event_id
having count(*) > 1



      
    ) dbt_internal_test
[0m20:38:56.923883 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:38:57.308037 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m20:38:57.410134 [debug] [Thread-1 (]: Timing info for test.dbt_playground.unique_stg_events_event_id.66ebb17438 (execute): 20:38:56.919625 => 20:38:57.409665
[0m20:38:57.410883 [debug] [Thread-1 (]: On test.dbt_playground.unique_stg_events_event_id.66ebb17438: Close
[0m20:38:57.412048 [info ] [Thread-1 (]: 12 of 26 PASS unique_stg_events_event_id ....................................... [[32mPASS[0m in 0.50s]
[0m20:38:57.412790 [debug] [Thread-1 (]: Finished running node test.dbt_playground.unique_stg_events_event_id.66ebb17438
[0m20:38:57.413353 [debug] [Thread-1 (]: Began running node test.dbt_playground.dbt_expectations_expect_column_to_exist_stg_sessions_session_id.82f15e2a75
[0m20:38:57.414160 [info ] [Thread-1 (]: 13 of 26 START test dbt_expectations_expect_column_to_exist_stg_sessions_session_id  [RUN]
[0m20:38:57.415121 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_playground.unique_stg_events_event_id.66ebb17438, now test.dbt_playground.dbt_expectations_expect_column_to_exist_stg_sessions_session_id.82f15e2a75)
[0m20:38:57.415643 [debug] [Thread-1 (]: Began compiling node test.dbt_playground.dbt_expectations_expect_column_to_exist_stg_sessions_session_id.82f15e2a75
[0m20:38:57.426087 [debug] [Thread-1 (]: Using duckdb connection "test.dbt_playground.dbt_expectations_expect_column_to_exist_stg_sessions_session_id.82f15e2a75"
[0m20:38:57.426610 [debug] [Thread-1 (]: On test.dbt_playground.dbt_expectations_expect_column_to_exist_stg_sessions_session_id.82f15e2a75: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "dbt_playground", "target_name": "dev", "node_id": "test.dbt_playground.dbt_expectations_expect_column_to_exist_stg_sessions_session_id.82f15e2a75"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'stg_sessions'
      
      and table_schema = 'main'
      
      
      and table_catalog = 'my_db'
      
      order by ordinal_position

  
[0m20:38:57.426994 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:38:57.746020 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m20:38:57.748216 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_playground.dbt_expectations_expect_column_to_exist_stg_sessions_session_id.82f15e2a75"
[0m20:38:57.749017 [debug] [Thread-1 (]: Timing info for test.dbt_playground.dbt_expectations_expect_column_to_exist_stg_sessions_session_id.82f15e2a75 (compile): 20:38:57.415995 => 20:38:57.748846
[0m20:38:57.749362 [debug] [Thread-1 (]: Began executing node test.dbt_playground.dbt_expectations_expect_column_to_exist_stg_sessions_session_id.82f15e2a75
[0m20:38:57.751964 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_playground.dbt_expectations_expect_column_to_exist_stg_sessions_session_id.82f15e2a75"
[0m20:38:57.752468 [debug] [Thread-1 (]: Using duckdb connection "test.dbt_playground.dbt_expectations_expect_column_to_exist_stg_sessions_session_id.82f15e2a75"
[0m20:38:57.752791 [debug] [Thread-1 (]: On test.dbt_playground.dbt_expectations_expect_column_to_exist_stg_sessions_session_id.82f15e2a75: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "dbt_playground", "target_name": "dev", "node_id": "test.dbt_playground.dbt_expectations_expect_column_to_exist_stg_sessions_session_id.82f15e2a75"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      

    with test_data as (

        select
            cast('SESSION_ID' as TEXT) as column_name,
            0 as matching_column_index,
            True as column_index_matches

    )
    select *
    from test_data
    where
        not(matching_column_index >= 0 and column_index_matches)
      
    ) dbt_internal_test
[0m20:38:57.753503 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m20:38:57.754537 [debug] [Thread-1 (]: Timing info for test.dbt_playground.dbt_expectations_expect_column_to_exist_stg_sessions_session_id.82f15e2a75 (execute): 20:38:57.749580 => 20:38:57.754402
[0m20:38:57.754823 [debug] [Thread-1 (]: On test.dbt_playground.dbt_expectations_expect_column_to_exist_stg_sessions_session_id.82f15e2a75: Close
[0m20:38:57.755503 [info ] [Thread-1 (]: 13 of 26 PASS dbt_expectations_expect_column_to_exist_stg_sessions_session_id .. [[32mPASS[0m in 0.34s]
[0m20:38:57.755915 [debug] [Thread-1 (]: Finished running node test.dbt_playground.dbt_expectations_expect_column_to_exist_stg_sessions_session_id.82f15e2a75
[0m20:38:57.756224 [debug] [Thread-1 (]: Began running node test.dbt_playground.dbt_expectations_expect_column_to_exist_stg_sessions_visitor_id.cc2400948b
[0m20:38:57.756493 [info ] [Thread-1 (]: 14 of 26 START test dbt_expectations_expect_column_to_exist_stg_sessions_visitor_id  [RUN]
[0m20:38:57.757096 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_playground.dbt_expectations_expect_column_to_exist_stg_sessions_session_id.82f15e2a75, now test.dbt_playground.dbt_expectations_expect_column_to_exist_stg_sessions_visitor_id.cc2400948b)
[0m20:38:57.757422 [debug] [Thread-1 (]: Began compiling node test.dbt_playground.dbt_expectations_expect_column_to_exist_stg_sessions_visitor_id.cc2400948b
[0m20:38:57.762273 [debug] [Thread-1 (]: Using duckdb connection "test.dbt_playground.dbt_expectations_expect_column_to_exist_stg_sessions_visitor_id.cc2400948b"
[0m20:38:57.762589 [debug] [Thread-1 (]: On test.dbt_playground.dbt_expectations_expect_column_to_exist_stg_sessions_visitor_id.cc2400948b: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "dbt_playground", "target_name": "dev", "node_id": "test.dbt_playground.dbt_expectations_expect_column_to_exist_stg_sessions_visitor_id.cc2400948b"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'stg_sessions'
      
      and table_schema = 'main'
      
      
      and table_catalog = 'my_db'
      
      order by ordinal_position

  
[0m20:38:57.762830 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:38:58.073767 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m20:38:58.076264 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_playground.dbt_expectations_expect_column_to_exist_stg_sessions_visitor_id.cc2400948b"
[0m20:38:58.077178 [debug] [Thread-1 (]: Timing info for test.dbt_playground.dbt_expectations_expect_column_to_exist_stg_sessions_visitor_id.cc2400948b (compile): 20:38:57.757635 => 20:38:58.077008
[0m20:38:58.077511 [debug] [Thread-1 (]: Began executing node test.dbt_playground.dbt_expectations_expect_column_to_exist_stg_sessions_visitor_id.cc2400948b
[0m20:38:58.081748 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_playground.dbt_expectations_expect_column_to_exist_stg_sessions_visitor_id.cc2400948b"
[0m20:38:58.082281 [debug] [Thread-1 (]: Using duckdb connection "test.dbt_playground.dbt_expectations_expect_column_to_exist_stg_sessions_visitor_id.cc2400948b"
[0m20:38:58.082558 [debug] [Thread-1 (]: On test.dbt_playground.dbt_expectations_expect_column_to_exist_stg_sessions_visitor_id.cc2400948b: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "dbt_playground", "target_name": "dev", "node_id": "test.dbt_playground.dbt_expectations_expect_column_to_exist_stg_sessions_visitor_id.cc2400948b"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      

    with test_data as (

        select
            cast('VISITOR_ID' as TEXT) as column_name,
            1 as matching_column_index,
            True as column_index_matches

    )
    select *
    from test_data
    where
        not(matching_column_index >= 0 and column_index_matches)
      
    ) dbt_internal_test
[0m20:38:58.083226 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m20:38:58.084177 [debug] [Thread-1 (]: Timing info for test.dbt_playground.dbt_expectations_expect_column_to_exist_stg_sessions_visitor_id.cc2400948b (execute): 20:38:58.077719 => 20:38:58.084054
[0m20:38:58.084435 [debug] [Thread-1 (]: On test.dbt_playground.dbt_expectations_expect_column_to_exist_stg_sessions_visitor_id.cc2400948b: Close
[0m20:38:58.085054 [info ] [Thread-1 (]: 14 of 26 PASS dbt_expectations_expect_column_to_exist_stg_sessions_visitor_id .. [[32mPASS[0m in 0.33s]
[0m20:38:58.085434 [debug] [Thread-1 (]: Finished running node test.dbt_playground.dbt_expectations_expect_column_to_exist_stg_sessions_visitor_id.cc2400948b
[0m20:38:58.085710 [debug] [Thread-1 (]: Began running node test.dbt_playground.not_null_stg_sessions_session_id.2e872a126d
[0m20:38:58.086041 [info ] [Thread-1 (]: 15 of 26 START test not_null_stg_sessions_session_id ........................... [RUN]
[0m20:38:58.086465 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_playground.dbt_expectations_expect_column_to_exist_stg_sessions_visitor_id.cc2400948b, now test.dbt_playground.not_null_stg_sessions_session_id.2e872a126d)
[0m20:38:58.086704 [debug] [Thread-1 (]: Began compiling node test.dbt_playground.not_null_stg_sessions_session_id.2e872a126d
[0m20:38:58.089815 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_playground.not_null_stg_sessions_session_id.2e872a126d"
[0m20:38:58.090388 [debug] [Thread-1 (]: Timing info for test.dbt_playground.not_null_stg_sessions_session_id.2e872a126d (compile): 20:38:58.086870 => 20:38:58.090269
[0m20:38:58.090631 [debug] [Thread-1 (]: Began executing node test.dbt_playground.not_null_stg_sessions_session_id.2e872a126d
[0m20:38:58.092779 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_playground.not_null_stg_sessions_session_id.2e872a126d"
[0m20:38:58.093398 [debug] [Thread-1 (]: Using duckdb connection "test.dbt_playground.not_null_stg_sessions_session_id.2e872a126d"
[0m20:38:58.093668 [debug] [Thread-1 (]: On test.dbt_playground.not_null_stg_sessions_session_id.2e872a126d: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "dbt_playground", "target_name": "dev", "node_id": "test.dbt_playground.not_null_stg_sessions_session_id.2e872a126d"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select session_id
from "my_db"."main"."stg_sessions"
where session_id is null



      
    ) dbt_internal_test
[0m20:38:58.093913 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:38:58.478918 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m20:38:58.582156 [debug] [Thread-1 (]: Timing info for test.dbt_playground.not_null_stg_sessions_session_id.2e872a126d (execute): 20:38:58.090801 => 20:38:58.581119
[0m20:38:58.584164 [debug] [Thread-1 (]: On test.dbt_playground.not_null_stg_sessions_session_id.2e872a126d: Close
[0m20:38:58.586057 [info ] [Thread-1 (]: 15 of 26 PASS not_null_stg_sessions_session_id ................................. [[32mPASS[0m in 0.50s]
[0m20:38:58.586957 [debug] [Thread-1 (]: Finished running node test.dbt_playground.not_null_stg_sessions_session_id.2e872a126d
[0m20:38:58.587571 [debug] [Thread-1 (]: Began running node test.dbt_playground.not_null_stg_sessions_visitor_id.1fa5d38e94
[0m20:38:58.588118 [info ] [Thread-1 (]: 16 of 26 START test not_null_stg_sessions_visitor_id ........................... [RUN]
[0m20:38:58.588917 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_playground.not_null_stg_sessions_session_id.2e872a126d, now test.dbt_playground.not_null_stg_sessions_visitor_id.1fa5d38e94)
[0m20:38:58.589523 [debug] [Thread-1 (]: Began compiling node test.dbt_playground.not_null_stg_sessions_visitor_id.1fa5d38e94
[0m20:38:58.595451 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_playground.not_null_stg_sessions_visitor_id.1fa5d38e94"
[0m20:38:58.596352 [debug] [Thread-1 (]: Timing info for test.dbt_playground.not_null_stg_sessions_visitor_id.1fa5d38e94 (compile): 20:38:58.589908 => 20:38:58.596172
[0m20:38:58.596706 [debug] [Thread-1 (]: Began executing node test.dbt_playground.not_null_stg_sessions_visitor_id.1fa5d38e94
[0m20:38:58.599571 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_playground.not_null_stg_sessions_visitor_id.1fa5d38e94"
[0m20:38:58.600369 [debug] [Thread-1 (]: Using duckdb connection "test.dbt_playground.not_null_stg_sessions_visitor_id.1fa5d38e94"
[0m20:38:58.600732 [debug] [Thread-1 (]: On test.dbt_playground.not_null_stg_sessions_visitor_id.1fa5d38e94: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "dbt_playground", "target_name": "dev", "node_id": "test.dbt_playground.not_null_stg_sessions_visitor_id.1fa5d38e94"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select visitor_id
from "my_db"."main"."stg_sessions"
where visitor_id is null



      
    ) dbt_internal_test
[0m20:38:58.601055 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:38:58.987212 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m20:38:59.090093 [debug] [Thread-1 (]: Timing info for test.dbt_playground.not_null_stg_sessions_visitor_id.1fa5d38e94 (execute): 20:38:58.596945 => 20:38:59.089296
[0m20:38:59.091242 [debug] [Thread-1 (]: On test.dbt_playground.not_null_stg_sessions_visitor_id.1fa5d38e94: Close
[0m20:38:59.092545 [info ] [Thread-1 (]: 16 of 26 PASS not_null_stg_sessions_visitor_id ................................. [[32mPASS[0m in 0.50s]
[0m20:38:59.093350 [debug] [Thread-1 (]: Finished running node test.dbt_playground.not_null_stg_sessions_visitor_id.1fa5d38e94
[0m20:38:59.093928 [debug] [Thread-1 (]: Began running node test.dbt_playground.relationships_stg_events_session_id__session_id__ref_stg_sessions_.86082a5a59
[0m20:38:59.094394 [info ] [Thread-1 (]: 17 of 26 START test relationships_stg_events_session_id__session_id__ref_stg_sessions_  [RUN]
[0m20:38:59.095282 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_playground.not_null_stg_sessions_visitor_id.1fa5d38e94, now test.dbt_playground.relationships_stg_events_session_id__session_id__ref_stg_sessions_.86082a5a59)
[0m20:38:59.095689 [debug] [Thread-1 (]: Began compiling node test.dbt_playground.relationships_stg_events_session_id__session_id__ref_stg_sessions_.86082a5a59
[0m20:38:59.106971 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_playground.relationships_stg_events_session_id__session_id__ref_stg_sessions_.86082a5a59"
[0m20:38:59.108095 [debug] [Thread-1 (]: Timing info for test.dbt_playground.relationships_stg_events_session_id__session_id__ref_stg_sessions_.86082a5a59 (compile): 20:38:59.095971 => 20:38:59.107901
[0m20:38:59.108465 [debug] [Thread-1 (]: Began executing node test.dbt_playground.relationships_stg_events_session_id__session_id__ref_stg_sessions_.86082a5a59
[0m20:38:59.111166 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_playground.relationships_stg_events_session_id__session_id__ref_stg_sessions_.86082a5a59"
[0m20:38:59.111879 [debug] [Thread-1 (]: Using duckdb connection "test.dbt_playground.relationships_stg_events_session_id__session_id__ref_stg_sessions_.86082a5a59"
[0m20:38:59.112219 [debug] [Thread-1 (]: On test.dbt_playground.relationships_stg_events_session_id__session_id__ref_stg_sessions_.86082a5a59: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "dbt_playground", "target_name": "dev", "node_id": "test.dbt_playground.relationships_stg_events_session_id__session_id__ref_stg_sessions_.86082a5a59"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select session_id as from_field
    from "my_db"."main"."stg_events"
    where session_id is not null
),

parent as (
    select session_id as to_field
    from "my_db"."main"."stg_sessions"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m20:38:59.112545 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:38:59.513772 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m20:38:59.614478 [debug] [Thread-1 (]: Timing info for test.dbt_playground.relationships_stg_events_session_id__session_id__ref_stg_sessions_.86082a5a59 (execute): 20:38:59.108706 => 20:38:59.613705
[0m20:38:59.615688 [debug] [Thread-1 (]: On test.dbt_playground.relationships_stg_events_session_id__session_id__ref_stg_sessions_.86082a5a59: Close
[0m20:38:59.617319 [info ] [Thread-1 (]: 17 of 26 PASS relationships_stg_events_session_id__session_id__ref_stg_sessions_  [[32mPASS[0m in 0.52s]
[0m20:38:59.618272 [debug] [Thread-1 (]: Finished running node test.dbt_playground.relationships_stg_events_session_id__session_id__ref_stg_sessions_.86082a5a59
[0m20:38:59.618967 [debug] [Thread-1 (]: Began running node test.dbt_playground.relationships_stg_events_visitor_id__visitor_id__ref_stg_sessions_.fa4c4819a4
[0m20:38:59.619616 [info ] [Thread-1 (]: 18 of 26 START test relationships_stg_events_visitor_id__visitor_id__ref_stg_sessions_  [RUN]
[0m20:38:59.620639 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_playground.relationships_stg_events_session_id__session_id__ref_stg_sessions_.86082a5a59, now test.dbt_playground.relationships_stg_events_visitor_id__visitor_id__ref_stg_sessions_.fa4c4819a4)
[0m20:38:59.621341 [debug] [Thread-1 (]: Began compiling node test.dbt_playground.relationships_stg_events_visitor_id__visitor_id__ref_stg_sessions_.fa4c4819a4
[0m20:38:59.629525 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_playground.relationships_stg_events_visitor_id__visitor_id__ref_stg_sessions_.fa4c4819a4"
[0m20:38:59.630783 [debug] [Thread-1 (]: Timing info for test.dbt_playground.relationships_stg_events_visitor_id__visitor_id__ref_stg_sessions_.fa4c4819a4 (compile): 20:38:59.621790 => 20:38:59.630565
[0m20:38:59.631364 [debug] [Thread-1 (]: Began executing node test.dbt_playground.relationships_stg_events_visitor_id__visitor_id__ref_stg_sessions_.fa4c4819a4
[0m20:38:59.634526 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_playground.relationships_stg_events_visitor_id__visitor_id__ref_stg_sessions_.fa4c4819a4"
[0m20:38:59.635295 [debug] [Thread-1 (]: Using duckdb connection "test.dbt_playground.relationships_stg_events_visitor_id__visitor_id__ref_stg_sessions_.fa4c4819a4"
[0m20:38:59.635692 [debug] [Thread-1 (]: On test.dbt_playground.relationships_stg_events_visitor_id__visitor_id__ref_stg_sessions_.fa4c4819a4: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "dbt_playground", "target_name": "dev", "node_id": "test.dbt_playground.relationships_stg_events_visitor_id__visitor_id__ref_stg_sessions_.fa4c4819a4"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select visitor_id as from_field
    from "my_db"."main"."stg_events"
    where visitor_id is not null
),

parent as (
    select visitor_id as to_field
    from "my_db"."main"."stg_sessions"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m20:38:59.636053 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:39:00.036645 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m20:39:00.137075 [debug] [Thread-1 (]: Timing info for test.dbt_playground.relationships_stg_events_visitor_id__visitor_id__ref_stg_sessions_.fa4c4819a4 (execute): 20:38:59.631844 => 20:39:00.136183
[0m20:39:00.137944 [debug] [Thread-1 (]: On test.dbt_playground.relationships_stg_events_visitor_id__visitor_id__ref_stg_sessions_.fa4c4819a4: Close
[0m20:39:00.139387 [info ] [Thread-1 (]: 18 of 26 PASS relationships_stg_events_visitor_id__visitor_id__ref_stg_sessions_  [[32mPASS[0m in 0.52s]
[0m20:39:00.140301 [debug] [Thread-1 (]: Finished running node test.dbt_playground.relationships_stg_events_visitor_id__visitor_id__ref_stg_sessions_.fa4c4819a4
[0m20:39:00.141001 [debug] [Thread-1 (]: Began running node test.dbt_playground.unique_stg_sessions_session_id.ce45726d03
[0m20:39:00.141802 [info ] [Thread-1 (]: 19 of 26 START test unique_stg_sessions_session_id ............................. [RUN]
[0m20:39:00.142851 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_playground.relationships_stg_events_visitor_id__visitor_id__ref_stg_sessions_.fa4c4819a4, now test.dbt_playground.unique_stg_sessions_session_id.ce45726d03)
[0m20:39:00.143364 [debug] [Thread-1 (]: Began compiling node test.dbt_playground.unique_stg_sessions_session_id.ce45726d03
[0m20:39:00.149529 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_playground.unique_stg_sessions_session_id.ce45726d03"
[0m20:39:00.150689 [debug] [Thread-1 (]: Timing info for test.dbt_playground.unique_stg_sessions_session_id.ce45726d03 (compile): 20:39:00.143711 => 20:39:00.150492
[0m20:39:00.151117 [debug] [Thread-1 (]: Began executing node test.dbt_playground.unique_stg_sessions_session_id.ce45726d03
[0m20:39:00.156207 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_playground.unique_stg_sessions_session_id.ce45726d03"
[0m20:39:00.156967 [debug] [Thread-1 (]: Using duckdb connection "test.dbt_playground.unique_stg_sessions_session_id.ce45726d03"
[0m20:39:00.157340 [debug] [Thread-1 (]: On test.dbt_playground.unique_stg_sessions_session_id.ce45726d03: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "dbt_playground", "target_name": "dev", "node_id": "test.dbt_playground.unique_stg_sessions_session_id.ce45726d03"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    session_id as unique_field,
    count(*) as n_records

from "my_db"."main"."stg_sessions"
where session_id is not null
group by session_id
having count(*) > 1



      
    ) dbt_internal_test
[0m20:39:00.157690 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:39:00.546621 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m20:39:00.648642 [debug] [Thread-1 (]: Timing info for test.dbt_playground.unique_stg_sessions_session_id.ce45726d03 (execute): 20:39:00.151410 => 20:39:00.648036
[0m20:39:00.649845 [debug] [Thread-1 (]: On test.dbt_playground.unique_stg_sessions_session_id.ce45726d03: Close
[0m20:39:00.651792 [info ] [Thread-1 (]: 19 of 26 PASS unique_stg_sessions_session_id ................................... [[32mPASS[0m in 0.51s]
[0m20:39:00.652739 [debug] [Thread-1 (]: Finished running node test.dbt_playground.unique_stg_sessions_session_id.ce45726d03
[0m20:39:00.653340 [debug] [Thread-1 (]: Began running node model.dbt_playground.traffic_performance
[0m20:39:00.653985 [info ] [Thread-1 (]: 20 of 26 START sql table model main.traffic_performance ........................ [RUN]
[0m20:39:00.655130 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_playground.unique_stg_sessions_session_id.ce45726d03, now model.dbt_playground.traffic_performance)
[0m20:39:00.655673 [debug] [Thread-1 (]: Began compiling node model.dbt_playground.traffic_performance
[0m20:39:00.660997 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_playground.traffic_performance"
[0m20:39:00.662154 [debug] [Thread-1 (]: Timing info for model.dbt_playground.traffic_performance (compile): 20:39:00.656006 => 20:39:00.661958
[0m20:39:00.662560 [debug] [Thread-1 (]: Began executing node model.dbt_playground.traffic_performance
[0m20:39:00.680738 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_playground.traffic_performance"
[0m20:39:00.681440 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_playground.traffic_performance"
[0m20:39:00.681785 [debug] [Thread-1 (]: On model.dbt_playground.traffic_performance: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "dbt_playground", "target_name": "dev", "node_id": "model.dbt_playground.traffic_performance"} */

  
    
    

    create  table
      "my_db"."main"."traffic_performance__dbt_tmp"
  
    as (
      select timestamp__to_date::date as date,
       referrer_type as channel,
       source_medium,
       campaign_name as utm_campaign,
       campaign_content as utm_content,
       session_entry_url as landing_page,
       
    case when visitor_returning = 'Returning' then true else false end
 as is_returning,
       
    case 
        when location_country_name = 'United Stated' then location_country_name
        when location_country_name = 'Netherlands' then location_country_name
        when location_country_name = 'Ireland' then location_country_name
        when location_country_name = 'Canada' then location_country_name
        when location_country_name = 'Belgium' then location_country_name
        when location_country_name = 'China' then location_country_name
        else 'Other'
    end
 as country,
       operating_system,
       device_type,
       events::int as events,
       visitors::int as users,
       sessions::int as sessions,
       page_views::int as page_views,
       ecommerce_conversions::int as purchases,
       cart_additions::int as add_to_cart,
       ecommerce_abandoned_carts::int as abandoned_carts,
       case when consents_none = 0 then false else true end as is_full_consent,
       current_timestamp as date_transformed
from "my_db"."main"."stg_analytics"
    );
  
  
[0m20:39:00.682105 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:39:01.291569 [debug] [Thread-1 (]: SQL status: OK in 1.0 seconds
[0m20:39:01.299377 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_playground.traffic_performance"
[0m20:39:01.300119 [debug] [Thread-1 (]: On model.dbt_playground.traffic_performance: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "dbt_playground", "target_name": "dev", "node_id": "model.dbt_playground.traffic_performance"} */
alter table "my_db"."main"."traffic_performance" rename to "traffic_performance__dbt_backup"
[0m20:39:01.588980 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m20:39:01.601503 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_playground.traffic_performance"
[0m20:39:01.602097 [debug] [Thread-1 (]: On model.dbt_playground.traffic_performance: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "dbt_playground", "target_name": "dev", "node_id": "model.dbt_playground.traffic_performance"} */
alter table "my_db"."main"."traffic_performance__dbt_tmp" rename to "traffic_performance"
[0m20:39:01.890886 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m20:39:01.897127 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_playground.traffic_performance"
[0m20:39:01.897451 [debug] [Thread-1 (]: On model.dbt_playground.traffic_performance: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "dbt_playground", "target_name": "dev", "node_id": "model.dbt_playground.traffic_performance"} */
drop table if exists "my_db"."main"."traffic_performance__dbt_backup" cascade
[0m20:39:02.183830 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m20:39:02.186546 [debug] [Thread-1 (]: Timing info for model.dbt_playground.traffic_performance (execute): 20:39:00.662836 => 20:39:02.186297
[0m20:39:02.187127 [debug] [Thread-1 (]: On model.dbt_playground.traffic_performance: Close
[0m20:39:02.188194 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '97992441-2a70-45c6-aaae-d652b8fdf13f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107e2c5e0>]}
[0m20:39:02.189041 [info ] [Thread-1 (]: 20 of 26 OK created sql table model main.traffic_performance ................... [[32mOK[0m in 1.53s]
[0m20:39:02.189768 [debug] [Thread-1 (]: Finished running node model.dbt_playground.traffic_performance
[0m20:39:02.190245 [debug] [Thread-1 (]: Began running node model.dbt_playground.int_events
[0m20:39:02.190889 [info ] [Thread-1 (]: 21 of 26 START sql view model main.int_events .................................. [RUN]
[0m20:39:02.191725 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_playground.traffic_performance, now model.dbt_playground.int_events)
[0m20:39:02.192186 [debug] [Thread-1 (]: Began compiling node model.dbt_playground.int_events
[0m20:39:02.196402 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_playground.int_events"
[0m20:39:02.197428 [debug] [Thread-1 (]: Timing info for model.dbt_playground.int_events (compile): 20:39:02.192483 => 20:39:02.197274
[0m20:39:02.197758 [debug] [Thread-1 (]: Began executing node model.dbt_playground.int_events
[0m20:39:02.201786 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_playground.int_events"
[0m20:39:02.202503 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_playground.int_events"
[0m20:39:02.202923 [debug] [Thread-1 (]: On model.dbt_playground.int_events: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "dbt_playground", "target_name": "dev", "node_id": "model.dbt_playground.int_events"} */

  
  create view "my_db"."main"."int_events__dbt_tmp" as (
    select session_id,
       event_id,
       visitor_id,
       timestamp::timestamp as timestamp,
       event_index::int as event_index,
       page_view_index::int as page_view_index,
       custom_event_category,
       custom_event_action,
       custom_event_name,
       event_url,
       source_medium,
       campaign_name as utm_campaign,
       goal_id::int as goal_id,
       current_timestamp as date_transformed
from "my_db"."main"."stg_events"
  );

[0m20:39:02.203388 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:39:02.787331 [debug] [Thread-1 (]: SQL status: OK in 1.0 seconds
[0m20:39:02.794451 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_playground.int_events"
[0m20:39:02.795052 [debug] [Thread-1 (]: On model.dbt_playground.int_events: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "dbt_playground", "target_name": "dev", "node_id": "model.dbt_playground.int_events"} */
alter view "my_db"."main"."int_events" rename to "int_events__dbt_backup"
[0m20:39:03.084665 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m20:39:03.094027 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_playground.int_events"
[0m20:39:03.094702 [debug] [Thread-1 (]: On model.dbt_playground.int_events: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "dbt_playground", "target_name": "dev", "node_id": "model.dbt_playground.int_events"} */
alter view "my_db"."main"."int_events__dbt_tmp" rename to "int_events"
[0m20:39:03.390920 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m20:39:03.405172 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_playground.int_events"
[0m20:39:03.405929 [debug] [Thread-1 (]: On model.dbt_playground.int_events: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "dbt_playground", "target_name": "dev", "node_id": "model.dbt_playground.int_events"} */
drop view if exists "my_db"."main"."int_events__dbt_backup" cascade
[0m20:39:03.700726 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m20:39:03.705388 [debug] [Thread-1 (]: Timing info for model.dbt_playground.int_events (execute): 20:39:02.197982 => 20:39:03.705105
[0m20:39:03.706095 [debug] [Thread-1 (]: On model.dbt_playground.int_events: Close
[0m20:39:03.707202 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '97992441-2a70-45c6-aaae-d652b8fdf13f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110575ff0>]}
[0m20:39:03.708087 [info ] [Thread-1 (]: 21 of 26 OK created sql view model main.int_events ............................. [[32mOK[0m in 1.52s]
[0m20:39:03.708741 [debug] [Thread-1 (]: Finished running node model.dbt_playground.int_events
[0m20:39:03.709247 [debug] [Thread-1 (]: Began running node model.dbt_playground.int_sessions
[0m20:39:03.709895 [info ] [Thread-1 (]: 22 of 26 START sql view model main.int_sessions ................................ [RUN]
[0m20:39:03.710735 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_playground.int_events, now model.dbt_playground.int_sessions)
[0m20:39:03.711160 [debug] [Thread-1 (]: Began compiling node model.dbt_playground.int_sessions
[0m20:39:03.716314 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_playground.int_sessions"
[0m20:39:03.717509 [debug] [Thread-1 (]: Timing info for model.dbt_playground.int_sessions (compile): 20:39:03.711448 => 20:39:03.717327
[0m20:39:03.717887 [debug] [Thread-1 (]: Began executing node model.dbt_playground.int_sessions
[0m20:39:03.722253 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_playground.int_sessions"
[0m20:39:03.723123 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_playground.int_sessions"
[0m20:39:03.723535 [debug] [Thread-1 (]: On model.dbt_playground.int_sessions: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "dbt_playground", "target_name": "dev", "node_id": "model.dbt_playground.int_sessions"} */

  
  create view "my_db"."main"."int_sessions__dbt_tmp" as (
    select session_id,
       visitor_id,
       timestamp::timestamp as timestamp,
       visitor_session_number::int as visitor_session_number,
       
    case when visitor_returning = 'Returning' then true else false end
 as is_returning,
       
    case 
        when location_country_name = 'United Stated' then location_country_name
        when location_country_name = 'Netherlands' then location_country_name
        when location_country_name = 'Ireland' then location_country_name
        when location_country_name = 'Canada' then location_country_name
        when location_country_name = 'Belgium' then location_country_name
        when location_country_name = 'China' then location_country_name
        else 'Other'
    end
 as country,
       source_medium,
       campaign_name as utm_campaign,
       session_total_page_views::int as session_total_page_views,
       session_total_events::int as session_total_events,
       visitor_days_since_last_session::int as visitor_days_since_last_session,
       visitor_days_since_first_session::int as visitor_days_since_first_session,
       current_timestamp as date_transformed
from "my_db"."main"."stg_sessions"
  );

[0m20:39:03.723918 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:39:04.302023 [debug] [Thread-1 (]: SQL status: OK in 1.0 seconds
[0m20:39:04.312494 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_playground.int_sessions"
[0m20:39:04.313136 [debug] [Thread-1 (]: On model.dbt_playground.int_sessions: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "dbt_playground", "target_name": "dev", "node_id": "model.dbt_playground.int_sessions"} */
alter view "my_db"."main"."int_sessions" rename to "int_sessions__dbt_backup"
[0m20:39:04.604711 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m20:39:04.614708 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_playground.int_sessions"
[0m20:39:04.615276 [debug] [Thread-1 (]: On model.dbt_playground.int_sessions: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "dbt_playground", "target_name": "dev", "node_id": "model.dbt_playground.int_sessions"} */
alter view "my_db"."main"."int_sessions__dbt_tmp" rename to "int_sessions"
[0m20:39:04.901449 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m20:39:04.911573 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_playground.int_sessions"
[0m20:39:04.912227 [debug] [Thread-1 (]: On model.dbt_playground.int_sessions: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "dbt_playground", "target_name": "dev", "node_id": "model.dbt_playground.int_sessions"} */
drop view if exists "my_db"."main"."int_sessions__dbt_backup" cascade
[0m20:39:05.204951 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m20:39:05.210777 [debug] [Thread-1 (]: Timing info for model.dbt_playground.int_sessions (execute): 20:39:03.718128 => 20:39:05.210363
[0m20:39:05.211667 [debug] [Thread-1 (]: On model.dbt_playground.int_sessions: Close
[0m20:39:05.213388 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '97992441-2a70-45c6-aaae-d652b8fdf13f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107b5ffd0>]}
[0m20:39:05.214501 [info ] [Thread-1 (]: 22 of 26 OK created sql view model main.int_sessions ........................... [[32mOK[0m in 1.50s]
[0m20:39:05.215306 [debug] [Thread-1 (]: Finished running node model.dbt_playground.int_sessions
[0m20:39:05.216562 [debug] [Thread-1 (]: Began running node model.dbt_playground.attribution
[0m20:39:05.217125 [info ] [Thread-1 (]: 23 of 26 START sql table model main.attribution ................................ [RUN]
[0m20:39:05.217911 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_playground.int_sessions, now model.dbt_playground.attribution)
[0m20:39:05.218333 [debug] [Thread-1 (]: Began compiling node model.dbt_playground.attribution
[0m20:39:05.232412 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_playground.attribution"
[0m20:39:05.233233 [debug] [Thread-1 (]: Timing info for model.dbt_playground.attribution (compile): 20:39:05.218634 => 20:39:05.233071
[0m20:39:05.233561 [debug] [Thread-1 (]: Began executing node model.dbt_playground.attribution
[0m20:39:05.237108 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_playground.attribution"
[0m20:39:05.237761 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_playground.attribution"
[0m20:39:05.238127 [debug] [Thread-1 (]: On model.dbt_playground.attribution: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "dbt_playground", "target_name": "dev", "node_id": "model.dbt_playground.attribution"} */

  
    
    

    create  table
      "my_db"."main"."attribution__dbt_tmp"
  
    as (
      select md5(cast(coalesce(cast(sessions.visitor_id as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(sessions.session_id as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(events.event_id as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(events.timestamp as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as s_id,
       sessions.visitor_id,
       sessions.session_id,
       sessions.visitor_session_number,
       case when sessions.visitor_session_number = 1 then true else false end as is_first_session,
       events.event_id,
       events.page_view_index,
       events.timestamp,
       events.event_url,
       sessions.is_returning,
       sessions.country,
       sessions.source_medium,
       sessions.utm_campaign,
       sessions.session_total_page_views,
       sessions.session_total_events,
       current_timestamp as date_transformed
from "my_db"."main"."int_sessions" as sessions
left join "my_db"."main"."int_events" as events
on sessions.session_id = events.session_id
    );
  
  
[0m20:39:05.238433 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:39:06.129172 [debug] [Thread-1 (]: SQL status: OK in 1.0 seconds
[0m20:39:06.138939 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_playground.attribution"
[0m20:39:06.139552 [debug] [Thread-1 (]: On model.dbt_playground.attribution: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "dbt_playground", "target_name": "dev", "node_id": "model.dbt_playground.attribution"} */
alter table "my_db"."main"."attribution__dbt_tmp" rename to "attribution"
[0m20:39:06.431587 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m20:39:06.473724 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_playground.attribution"
[0m20:39:06.474146 [debug] [Thread-1 (]: On model.dbt_playground.attribution: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "dbt_playground", "target_name": "dev", "node_id": "model.dbt_playground.attribution"} */
drop table if exists "my_db"."main"."attribution__dbt_backup" cascade
[0m20:39:06.664838 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m20:39:06.669566 [debug] [Thread-1 (]: Timing info for model.dbt_playground.attribution (execute): 20:39:05.233862 => 20:39:06.669263
[0m20:39:06.670149 [debug] [Thread-1 (]: On model.dbt_playground.attribution: Close
[0m20:39:06.671183 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '97992441-2a70-45c6-aaae-d652b8fdf13f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1105f9f30>]}
[0m20:39:06.672008 [info ] [Thread-1 (]: 23 of 26 OK created sql table model main.attribution ........................... [[32mOK[0m in 1.45s]
[0m20:39:06.672723 [debug] [Thread-1 (]: Finished running node model.dbt_playground.attribution
[0m20:39:06.673252 [debug] [Thread-1 (]: Began running node model.dbt_playground.int_touchpoints
[0m20:39:06.673929 [info ] [Thread-1 (]: 24 of 26 START sql view model main.int_touchpoints ............................. [RUN]
[0m20:39:06.674902 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_playground.attribution, now model.dbt_playground.int_touchpoints)
[0m20:39:06.675408 [debug] [Thread-1 (]: Began compiling node model.dbt_playground.int_touchpoints
[0m20:39:06.679820 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_playground.int_touchpoints"
[0m20:39:06.681007 [debug] [Thread-1 (]: Timing info for model.dbt_playground.int_touchpoints (compile): 20:39:06.675717 => 20:39:06.680800
[0m20:39:06.681408 [debug] [Thread-1 (]: Began executing node model.dbt_playground.int_touchpoints
[0m20:39:06.685614 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_playground.int_touchpoints"
[0m20:39:06.686318 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_playground.int_touchpoints"
[0m20:39:06.686710 [debug] [Thread-1 (]: On model.dbt_playground.int_touchpoints: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "dbt_playground", "target_name": "dev", "node_id": "model.dbt_playground.int_touchpoints"} */

  
  create view "my_db"."main"."int_touchpoints__dbt_tmp" as (
    select distinct sessions.visitor_id,
       -- first
       FIRST_VALUE(sessions.source_medium) OVER (PARTITION BY sessions.visitor_id ORDER BY sessions.timestamp) AS first_source_medium,
       FIRST_VALUE(sessions.utm_campaign) OVER (PARTITION BY sessions.visitor_id ORDER BY sessions.timestamp) AS first_utm_campaign,
       FIRST_VALUE(events.event_url) OVER (PARTITION BY sessions.visitor_id ORDER BY sessions.timestamp) AS first_event_url,
       -- last
       LAST_VALUE(sessions.source_medium) OVER (PARTITION BY sessions.visitor_id ORDER BY sessions.timestamp desc) AS last_source_medium,
       LAST_VALUE(sessions.utm_campaign) OVER (PARTITION BY sessions.visitor_id ORDER BY sessions.timestamp desc) AS last_utm_campaign,
       LAST_VALUE(events.event_url) OVER (PARTITION BY sessions.visitor_id ORDER BY events.timestamp desc) AS last_event_url
from "my_db"."main"."int_sessions" as sessions
left join "my_db"."main"."int_events" as events
    on sessions.session_id = events.session_id
  );

[0m20:39:06.687081 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:39:07.266692 [debug] [Thread-1 (]: SQL status: OK in 1.0 seconds
[0m20:39:07.273268 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_playground.int_touchpoints"
[0m20:39:07.273825 [debug] [Thread-1 (]: On model.dbt_playground.int_touchpoints: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "dbt_playground", "target_name": "dev", "node_id": "model.dbt_playground.int_touchpoints"} */
alter view "my_db"."main"."int_touchpoints" rename to "int_touchpoints__dbt_backup"
[0m20:39:07.563582 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m20:39:07.570784 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_playground.int_touchpoints"
[0m20:39:07.571336 [debug] [Thread-1 (]: On model.dbt_playground.int_touchpoints: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "dbt_playground", "target_name": "dev", "node_id": "model.dbt_playground.int_touchpoints"} */
alter view "my_db"."main"."int_touchpoints__dbt_tmp" rename to "int_touchpoints"
[0m20:39:07.861135 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m20:39:07.871789 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_playground.int_touchpoints"
[0m20:39:07.872313 [debug] [Thread-1 (]: On model.dbt_playground.int_touchpoints: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "dbt_playground", "target_name": "dev", "node_id": "model.dbt_playground.int_touchpoints"} */
drop view if exists "my_db"."main"."int_touchpoints__dbt_backup" cascade
[0m20:39:08.161225 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m20:39:08.162545 [debug] [Thread-1 (]: Timing info for model.dbt_playground.int_touchpoints (execute): 20:39:06.681642 => 20:39:08.162414
[0m20:39:08.162856 [debug] [Thread-1 (]: On model.dbt_playground.int_touchpoints: Close
[0m20:39:08.163390 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '97992441-2a70-45c6-aaae-d652b8fdf13f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1101b9630>]}
[0m20:39:08.163828 [info ] [Thread-1 (]: 24 of 26 OK created sql view model main.int_touchpoints ........................ [[32mOK[0m in 1.49s]
[0m20:39:08.164234 [debug] [Thread-1 (]: Finished running node model.dbt_playground.int_touchpoints
[0m20:39:08.164750 [debug] [Thread-1 (]: Began running node model.dbt_playground.visitors
[0m20:39:08.165127 [info ] [Thread-1 (]: 25 of 26 START sql table model main.visitors ................................... [RUN]
[0m20:39:08.165647 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_playground.int_touchpoints, now model.dbt_playground.visitors)
[0m20:39:08.165938 [debug] [Thread-1 (]: Began compiling node model.dbt_playground.visitors
[0m20:39:08.168709 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_playground.visitors"
[0m20:39:08.169442 [debug] [Thread-1 (]: Timing info for model.dbt_playground.visitors (compile): 20:39:08.166131 => 20:39:08.169184
[0m20:39:08.169854 [debug] [Thread-1 (]: Began executing node model.dbt_playground.visitors
[0m20:39:08.172893 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_playground.visitors"
[0m20:39:08.173415 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_playground.visitors"
[0m20:39:08.173698 [debug] [Thread-1 (]: On model.dbt_playground.visitors: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "dbt_playground", "target_name": "dev", "node_id": "model.dbt_playground.visitors"} */

  
    
    

    create  table
      "my_db"."main"."visitors__dbt_tmp"
  
    as (
      select distinct sessions.visitor_id,
       sessions.country,
       -- first
       touchpoints.first_source_medium,
       touchpoints.first_utm_campaign,
       touchpoints.first_event_url,
       -- last
       touchpoints.last_source_medium,
       touchpoints.last_utm_campaign,
       touchpoints.last_event_url,
       -- arrays
       array_agg(sessions.source_medium order by sessions.timestamp) as all_source_mediums,
       array_agg(sessions.utm_campaign order by sessions.timestamp) as all_campaigns,
       array_agg(events.event_url order by events.timestamp) as all_event_urls,
       -- metrics
       count (distinct sessions.session_id) as total_sessions,
       sum(sessions.session_total_page_views) as session_total_page_views,
       sum(sessions.session_total_events) as session_total_events,
       sessions.visitor_days_since_last_session,
       sessions.visitor_days_since_first_session,
       current_timestamp as date_transformed
from "my_db"."main"."int_sessions" as sessions
left join "my_db"."main"."int_events" as events
    on sessions.session_id = events.session_id
left join "my_db"."main"."int_touchpoints" as touchpoints
    on sessions.visitor_id = touchpoints.visitor_id
group by all
    );
  
  
[0m20:39:08.173966 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:39:09.820028 [debug] [Thread-1 (]: SQL status: OK in 2.0 seconds
[0m20:39:09.825030 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_playground.visitors"
[0m20:39:09.825518 [debug] [Thread-1 (]: On model.dbt_playground.visitors: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "dbt_playground", "target_name": "dev", "node_id": "model.dbt_playground.visitors"} */
alter table "my_db"."main"."visitors__dbt_tmp" rename to "visitors"
[0m20:39:10.431017 [debug] [Thread-1 (]: SQL status: OK in 1.0 seconds
[0m20:39:10.442030 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_playground.visitors"
[0m20:39:10.442617 [debug] [Thread-1 (]: On model.dbt_playground.visitors: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "dbt_playground", "target_name": "dev", "node_id": "model.dbt_playground.visitors"} */
drop table if exists "my_db"."main"."visitors__dbt_backup" cascade
[0m20:39:10.634696 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m20:39:10.639147 [debug] [Thread-1 (]: Timing info for model.dbt_playground.visitors (execute): 20:39:08.170049 => 20:39:10.638776
[0m20:39:10.639920 [debug] [Thread-1 (]: On model.dbt_playground.visitors: Close
[0m20:39:10.641428 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '97992441-2a70-45c6-aaae-d652b8fdf13f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107bed150>]}
[0m20:39:10.642685 [info ] [Thread-1 (]: 25 of 26 OK created sql table model main.visitors .............................. [[32mOK[0m in 2.48s]
[0m20:39:10.643891 [debug] [Thread-1 (]: Finished running node model.dbt_playground.visitors
[0m20:39:10.645165 [debug] [Thread-1 (]: Began running node snapshot.dbt_playground.visitors_snapshot
[0m20:39:10.645912 [info ] [Thread-1 (]: 26 of 26 START snapshot analytics.dbt.visitors_snapshot ........................ [RUN]
[0m20:39:10.646819 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_playground.visitors, now snapshot.dbt_playground.visitors_snapshot)
[0m20:39:10.647287 [debug] [Thread-1 (]: Began compiling node snapshot.dbt_playground.visitors_snapshot
[0m20:39:10.652382 [debug] [Thread-1 (]: Timing info for snapshot.dbt_playground.visitors_snapshot (compile): 20:39:10.647573 => 20:39:10.652126
[0m20:39:10.652888 [debug] [Thread-1 (]: Began executing node snapshot.dbt_playground.visitors_snapshot
[0m20:39:10.690692 [debug] [Thread-1 (]: Writing runtime sql for node "snapshot.dbt_playground.visitors_snapshot"
[0m20:39:10.691463 [debug] [Thread-1 (]: Using duckdb connection "snapshot.dbt_playground.visitors_snapshot"
[0m20:39:10.691748 [debug] [Thread-1 (]: On snapshot.dbt_playground.visitors_snapshot: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "dbt_playground", "target_name": "dev", "node_id": "snapshot.dbt_playground.visitors_snapshot"} */

      
  
    
    

    create  table
      "analytics"."dbt"."visitors_snapshot"
  
    as (
      

    select *,
        md5(coalesce(cast(visitor_id as varchar ), '')
         || '|' || coalesce(cast(now()::timestamp as varchar ), '')
        ) as dbt_scd_id,
        now()::timestamp as dbt_updated_at,
        now()::timestamp as dbt_valid_from,
        nullif(now()::timestamp, now()::timestamp) as dbt_valid_to
    from (
        



select * from "my_db"."main"."visitors" 

    ) sbq



    );
  
  
  
[0m20:39:10.692010 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:39:11.966848 [debug] [Thread-1 (]: SQL status: OK in 1.0 seconds
[0m20:39:11.968587 [debug] [Thread-1 (]: Timing info for snapshot.dbt_playground.visitors_snapshot (execute): 20:39:10.653188 => 20:39:11.968465
[0m20:39:11.968863 [debug] [Thread-1 (]: On snapshot.dbt_playground.visitors_snapshot: Close
[0m20:39:11.969345 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '97992441-2a70-45c6-aaae-d652b8fdf13f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110501e40>]}
[0m20:39:11.969817 [info ] [Thread-1 (]: 26 of 26 OK snapshotted analytics.dbt.visitors_snapshot ........................ [[32mOK[0m in 1.32s]
[0m20:39:11.970196 [debug] [Thread-1 (]: Finished running node snapshot.dbt_playground.visitors_snapshot
[0m20:39:11.971092 [debug] [MainThread]: Using duckdb connection "master"
[0m20:39:11.971356 [debug] [MainThread]: On master: BEGIN
[0m20:39:11.971564 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m20:39:12.254859 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m20:39:12.255790 [debug] [MainThread]: On master: COMMIT
[0m20:39:12.256159 [debug] [MainThread]: Using duckdb connection "master"
[0m20:39:12.256500 [debug] [MainThread]: On master: COMMIT
[0m20:39:12.256861 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m20:39:12.257194 [debug] [MainThread]: On master: Close
[0m20:39:12.258033 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:39:12.258357 [debug] [MainThread]: Connection 'snapshot.dbt_playground.visitors_snapshot' was properly closed.
[0m20:39:12.258982 [info ] [MainThread]: 
[0m20:39:12.259416 [info ] [MainThread]: Finished running 6 view models, 16 tests, 3 table models, 1 snapshot in 0 hours 0 minutes and 28.16 seconds (28.16s).
[0m20:39:12.262761 [debug] [MainThread]: Command end result
[0m20:39:12.276303 [info ] [MainThread]: 
[0m20:39:12.276696 [info ] [MainThread]: [32mCompleted successfully[0m
[0m20:39:12.276953 [info ] [MainThread]: 
[0m20:39:12.277203 [info ] [MainThread]: Done. PASS=26 WARN=0 ERROR=0 SKIP=0 TOTAL=26
[0m20:39:12.277687 [debug] [MainThread]: Command `dbt build` succeeded at 20:39:12.277620 after 28.48 seconds
[0m20:39:12.277996 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1054e9390>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107749900>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107b889a0>]}
[0m20:39:12.278302 [debug] [MainThread]: Flushing usage events
